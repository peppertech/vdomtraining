define(['exports', 'preact/jsx-runtime', './classNames-2e65b3b3', './SvgSymbol-4ab30c6f', './UNSAFE_Legend/themes/LegendStyles.css', './Text-7cbb9b7a', 'preact/compat', './LegendUtils-1bbd7e16', 'preact/hooks', './useUser-e0989b0b', './useTooltipControlled-e99753ae', './useTextDimensions-a2b7ad1c'], (function(e,t,n,i,o,s,r,l,a,d,c,u){"use strict";function m(e){const{imageMarkerStyle:n}=o.styles;return t.jsx("img",{class:n,src:e.source})}const h=({markerColor:e="#a6acb1",lineColor:n="#a6acb1",markerShape:s="square",isHidden:r=!1,lineStyle:l="none",...a})=>{const{legendSymbolBaseStyle:d}=o.styles,c=!(null==a.width&&null==a.height)&&("rectangle"===s||"ellipse"===s),u="none"!=l&&"none"!=s?2:3;return t.jsx("div",{className:d,style:{width:a.width,height:a.height},children:a.source?t.jsx(m,{source:a.source}):t.jsx(i.SvgSymbol,{setAspectRatioNone:c,markerShape:r?"square":s,lineStyle:r?"none":l,lineColor:n,lineLength:a.lineLength,lineWidth:null!=a.lineWidth?a.lineWidth:u,markerColor:r?"transparent":e,borderColor:r?e||n:a.borderColor,setAbsolutePos:!0})})},g=({text:e,type:i="label",id:r,align:l="start",...a})=>{const{legendTextBaseStyle:d,legendTextTitle:c,legendTitleStartAlign:u,legendTitleCenterAlign:m,legendTitleEndAlign:h}=o.styles,g="title"===i;return t.jsx("div",{class:n.classNames([d,g?c:"",g&&"start"===l?u:"",g&&"center"===l?m:"",g&&"end"===l?h:""]),style:{...a},children:t.jsx(s.Text,{size:"inherit",variant:"inherit",weight:"inherit",truncation:"ellipsis",id:r,children:e})})},x=r.forwardRef((({id:e,text:i,sectionIdx:s,itemIdx:r,isHighlighted:l,symbolHeight:a,symbolWidth:d,isFocused:c,isCurrent:u,isHidden:m,...x},I)=>{const b={fontFamily:x.textFontFamily,fontSize:x.textFontSize,color:x.textColor,fontStyle:x.textFontStyle,fontWeight:x.textFontWeight,textDecoration:x.textTextDecoration},f={lineStyle:x.lineStyle,lineWidth:x.lineWidth,markerShape:x.markerShape,markerColor:x.markerColor,source:x.source,borderColor:x.borderColor,lineColor:x.lineColor},y=l||null==l,{legendItemBaseStyle:p,legendItemIsCurrent:C,legendItemOpacity:S,legendItemFocusRing:v}=o.styles;return t.jsxs("div",{class:n.classNames([p,u&&null==l?C:"",y?"":S,c?v:"",x.class]),style:{gridRow:x.gridRow,gridColumn:x.gridCol,minWidth:void 0!==x.minWidth?`${x.minWidth}px`:void 0},id:e,ref:I,"data-oj-section":s,"data-oj-item":r,"aria-labelledby":x.labelledBy,role:null!=m?"menuitemcheckbox":"img","aria-checked":null!=m?!m:void 0,"aria-label":x["aria-label"]||i,children:[t.jsx(h,{...f,isHidden:m,lineLength:d,width:null!=d?`${d}px`:void 0,height:null!=a?`${a}px`:void 0}),t.jsx(g,{...b,text:i,type:"label"})]})}));const I=(e,t,n,i)=>{let o=0,s=8;if(e.current&&n.isCurrent&&t.current){const n=t.current,r=e.current.getBoundingClientRect();o=r.x+r.width/2-(n.x+n.width/2),o=i?-1*o:o,s+=n.y-r.y,s=Math.min(8,Math.max(s,r.height-n.height+8))}return{crossAxis:o,mainAxis:s}},b=(e,t,n,i,o)=>{let s=0,r=0,l=0;return l=o?1.5*t+o:4*t,e?.forEach((e=>{const o=e,{width:a}=n(o.text,i),d=2.5*t+a;r+=l+d,s=Math.max(s,Math.ceil(l+d))})),{maxItemWidth:s,horizontalSectionWidth:r}};e.BaseLegend=({orientation:e="horizontal",highlightedIds:i,hiddenIds:s,focusedItemInfo:r,hoveredItemInfo:a,sectionIdx:d,activeId:c,isReadOnly:u,items:m,symbolHeight:h,symbolWidth:g,...I})=>{const b="horizontal"===e,f=b?`repeat(${I.itemsPerRow}, ${I.itemWidth})`:void 0,{baseLegendStyles:y,baseLegendHorizontal:p,baseLegendVertical:C,baseLegendVerticalItem:S,baseLegendPaddingBottom:v,baseLegendPaddingTop:w,baseLegendPaddingEnd:W}=o.styles;return t.jsx("div",{className:n.classNames([y,b?p:C]),style:{gridTemplateColumns:f,maxWidth:"100%"},children:m.map(((e,o)=>{const f=l.getItemProps(e,o,d,r,u,a,s,i),y=r.sectionIdx===d&&r.itemIdx===o,{gridRow:p,gridCol:C}=l.getGridCellIndices(m.length,o,I.itemsPerRow,I.itemsPerCol),R=null!=p&&p!=I.itemsPerCol,L=null!=p&&1!=p;return t.jsx(x,{ref:y?I.focusedItemRef:void 0,itemIdx:o,sectionIdx:d,symbolHeight:h,symbolWidth:g,...I,...f,gridRow:p,gridCol:C,minWidth:I.itemWidth,id:f.isCurrent?c:"",class:n.classNames([b?"":S,L?w:"",R?v:"",W])})}))})},e.LegendText=g,e.useEvents=function(e,t,n,i,o,s,r){const[c,u]=a.useState({itemIdx:0,sectionIdx:0}),[m,h]=a.useState(),g=a.useRef(),{direction:x}=d.useUser(),I="rtl"===x,b=t=>{const i=l.getItemInfo(t.target);l.isEqualItem(i,m)||(h(i&&{...i,isCurrent:!0}),g.current=l.getRandomId(),e&&(c&&u({...c,isCurrent:!1}),r?.(n(i))))},f=()=>{h(void 0),g.current=void 0,e&&r?.(n())};if(!e)return{focusedItemInfo:c,hoveredItemInfo:m,onPointerLeave:f,onPointerMove:b};const y=e=>{r?.(n(e)),g.current=l.getRandomId(),u(e)},p=e=>{l.isEqualItem(e,c)||(e.isCurrent=!0,e.isFocusVisible=!0,m&&h({...m,isCurrent:!1}),y(e))},C=()=>{const{sectionId:e,itemId:t}=n(c);null!=t&&(s?.({sectionId:e,itemId:t}),g.current=l.getRandomId())};return{focusedItemInfo:c,hoveredItemInfo:m,"aria-activedescendant":g.current,onPointerUp:e=>{const t=l.getItemInfo(e.target);if(null!=t){u(t);const{sectionId:e,itemId:i}=n(t);null!=i&&(s?.({sectionId:e,itemId:i}),g.current=l.getRandomId())}},onPointerMove:b,onKeyUp:e=>{switch(e.code){case"Space":t&&C();break;case"Enter":C();break;case"Home":y({itemIdx:0,sectionIdx:0,isFocusVisible:!0,isCurrent:!0});break;case"End":y({itemIdx:-1,sectionIdx:-1,isCurrent:!0,isFocusVisible:!0});break;case"Tab":y({...c,isCurrent:!0,isFocusVisible:!0})}},onKeyDown:e=>{switch(e.key){case"Tab":return;case"ArrowDown":{const e=o(c);p(e);break}case"ArrowUp":{const e=i(c);p(e);break}case"ArrowRight":{const e=I?i(c):o(c);p(e);break}case"ArrowLeft":{const e=I?o(c):i(c);p(e);break}}(e=>{e.preventDefault(),e.stopPropagation()})(e)},onPointerLeave:f,onBlur:()=>{const e={...c,isCurrent:!1,isFocusVisible:!1};(null!=m||c.isCurrent)&&r?.(n(void 0)),u(e)}}},e.useLegendLayout=function({resolvedVars:e,sections:t,items:n,rootRef:i,rootDimsRef:o,orientation:s,legendFontStylesObj:r={},symbolWidth:l}){const{textMeasureContent:d,getTextDimensions:c}=u.useTextDimensions(),m=a.useRef(s),h=m.current!==s,[g,x]=a.useState(!1);return a.useLayoutEffect((()=>{h&&(m.current=s,x(!g))}),[h,g,s]),{textMeasureContent:d,layoutInfo:a.useMemo((()=>{if(!i.current||!Object.keys(e).length||!c||h||"vertical"===s)return;const a=parseFloat(e.unit);o.current=i?.current?.getBoundingClientRect();let d=0,u=!1;if(t&&t.forEach((e=>{const{maxItemWidth:t,horizontalSectionWidth:n}=b(e.items,a,c,r,l);u||(u=n>o.current?.width),d=Math.max(d,t)})),n){const{maxItemWidth:e,horizontalSectionWidth:t}=b(n,a,c,r,l);d=e,u=t>o.current?.width}return{maxItemWidth:Math.min(d,o.current?.width),itemsPerRow:Math.max(1,Math.floor(o.current?.width/d)),isWrapped:u}}),[t,n,o,i,r,e,l,c,s,h])}},e.useLegendTooltip=({text:e,rootDimsRef:t,focusedItemRef:n,focusedItemInfo:i})=>{const{direction:o}=d.useUser(),s="rtl"===o,[r,l]=a.useState(I(n,t,i,s)),[u,m]=a.useState(!1);a.useLayoutEffect((()=>{l(I(n,t,i,s))}),[i,n,s,t]);const h=i?.isCurrent?"element":"pointer",{tooltipContent:g,tooltipProps:x}=c.useTooltipControlled({text:e,position:"top",isDisabled:!1,variant:"datatip",anchor:{x:h,y:h},offset:r,isOpen:u,onToggle:({value:e})=>m(e)});return{tooltipContent:g,tooltipProps:x}}}));
//# sourceMappingURL=useLegendLayout-78147f5c.js.map
