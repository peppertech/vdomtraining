{"version":3,"file":"useDatatip-88cbd577.js","sources":["../../src/hooks/PRIVATE_useDatatip/useDatatip.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ComponentChildren } from 'preact';\nimport { Layer } from '../../UNSAFE_Layer';\nimport { Floating, Placement } from '../../UNSAFE_Floating';\nimport { useRef, useState } from 'preact/hooks';\nimport { styles } from './themes/useDatatip.css';\nimport { useId } from '../UNSAFE_useId';\nimport { Property } from 'csstype';\n\nexport type Dimension = { x: number; width: number; y: number; height: number };\n\ntype DatatipProps = {\n  /**\n   * The datatip content.\n   */\n  content?: ComponentChildren;\n\n  /**\n   * Whether the datatip is anchored to pointer or element.\n   *\n   */\n  anchor: 'element' | 'pointer';\n\n  /**\n   * The offset from the anchor element or pointer.\n   */\n  offset?: {\n    mainAxis?: number;\n    crossAxis?: number;\n  };\n\n  /**\n   * The border color of the datatip.\n   */\n  borderColor?: Property.BorderColor;\n\n  /**\n   * The placement of datatip from anchor point.\n   */\n  placement?: Placement;\n};\n\n/**\n * The default offset for datatip mainAxis.\n */\nconst DEFAULT_OFFSET = 8;\n\n/**\n * The hook to support custom datatip in visualization components.\n */\nexport function useDatatip({\n  content,\n  placement = 'top-end-corner',\n  offset,\n  borderColor,\n  anchor\n}: DatatipProps) {\n  const uniqueIdRef = useRef<string>(useId());\n  const [coords, setCoords] = useState({ x: 0, y: 0 });\n  const offsetValue = offset || { mainAxis: DEFAULT_OFFSET, crossAxis: -1 * DEFAULT_OFFSET };\n  const [isVisible, setIsVisible] = useState(false);\n\n  const targetRef = useRef<HTMLElement | null>(null);\n  const toggleTimeoutRef = useRef<ReturnType<typeof setTimeout>>();\n\n  const onPointerMove = (event: PointerEvent) => {\n    setCoords({ x: event.clientX, y: event.clientY });\n    setIsVisible(true);\n  };\n\n  const onFocus = (event: FocusEvent) => {\n    if (event.eventPhase === Event.AT_TARGET || event.eventPhase === Event.BUBBLING_PHASE) {\n      targetRef.current = event.target as HTMLElement;\n      setIsVisible(true);\n    }\n  };\n\n  const onPointerEnter = (event: PointerEvent) => {\n    if (event.eventPhase === Event.AT_TARGET || event.eventPhase === Event.BUBBLING_PHASE) {\n      targetRef.current = event.currentTarget as HTMLElement;\n      setIsVisible(true);\n    }\n  };\n\n  const onBlur = () => {\n    setIsVisible(false);\n  };\n\n  const onContentPointerEnter = () => {\n    clearTimeout(toggleTimeoutRef.current);\n  };\n\n  const onPointerLeave = () => {\n    toggleTimeoutRef.current = setTimeout(() => {\n      setIsVisible(false);\n    }, 20);\n  };\n\n  const onKeyUp = (event: KeyboardEvent) => {\n    if (event.code === 'Escape') {\n      event.preventDefault();\n      setIsVisible(false);\n    } else if (\n      event.code === 'ArrowUp' ||\n      event.code === 'ArrowDown' ||\n      event.code === 'ArrowRight' ||\n      event.code === 'ArrowLeft' ||\n      event.code === 'Tab'\n    ) {\n      setIsVisible(true);\n    }\n  };\n\n  const anchorRef = anchor === 'element' ? targetRef : { current: coords };\n  const datatipContent =\n    isVisible && content != null ? (\n      <Layer>\n        <Floating\n          anchorRef={anchorRef}\n          placement={placement}\n          offsetValue={offsetValue}\n          flipOptions={{ crossAxis: false, mainAxis: false }}\n          shiftOptions={{ crossAxis: true, mainAxis: true }}>\n          <div\n            role=\"tooltip\"\n            id={uniqueIdRef.current}\n            className={styles.dvtDatatipStyle}\n            style={{ borderColor }}\n            onPointerEnter={onContentPointerEnter}\n            onPointerLeave={onPointerLeave}>\n            {content}\n          </div>\n        </Floating>\n      </Layer>\n    ) : null;\n\n  return {\n    datatipContent,\n    datatipProps: {\n      'aria-describedby': uniqueIdRef.current,\n      onKeyUp,\n      onPointerLeave,\n      onPointerEnter,\n      onPointerMove,\n      onFocus,\n      onBlur\n    }\n  };\n}\n"],"names":["content","placement","offset","borderColor","anchor","uniqueIdRef","useRef","useId","coords","setCoords","useState","x","y","offsetValue","mainAxis","crossAxis","isVisible","setIsVisible","targetRef","toggleTimeoutRef","onPointerLeave","current","setTimeout","anchorRef","datatipContent","_jsx","jsx","Layer","Floating","flipOptions","shiftOptions","role","id","className","styles","dvtDatatipStyle","style","onPointerEnter","clearTimeout","children","datatipProps","onKeyUp","event","code","preventDefault","eventPhase","Event","AT_TARGET","BUBBLING_PHASE","currentTarget","onPointerMove","clientX","clientY","onFocus","target","onBlur"],"mappings":"uQAyDgB,UAAWA,QACzBA,EAAOC,UACPA,EAAY,iBAAgBC,OAC5BA,EAAMC,YACNA,EAAWC,OACXA,IAEA,MAAMC,EAAcC,EAAAA,OAAeC,EAAKA,UACjCC,EAAQC,GAAaC,EAAQA,SAAC,CAAEC,EAAG,EAAGC,EAAG,IAC1CC,EAAcX,GAAU,CAAEY,SAdX,EAcqCC,WAAW,IAC9DC,EAAWC,GAAgBP,EAAQA,UAAC,GAErCQ,EAAYZ,SAA2B,MACvCa,EAAmBb,EAAAA,SA6BnBc,EAAiB,KACrBD,EAAiBE,QAAUC,YAAW,KACpCL,GAAa,EAAM,GAClB,GAAG,EAkBFM,EAAuB,YAAXnB,EAAuBc,EAAY,CAAEG,QAASb,GAuBhE,MAAO,CACLgB,eAtBAR,GAAwB,MAAXhB,EACXyB,EAACC,IAAAC,kBACCF,EAACC,IAAAE,YACCL,UAAWA,EACXtB,UAAWA,EACXY,YAAaA,EACbgB,YAAa,CAAEd,WAAW,EAAOD,UAAU,GAC3CgB,aAAc,CAAEf,WAAW,EAAMD,UAAU,YAC3CW,EACEC,IAAA,MAAA,CAAAK,KAAK,UACLC,GAAI3B,EAAYgB,QAChBY,UAAWC,EAAAA,OAAOC,gBAClBC,MAAO,CAAEjC,eACTkC,eAxCoB,KAC5BC,aAAanB,EAAiBE,QAAQ,EAwC9BD,eAAgBA,EACfmB,SAAAvC,QAIL,KAIJwC,aAAc,CACZ,mBAAoBnC,EAAYgB,QAChCoB,QA1CaC,IACI,WAAfA,EAAMC,MACRD,EAAME,iBACN3B,GAAa,IAEE,YAAfyB,EAAMC,MACS,cAAfD,EAAMC,MACS,eAAfD,EAAMC,MACS,cAAfD,EAAMC,MACS,QAAfD,EAAMC,MAEN1B,GAAa,EACd,EA+BCG,iBACAiB,eAjEoBK,IAClBA,EAAMG,aAAeC,MAAMC,WAAaL,EAAMG,aAAeC,MAAME,iBACrE9B,EAAUG,QAAUqB,EAAMO,cAC1BhC,GAAa,GACd,EA8DCiC,cA9EmBR,IACrBjC,EAAU,CAAEE,EAAG+B,EAAMS,QAASvC,EAAG8B,EAAMU,UACvCnC,GAAa,EAAK,EA6EhBoC,QA1EaX,IACXA,EAAMG,aAAeC,MAAMC,WAAaL,EAAMG,aAAeC,MAAME,iBACrE9B,EAAUG,QAAUqB,EAAMY,OAC1BrC,GAAa,GACd,EAuECsC,OA7DW,KACbtC,GAAa,EAAM,GA+DvB"}