{"version":3,"file":"LineSeries-797d8d16.js","sources":["../../src/PRIVATE_Chart/MarkerLabel.tsx","../../src/PRIVATE_LineAreaComponents/LineSeries.tsx","../../src/PRIVATE_Chart/MarkersWithLabel.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { styles } from '#PRIVATE_Chart/themes/ChartStyles.css';\nimport { VNode } from 'preact';\nimport { classNames } from '#utils/UNSAFE_classNames';\nimport { VisLabelStyle } from '#utils/UNSAFE_visTypes/common/textTypes';\nimport { updateVisTextStyleProperties } from '#utils/UNSAFE_visUtils/textUtils';\nimport { Dimension } from '#utils/UNSAFE_visTypes/common';\nimport { Font } from '#hooks/PRIVATE_useTextDimensions';\nimport { getLabelPosition } from '#utils/PRIVATE_chartUtils/utils';\n\nconst DEFAULT_POSITION = 'center';\n\ntype Props = {\n  labelPosition?: 'belowMarker' | 'aboveMarker' | 'beforeMarker' | 'afterMarker' | 'center';\n  label?: string;\n  labelStyle?: VisLabelStyle;\n  tx?: number;\n  ty?: number;\n  defaultFontSize: string;\n  dataLabelEffect: 'outline' | 'none';\n  isHighContrast: boolean;\n  getTextDimensions?: (text: string, style: Font) => Dimension;\n};\n\nexport function MarkerLabel({\n  labelPosition,\n  label,\n  labelStyle,\n  tx,\n  ty,\n  defaultFontSize,\n  dataLabelEffect,\n  isHighContrast,\n  getTextDimensions\n}: Props) {\n  let markerLabel: VNode | null = null;\n  const position = labelPosition ? labelPosition : DEFAULT_POSITION;\n  const { dataLabelStyle, dataLabelContrast, highContrastLabelStyle } = styles;\n  const labelString = label;\n\n  if (position && labelString) {\n    const markerLabelStyle = {\n      fontSize: defaultFontSize,\n      ...updateVisTextStyleProperties(labelStyle)\n    };\n\n    const labelDims = getTextDimensions?.(labelString, markerLabelStyle);\n    const { x, y } = getLabelPosition(position, tx, ty, labelDims);\n    markerLabel = (\n      <text\n        x={x}\n        y={y}\n        class={classNames([\n          dataLabelStyle,\n          dataLabelEffect === 'outline' ? dataLabelContrast : '',\n          isHighContrast ? highContrastLabelStyle : ''\n        ])}\n        style={markerLabelStyle}>\n        {labelString}\n      </text>\n    );\n  }\n  return markerLabel;\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ColorProps } from '#utils/UNSAFE_interpolations/colors';\nimport { getCmdsForLine } from '#utils/PRIVATE_chartUtils/utils';\nimport { Point } from '#utils/PRIVATE_visSVGUtils';\nimport { rgba } from '#UNSAFE_Theme';\nimport { colorSchemeVars } from '#Common/themes/themeContract.css';\nimport { styles } from '#PRIVATE_Chart/themes/ChartStyles.css';\nimport { Property } from 'csstype';\n\ntype LineSeriesProps = {\n  color: ColorProps['color'];\n  lineStyle?: 'dotted' | 'dashed' | 'solid';\n  lineColor?: Property.Color;\n  lineWidth?: number;\n  lineType?: 'straight' | 'curved';\n  isHorizontal: boolean;\n  lineSegmentCoords: Point[][];\n  isHighlighted: boolean;\n  seriesIndex: number;\n};\n\nexport function LineSeries({\n  color,\n  isHorizontal,\n  lineType = 'straight',\n  lineColor,\n  lineStyle,\n  lineWidth = 3,\n  isHighlighted,\n  lineSegmentCoords,\n  seriesIndex\n}: LineSeriesProps) {\n  const style = {\n    stroke: lineColor || color,\n    strokeDasharray: lineStyle === 'dotted' ? 3 : lineStyle === 'dashed' ? 6 : undefined,\n    strokeWidth: lineWidth,\n    fill: rgba(colorSchemeVars.palette.neutral[0], 0)\n  };\n\n  return (\n    <>\n      {lineSegmentCoords.map((value: Point[]) => {\n        if (value.length < 2) {\n          return;\n        }\n        const cmds = getCmdsForLine(value, lineType, isHorizontal);\n        return lineType === 'straight' ? (\n          <polyline\n            points={cmds}\n            style={style}\n            className={isHighlighted ? undefined : styles.dimmed}\n            data-oj-series-index={seriesIndex}\n            data-oj-object={'line'}\n          />\n        ) : (\n          <path\n            d={cmds}\n            style={style}\n            className={isHighlighted ? undefined : styles.dimmed}\n            data-oj-series-index={seriesIndex}\n            data-oj-object={'line'}\n          />\n        );\n      })}\n    </>\n  );\n}\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { ColorProps } from '#utils/UNSAFE_interpolations/colors';\nimport { LineAreaItem } from '#UNSAFE_LineAreaChart/lineAreaChart.types';\nimport { Marker, MARKER_PADDING } from '#PRIVATE_SvgShapes';\nimport { MarkerShapes } from '#utils/UNSAFE_visTypes/common';\nimport { getGroupCenterCoord } from '#utils/PRIVATE_chartUtils/layoutUtils';\nimport { ChartSeriesData, Scale, Group } from '#utils/UNSAFE_visTypes/chart';\nimport { getMarkerFillAndStroke } from '#utils/PRIVATE_chartUtils/utils';\nimport { useTranslationBundle } from '#hooks/UNSAFE_useTranslationBundle';\nimport type { BundleType } from '#resources/nls/bundle';\nimport { getItemAriaLabel } from '#utils/PRIVATE_chartUtils/accUtils';\nimport { supportsMobileScreenReader } from '#utils/UNSAFE_visUtils';\nimport { MarkerLabel } from './MarkerLabel';\nimport { styles } from '#PRIVATE_Chart/themes/ChartStyles.css';\nimport { Dimension } from '#utils/UNSAFE_visTypes/common';\nimport { Font } from '#hooks/PRIVATE_useTextDimensions';\nimport { ScatterItem } from '#UNSAFE_ScatterChart/scatterChart.types';\n\nconst MARKER_DEFAULT_SIZE = 10;\ntype MarkersProps<K, D> = {\n  yScale: Scale;\n  xScale: Scale;\n  startIndex: number;\n  endIndex: number;\n  seriesIndex: number;\n  series: ChartSeriesData<K, D>;\n  markerType: MarkerShapes;\n  color: ColorProps['color'];\n  groups: Group[];\n  focusedItemIndex?: number;\n  isSelectionEnabled: boolean;\n  hoveredItemIndex?: number;\n  selectedIds?: Set<string | number>;\n  hiddenIds?: Set<string | number>;\n  highlightedIds?: Set<string | number>;\n  activeId?: string;\n  orientation: 'horizontal' | 'vertical';\n  isDrillEnabled: boolean;\n  isLog: boolean;\n  isPointInsideMarquee: ((id: K, point: { x: number; y: number }) => boolean) | undefined;\n  getDataItem: (seriesIndex: number, groupIndex: number) => D | undefined;\n  timeAxisType?: 'enabled' | 'skipGaps' | 'mixedFrequency';\n  defaultFontSize: string;\n  dataLabelEffect: 'outline' | 'none';\n  isHighContrast: boolean;\n  isTestEnv?: boolean;\n  isDataXAxis?: boolean;\n  getTextDimensions?: (text: string, style: Font) => Dimension;\n};\n\nexport function MarkersWithLabel<\n  K extends string | number,\n  D extends LineAreaItem<K> | ScatterItem<K>\n>({\n  yScale,\n  xScale,\n  color,\n  seriesIndex,\n  startIndex,\n  endIndex,\n  hiddenIds,\n  selectedIds,\n  highlightedIds,\n  orientation,\n  isLog,\n  markerType,\n  getDataItem,\n  focusedItemIndex,\n  hoveredItemIndex,\n  isDrillEnabled,\n  activeId,\n  isSelectionEnabled,\n  timeAxisType,\n  isPointInsideMarquee,\n  series,\n  groups,\n  defaultFontSize,\n  dataLabelEffect,\n  isHighContrast,\n  isTestEnv,\n  isDataXAxis,\n  getTextDimensions\n}: MarkersProps<K, D>) {\n  const isHoriz = orientation === 'horizontal';\n  const items = [];\n\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n\n  for (let groupIndex = startIndex; groupIndex < endIndex + 1; groupIndex++) {\n    const item = getDataItem(seriesIndex, groupIndex);\n    if (!item || hiddenIds?.has(item.id)) {\n      continue;\n    }\n    let x, y;\n    const itemHasValue = 'value' in item;\n    if (isDataXAxis && 'y' in item) {\n      x = xScale.transform(item.x);\n      y = yScale.transform(item.y);\n    } else {\n      const value = itemHasValue ? item?.value : undefined;\n      if (value == null || (isLog && value <= 0)) {\n        continue;\n      }\n      x = isHoriz\n        ? yScale.transform(value)\n        : getGroupCenterCoord<K, D>(groups[groupIndex], groupIndex, xScale, item, timeAxisType);\n      y = isHoriz\n        ? getGroupCenterCoord<K, D>(groups[groupIndex], groupIndex, xScale, item, timeAxisType)\n        : yScale.transform(value);\n    }\n    const isFocused = focusedItemIndex === groupIndex;\n    const isHovered = hoveredItemIndex === groupIndex;\n    const isSelected = !!(selectedIds?.has(item.id!) || isPointInsideMarquee?.(item.id, { x, y })); // TODO: tagcloud has isItemSelected we should look to leverage here\n    const isDrillable = item.drilling === 'on' || (item.drilling != 'off' && isDrillEnabled);\n    const isHighlighted =\n      !highlightedIds || highlightedIds?.size === 0 || highlightedIds?.has(item.id); // TODO: tagcloud has isItemHighlighted we should look to leverage here\n    const { fill, stroke, outerStroke } = getMarkerFillAndStroke(\n      !!item.isMarkerDisplayed,\n      isSelectionEnabled,\n      isHovered,\n      isFocused,\n      isSelected,\n      color,\n      item.markerColor\n    );\n    const itemMarkerType = item.isMarkerDisplayed ? item.markerType || markerType : markerType;\n    const isActive = isFocused || isHovered;\n    const ariaLabel =\n      supportsMobileScreenReader || isActive\n        ? getItemAriaLabel(\n            translations,\n            series.name || series.id.toString(),\n            groups[groupIndex].name || groups[groupIndex].id,\n            isSelectionEnabled,\n            isSelected,\n            isDrillable,\n            item.accessibleLabel,\n            itemHasValue ? item.value : undefined,\n            item.x,\n            'y' in item ? item.y : undefined\n          )\n        : undefined;\n\n    const dataInfo = {\n      'data-oj-series-index': seriesIndex,\n      'data-oj-group-index': groupIndex,\n      'data-oj-object': 'item',\n      id: isActive ? activeId : undefined,\n      role: ariaLabel ? 'img' : undefined,\n      'aria-label': ariaLabel,\n      'data-oj-private-item-id': isTestEnv ? item.id : undefined\n    };\n\n    const markerSize = (item.markerSize || MARKER_DEFAULT_SIZE) + 2 * MARKER_PADDING;\n    items.push(\n      <>\n        <Marker\n          type={itemMarkerType}\n          tx={x}\n          ty={y}\n          isInteractive={isDrillable || isSelectionEnabled}\n          scale={1}\n          fill={fill}\n          stroke={stroke}\n          outerStroke={outerStroke}\n          width={markerSize}\n          height={markerSize}\n          dataInfo={dataInfo}\n          preserveRectAspectRatio\n          styleClass={isHighlighted ? undefined : styles.dimmed}\n        />\n        <MarkerLabel\n          labelPosition={item.labelPosition}\n          label={item.label}\n          labelStyle={item.labelStyle}\n          tx={x}\n          ty={y}\n          defaultFontSize={defaultFontSize}\n          dataLabelEffect={dataLabelEffect}\n          isHighContrast={isHighContrast}\n          getTextDimensions={getTextDimensions}\n        />\n      </>\n    );\n  }\n  return <>{items}</>;\n}\n"],"names":["DEFAULT_POSITION","MarkerLabel","labelPosition","label","labelStyle","tx","ty","defaultFontSize","dataLabelEffect","isHighContrast","getTextDimensions","markerLabel","position","dataLabelStyle","dataLabelContrast","highContrastLabelStyle","styles","labelString","markerLabelStyle","fontSize","updateVisTextStyleProperties","labelDims","x","y","getLabelPosition","_jsx","class","classNames","style","color","isHorizontal","lineType","lineColor","lineStyle","lineWidth","isHighlighted","lineSegmentCoords","seriesIndex","stroke","strokeDasharray","undefined","strokeWidth","fill","rgba","colorSchemeVars","palette","neutral","map","value","length","cmds","getCmdsForLine","jsx","points","className","dimmed","d","yScale","xScale","startIndex","endIndex","hiddenIds","selectedIds","highlightedIds","orientation","isLog","markerType","getDataItem","focusedItemIndex","hoveredItemIndex","isDrillEnabled","activeId","isSelectionEnabled","timeAxisType","isPointInsideMarquee","series","groups","isTestEnv","isDataXAxis","isHoriz","items","translations","useTranslationBundle","groupIndex","item","has","id","itemHasValue","transform","getGroupCenterCoord","isFocused","isHovered","isSelected","isDrillable","drilling","size","outerStroke","getMarkerFillAndStroke","isMarkerDisplayed","markerColor","itemMarkerType","isActive","ariaLabel","supportsMobileScreenReader","getItemAriaLabel","name","toString","accessibleLabel","dataInfo","role","markerSize","MARKER_PADDING","push","_jsxs","jsxs","_Fragment","Fragment","children","Marker","type","isInteractive","scale","width","height","preserveRectAspectRatio","styleClass"],"mappings":"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"}