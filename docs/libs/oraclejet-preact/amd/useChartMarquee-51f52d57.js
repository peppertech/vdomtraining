define(['exports', 'preact/jsx-runtime', 'preact/hooks', './clientUtils-009e930e', './useVisDragModeControls-a5685835', './hooks/PRIVATE_useChartMarquee/themes/useChartMarquee.css'], (function(t,e,n,r,o,i){"use strict";function a(t,e){return"zoom"===t||"select"===t?"crosshair":"pan"===t?e?"grabbing":"grab":void 0}function s(t,e,n){return t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height}function u(t,e,n,r,o){return!(s(t,e,n)||s(t,e,r)||s(t,e,o))}function c({x1:t,y1:n,width:r,height:o}){return e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:t,y:n,width:r,height:o,class:i.styles.visMarquee,"data-oj-id":"marquee"}),e.jsx("rect",{x:t+1,y:n+1,width:Math.max(0,r-2),height:Math.max(0,o-2),class:i.styles.visMarqueeInnerArea})]})}t.useChartMarquee=function({plotAreaSpace:t,xSpace:i,ySpace:h,dragMode:x,chartWidth:f,isMultiSelection:d,onViewportChange:m,isZoomScroll:M,xAxisExtent:l,xScale:g,selectedIds:y,getDataById:p,onSelectionChange:v,viewportMax:w,viewportMin:S,isRtl:C,xAxisMinExtent:P}){const q=r.isTouch(),z=n.useRef(!1),R=n.useRef(0),b=n.useRef(),A=function(t,e,n){return!(!n||!t||"user"!==e&&"pan"!==e)}(M,x,q),B=function(t,e,n){return!!t&&(e&&"zoom"===n||!e&&"user"===n)}(M,q,x),j=function(t,e,n){return!!t&&("user"===n||e&&"select"===n)}(d,q,x),{dragButtonDivRef:D,toggleButtonContent:I,userDragMode:E}=o.useVisDragModeControls({componentWidth:f,plotAreaSpace:t,isRtl:C,showPanButton:A,showZoomButton:B,showSelectButton:j,dragMode:x}),[T,V]=n.useState(!1),[k,K]=n.useState(),U=n.useRef(new Set),W=function(t,e,n,r,o){return null!=o&&t?o:"user"!==r||n?n?"off":r:e?"pan":"off"}(A&&"pan"===E||j&&"select"===E||B&&"zoom"===E,M,q,x,E),X=function(t,e,n,r,o,i){if(t&&e){const a=n.x+n.width,u=n.y+n.height;let c=Math.max(Math.min(t.x,e.x),n.x),h=Math.min(Math.max(t.x,e.x),a),x=Math.max(Math.min(t.y,e.y),n.y);const f=Math.min(Math.max(t.y,e.y),u);let d=Math.abs(h-c),m=Math.abs(f-x);return s(t.x,t.y,r)||i?(x=n.y,m=n.height):s(t.x,t.y,o)&&(c=n.x,h=a,d=n.width),{x1:c,y1:x,width:d,height:m,x2:h,y2:f}}}(b.current,k,t,i,h,"zoom"===W);let Y;const Z="select"===W&&X?(t,e)=>{if(b.current?.isMeta&&y?.has(t))return!0;const{x1:n,x2:r,y1:o,y2:i}=X,{x:a,y:u}=e;return s(a,u,{x:n,width:r-n,y:o,height:i-o})?(U.current?.add(t),!0):(U.current?.delete(t),!1)}:void 0;return!X||"zoom"!==W&&"select"!==W||(Y=e.jsx(c,{...X})),{cursor:a(W,T),yAxisCursor:"zoom"!==W?a(W,T):"initial",marqueeContent:Y,toggleButtonContent:!T&&(!q&&z.current||q)&&I,isPointInsideMarquee:Z,dragMode:W,marqueeProps:"off"!=x?{onPointerDown:e=>{if(D?.current?.contains(e.target))return;const n=e.offsetX,r=e.offsetY;V(!0),u(n,r,t,i,h)||"zoom"===W&&s(n,r,h)||(b.current={x:n,y:r})},onPointerMove:e=>{if(!T)return;e.metaKey&&b.current&&(b.current.isMeta=!0);const n=e.offsetX,r=e.offsetY;if(!(u(n,r,t,i,h)||"zoom"===W&&s(n,r,h))){if("pan"===W&&m&&(!q||q&&1===R.current)){const t=g.invert(n)-g.invert(k?.x||b.current?.x),e=w-S;let r=S-t,o=w-t;r<l.min&&(r=l.min,o=r+e),o>l.max&&(o=l.max,r=o-e),r!=S&&o!=w&&Math.abs(o-r)>P&&m({xMin:r,xMax:o})}K({x:n,y:r})}},onPointerUp:t=>{if(V(!1),K(void 0),b.current=void 0,!D.current?.contains(t.target)&&X){if("zoom"===W){const{x1:t,x2:e}=X;let n=Math.min(g.invert(t),g.invert(e)),r=Math.max(g.invert(t),g.invert(e));if(Math.abs(r-n)<P){const t=(n+r)/2;n=Math.max(l.min,t-P/2),r=Math.min(l.max,n+P)}m?.({xMin:n,xMax:r})}if("select"===W){const e=[...new Set([...U.current,...t.metaKey&&y||new Set])],n=e.map((t=>p(t)));v?.({ids:e,data:n}),U.current=new Set}}},onPointerLeave:t=>{z.current=!1,X&&q&&"off"!=W&&t.currentTarget.setPointerCapture(t.pointerId)},onPointerEnter:()=>{z.current=!0},onTouchEnd:t=>{V(!1),K(void 0),b.current=void 0,R.current=t.touches.length},onTouchStart:t=>{R.current=t.touches.length}}:{}}}}));
//# sourceMappingURL=useChartMarquee-51f52d57.js.map
