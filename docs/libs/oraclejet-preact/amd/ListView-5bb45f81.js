define(['exports', 'preact/jsx-runtime', 'preact/compat', 'preact/hooks', './LayerHost-639b3284', 'css!./DragAndDropStyles.styles.css', 'css!./ReorderableItemStyles.styles.css', './ReorderableContext-6d10a1b7', './HiddenAccessible-037ef42d', './collectionUtils-17f5cc64', './useReorderableItem-726c3c03', './classNames-08d99695', './UNSAFE_ListView/themes/ListViewStyles.css', './keys-4755c121', './mergeProps-bcfa6a92', './List-0b764e84', './Menu-5d447084', './MenuItem-87cd59b8', 'preact', './logger-0f873e29', 'css!./TooltipContentStyles.styles.css', 'module', './hooks/UNSAFE_useTooltip/themes/redwood/TooltipContentVariants.css', './tooltipUtils-e5bdb734', 'css!./IconStyle.styles.css', './SelectMenuGroupContext-67f24a8f', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./MenuSeparatorStyles.styles.css', 'module', './UNSAFE_Menu/themes/redwood/MenuSeparatorVariants.css', './useItemAction-821d1b6e', './useContextMenuGesture-d55fbea5'], (function(e,r,t,o,n,s,l,i,c,u,a,d,f,y,m,g,p,x,C,h,I,R,b,S,v,M,E,P,T,O,K,k){"use strict";const w=(e,r)=>{if(null!=e){const t=e.querySelectorAll("[role='row']");if(t.length>r)return u.getKey(t[r])}return null};function L(e,r){const t=Math.abs(null==r?e.scrollTop:r),o={y:t,key:void 0,offsetY:void 0};let n=0;const s=e.querySelectorAll("[role='row']");if(s.length>0&&0===t)return o.key=w(e,0),o.offsetY=0,o;for(let r=0;r<s.length;r++){const l=s[r].getBoundingClientRect().height;if(n+=l,t<n){o.key=w(e,r),o.offsetY=l+t-n;break}}return o}function D(e,r){const t=function(e,r){if(null!=r){let t,o=!1;if(null!=r.key?(o=!0,t=r.key):null!=r.offsetY&&null==r.y&&(o=!0,t=L(e).key),o){if(null!=t){let o=0;const n=e.querySelectorAll("[role ='row']");for(let e=0;e<n.length;e++){if(t===u.getKey(n[e]))return o+(null!=r.offsetY?r.offsetY:0);o+=n[e].getBoundingClientRect().height}}}else if(null!=r.y)return r.y}return}(e,r);e.scrollTop=null!=t?t:0}const j=t.memo((function({children:e,dragKey:t,setDragKey:n,onReorder:s,rootRef:l,itemKey:i}){const c=o.useRef(null),m={itemOverlayFront:f.styles.reorderableItemOverlayFront,itemOverlayRear:f.styles.reorderableItemOverlayRear,itemDragger:f.styles.reorderableItemDragger},g=o.useCallback((e=>{e.dataTransfer?.setData("text/listview-items-key",JSON.stringify(i))}),[i]),{rootProps:p,isDragged:x,overlayZoneBeforeProps:C,overlayZoneAfterProps:h}=a.useReorderableItem({isDisabled:!s,dragKey:t,setDragKey:n,onReorder:s,rootRef:l,ref:c,getItem:()=>c?.current?.closest(u.ITEM_SELECTOR),setTransferData:g,itemStyles:m,itemSelector:u.ITEM_SELECTOR,isVertical:!0}),I=d.classNames([p?.class,f.styles.reorderableItemDnd]);return r.jsxs("div",{...p,class:I,children:[e,!x&&y.isKeyDefined(t)&&r.jsxs(r.Fragment,{children:[r.jsx("div",{...C}),r.jsx("div",{...h})]})]})}),((e,r)=>!(!e||!r)&&(e?.children===r?.children&&e?.dragKey===r?.dragKey)));function A({contextMenuConfig:e,contextMenuContext:t,...o}){const n=e.accessibleLabel;return r.jsx(r.Fragment,{children:r.jsx(p.Menu,{...o,...n&&{"aria-label":n},children:o.isOpen&&e.itemsRenderer(t)})})}const F={mouse:{initialFocus:"menu",placement:"bottom-start",offsetValue:0},keyboard:{initialFocus:"firstItem",placement:"bottom-start",offsetValue:0},touch:{initialFocus:"menu",placement:"end",offsetValue:40}},_={isOpen:!1,initialFocus:"menu",placement:"bottom-start",offsetValue:0,anchorRef:{current:null}},V=t.forwardRef(((e,t)=>{const{contextMenuConfig:n}=e,s=o.useRef(),l=o.useRef(null),{currentItemOverride:d,updateCurrentItemOverride:f}=(e=>{const r=o.useRef(),t=o.useRef();t.current!==e&&(t.current=e,r.current=e);const n=o.useCallback((e=>{r.current={rowKey:e}}),[]);return{currentItemOverride:r.current,updateCurrentItemOverride:n}})(e.currentItemOverride),y=e.data?e.data.map((r=>({data:r,metadata:{key:e.getRowKey(r)}}))):null,p=e.onLoadMore?e.onLoadMore:()=>{},x=y?{offset:0,data:y,sizePrecision:e.hasMore?"atLeast":"exact",totalSize:y.length}:null;o.useImperativeHandle(t,(()=>({getScrollPosition:()=>l.current?L(l.current):{y:0},focus:()=>{l.current&&l.current.focus()}}))),o.useLayoutEffect((()=>{l.current&&s.current!==e.scrollPositionOverride&&(D(l.current,e.scrollPositionOverride),s.current=e.scrollPositionOverride)}),[e.scrollPositionOverride]);const C=null!=e.onReorder,{reorderProps:h,reorderItemProps:I,reorderContext:R,reorderInstructionsId:b,reorderInstructions:S}=(({onReorder:e,rootRef:r,viewportConfig:t})=>{const n=null!=e,[s,l]=o.useState(void 0),{reorderProps:i,reorderContext:c,reorderInstructionsId:d,reorderInstructions:f}=a.useReorderable({onReorder:e,rootRef:r,itemSelector:u.ITEM_SELECTOR,isDisabled:!n,columns:1}),y=o.useRef(!1);return o.useEffect((()=>{if(n&&y.current){const e=r.current,o=u.findElementByKey(e,c.currentItemKey.current,u.ITEM_SELECTOR);if(o){const r=t?.scroller()||e;g.scrollToVisible(o,r,0),y.current=!1}}})),n?{reorderProps:m.mergeProps({onKeyDown:e=>{n&&("ArrowUp"===e.key||"ArrowDown"===e.key)&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&(y.current=!0,i.onKeyDown?.(e))},onDragOver:e=>{void 0!==s&&(y.current=!1,u.dragToScroll(e,void 0!==s,r.current))}}),reorderItemProps:{dragKey:s,setDragKey:l,onReorder:e,rootRef:r},reorderContext:c,reorderInstructionsId:d,reorderInstructions:f}:{reorderProps:i,reorderContext:c,reorderInstructionsId:d,reorderInstructions:f}})({onReorder:e.onReorder,rootRef:l,viewportConfig:e.viewportConfig}),{triggerProps:v,menuProps:M,contextMenuContext:E,notifyCurrentKeyChanged:P}=((e,r,t,n)=>{const[s,l]=o.useState(),[i,c]=o.useState(_),a=o.useRef(),{triggerProps:d}=k.useContextMenuGesture((({gesture:r,anchor:o,target:s})=>{let i=o;if("keyboard"===r){i=u.findElementByKey(t.current,a.current,u.ITEM_SELECTOR)||o;const r=K.findItemContext(a.current,e);l(r)}else{const r=u.keyExtractor(s,u.ITEM_SELECTOR),t=K.findItemContext(r,e);l(t),n(r)}c({...F[r],anchorRef:{current:i},isOpen:!0})}),{isDisabled:!r}),f=o.useCallback((e=>{"dismissed"!==e.reason&&"itemAction"!==e.reason||t.current?.focus({preventScroll:!0}),c({..._})}),[t]);return{menuProps:{...i,onClose:f},onClose:f,contextMenuContext:s,triggerProps:d,notifyCurrentKeyChanged:e=>{a.current=e.value}}})(x,n,l,f),T=r=>{e.onPersistCurrentItem?.(r),P(r)};return C&&I?r.jsxs(r.Fragment,{children:[r.jsxs(i.ReorderableContext.Provider,{value:R,children:[r.jsx(g.List,{...e,"aria-describedby":b,contextMenuTriggerProps:v,reorderProps:h,onLoadRange:p,scrollerRef:l,data:x,currentItemOverride:d,onPersistCurrentItem:T,children:t=>r.jsx(j,{...I,itemKey:t.metadata.key,children:e.children(t)})}),r.jsx("span",{id:b,children:r.jsx(c.HiddenAccessible,{children:S})})]}),n&&r.jsx(A,{...M,contextMenuConfig:n,contextMenuContext:E})]}):r.jsxs(r.Fragment,{children:[r.jsx(g.List,{...e,onLoadRange:p,scrollerRef:l,data:x,contextMenuTriggerProps:v,currentItemOverride:d,onPersistCurrentItem:T,children:e.children}),n&&r.jsx(A,{...M,contextMenuConfig:n,contextMenuContext:E})]})}));e.ListView=V}));
//# sourceMappingURL=ListView-5bb45f81.js.map
