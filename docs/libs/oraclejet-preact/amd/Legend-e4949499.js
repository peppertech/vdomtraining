define(['exports', 'preact/jsx-runtime', 'preact/hooks', './useLegendContextMenu-e629139a', './useVisEvents-dc86164f', './useLegendDnd-6ab55c11', './mergeProps-bcfa6a92', './useItemFocus-75d6510d', './PRIVATE_BaseLegend/themes/LegendStyles.css', './useCssVars-dc52806c', './classNames-08d99695', './useTestId-b5cd4766', './useVisTouchResponse-88a7bb09', './stringUtils-0ae982c2', 'preact/compat', './TrackResizeContainer-2b033ae7', './useTextDimensions-83dd9415', './hooks/PRIVATE_useVisDnd/themes/VisDndStyles.css'], (function(e,t,n,s,o,i,a,d,r,m,l,g,h,c,u,I,x,f){"use strict";function y(e,t){const{itemIdx:n}=e;return-1==n?t[t.length-1]:t[n]}function v(e,t){let n=e.itemIdx;return-1==n&&(n=t.length-1),n=Math.min(t.length-1,n+1),"off"!==t[n].actionable?{sectionIdx:0,itemIdx:n}:n===t.length-1?(n-=1,{sectionIdx:0,itemIdx:n}):v({sectionIdx:0,itemIdx:n},t)}function D(e,t){let n=e.itemIdx;return-1==n&&(n=t.length-1),n=Math.max(0,n-1),"off"!==t[n].actionable?{sectionIdx:0,itemIdx:n}:D({sectionIdx:0,itemIdx:n},t)}function b(e){return{getItem:t=>y(t,e),getDetailFromInfo:t=>{if(!t||0===e.length)return{itemId:void 0,data:void 0};const n=y(t,e);return{itemId:n.id,data:n}},getPrevItemInfo:t=>D(t,e),getNextItemInfo:t=>v(t,e)}}const p=({width:e,getTextDimensions:t,resolvedVars:n,rootRef:s,orientation:o,legendFontStylesObj:i={},symbolWidth:a,items:d})=>{let r=0,m=0,l=0,g=!1;const h=e;if(!s.current||!Object.keys(n).length||!t)return;const c=parseFloat(n.unit),{maxItemWidth:u,maxItemHeight:I,horizontalSectionWidth:x}=R(d,c,t,i,a);l=x,r=u,m=I,g=x>h;return{totalWidth:l,maxItemWidth:Math.min(r,h),maxItemHeight:m,itemsPerRow:"vertical"===o?1:Math.max(1,Math.floor(h/r)),isWrapped:g}},R=(e,t,n,s,o,i)=>{let a=0,d=0,r=0,m=0,l=0;return m=o?1.5*t+o:4*t,l=i?i+1.7*t:2.5*t+1.7*t,e?.forEach((e=>{const o=e,{width:i,height:g}=n(o.text,s),h=2.5*t+i;r+=m+h,a=Math.max(a,m+h),d=Math.max(d,g,l)})),{maxItemWidth:a,maxItemHeight:d,horizontalSectionWidth:r}},S=u.forwardRef((({orientation:e="horizontal",items:y,isReadOnly:v=!0,onItemAction:D,onItemHover:R,onItemFocus:S,testId:W,contextMenuConfig:M,hideAndShowBehavior:P="off",hoverBehavior:C="none",halign:T="start",valign:F="top",...V},L=null)=>t.jsx(I.TrackResizeContainer,{width:"100%",height:"100%",class:l.classNames([r.styles.flexStyle,r.styles[`${T}HAlign`],r.styles[`${F}VAlign`]]),children:function(I){const T=g.useTestId(W),F=n.useRef(null),H=void 0!==T["data-testid"],w=n.useRef(),{getItem:E,getDetailFromInfo:O,getPrevItemInfo:j,getNextItemInfo:A}=b(y),{resolvedVars:z,cssContent:N}=m.useCssVars(i.legendVars),B=i.getLegendTextStyle({fontStyle:V.textFontStyle,fontSize:V.textFontSize?.toString(),fontWeight:V.textFontWeight?.toString(),fontFamily:V.textFontFamily},z),{textMeasureContent:k,getTextDimensions:_}=x.useTextDimensions(),G=p({width:I,getTextDimensions:_,resolvedVars:z,rootRef:F,orientation:e,legendFontStylesObj:B,symbolWidth:V.symbolWidth,symbolHeight:V.symbolHeight,items:y}),U=i.getIsLegendItemActionable(y,v),$=y.length>0,{touchResponse:q,touchResponseStyle:K}=h.useVisTouchResponse({type:"touchStart"}),{focusedItemInfo:J,hoveredItemInfo:Q,onContextMenuDismissed:X,activeId:Y,eventsProps:Z}=o.useVisEvent(q,!v,U,((e,t,n)=>i.getKeyUpHandler(e,t,n,null!=V.hiddenIds)),O,j,A,D,R,S,i.isEqualItem,i.getItemInfo,{itemIdx:0,sectionIdx:0},null!=V.hiddenIds),{focusedItemRef:ee}=d.useItemFocus(J),te=i.getDatatipText(y,E,J,Q),[ne,se]=n.useState(!1),{datatipContent:oe,datatipProps:{"aria-describedby":ie,...ae}}=s.useLegendDatatip({text:te,rootDimsRef:w,focusedItemInfo:J,focusedItemRef:ee,touchResponse:q,isDisabled:ne}),de=i.getAriaProps(v,V["aria-label"],V.hiddenIds,c.merge([V["aria-describedby"],ie]),V["aria-labelledby"]),{contextMenuContent:re,contextMenuProps:me}=s.useLegendContextMenu({rootRef:F,contextMenuConfig:$?M:void 0,focusedItemInfo:J,items:y,isReadOnly:v,onContextMenuDismissed:X}),[le,ge]=n.useState(),{draggable:he,dndProps:ce,dndContent:ue}=i.useLegendDnd({onDrag:V.onDrag,onDragStart:V.onDragStart,onDragEnd:V.onDragEnd,onDragEnter:V.onDragEnter,onDragLeave:V.onDragLeave,onDragOver:V.onDragOver,onDrop:V.onDrop,items:y,setDragOver:ge,setDatatipDisabled:se,itemDraggable:V.itemDraggable}),Ie=a.mergeProps(Z,ae,me,ce),{itemsPerCol:xe,itemsPerRow:fe}=i.getGridNums(y.length,G),{legendStyle:ye,renderedLegendStyle:ve}=r.styles;return u.useImperativeHandle(L,(()=>({_getPreferredSize:(t,n)=>{if(!_)return;const s=p({width:t,getTextDimensions:_,resolvedVars:z,rootRef:F,orientation:e,legendFontStylesObj:B,symbolWidth:V.symbolWidth,symbolHeight:V.symbolHeight,items:y}),{itemsPerCol:o,itemsPerRow:a}=i.getGridNums(y.length,s,e),d=parseFloat(z.unit),r=Math.min(t,1===o?s.totalWidth:a?s.maxItemWidth*a:s.totalWidth),m=.8*d,l=1.5*d,g=o?s.maxItemHeight*o+(o-1)*m+l:s.maxItemHeight+l;return{width:r,height:Math.min(n,g)}}})),[F,_,B,z]),t.jsxs("div",{ref:F,tabIndex:v?void 0:0,role:"application",draggable:he,class:l.classNames([ye,ve,le?f.styles.dndDragOverHTMLStyle:!1===le?f.styles.dndRejectedStyle:void 0]),style:K,...T,...de,...Ie,"aria-activedescendant":Y,children:[t.jsx(s.BaseLegend,{...V,focusedItemRef:ee,items:y,isReadOnly:v,orientation:e,sectionIdx:0,itemsPerRow:fe,itemsPerCol:xe,itemWidth:G?.isWrapped?G?.maxItemWidth:void 0,focusedItemInfo:J,hoveredItemInfo:Q,activeId:Y,hideAndShowBehavior:P,hoverBehavior:C,isTestEnv:H}),oe,k,N,re,ue]})}})));e.Legend=S}));
//# sourceMappingURL=Legend-e4949499.js.map
