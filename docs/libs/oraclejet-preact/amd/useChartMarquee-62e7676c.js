define(['exports', 'preact/jsx-runtime', 'preact/hooks', './clientUtils-95c1280f', './Button-f502d996', './Move-b0566170', './hooks/PRIVATE_useChartMarquee/themes/useChartMarquee.css', './useTranslationBundle-516b1b83', './ZoomAlt-d9ed2f3a', './ButtonSetSingle-9f767e83', './ButtonSetItem-ba9ebe68', './IconToggleButton-28960894'], (function(e,t,o,n,r,i,s,a,u,c,l,d){"use strict";function x(e,t){return"zoom"===e||"select"===e?"crosshair":"pan"===e?t?"grabbing":"grab":void 0}function h({position:e,divRef:o,dragMode:n,onDragModeChange:x,showZoomButton:h,showPanButton:g,showSelectButton:f}){const{right:v,left:m,top:M,bottom:p}=e,S=g&&!f&&!h||!g&&!f&&h||!g&&f&&!h,y=a.useTranslationBundle("@oracle/oraclejet-preact"),B=y.vis_marqueeZoomTooltip(),b=y.vis_panTooltip(),j=y.vis_marqueeSelectTooltip();return h||g||f?t.jsx("div",{ref:o,class:s.styles.background,style:{right:v,left:m,top:M,bottom:p},children:S?t.jsxs(t.Fragment,{children:[g&&t.jsx(d.IconToggleButton,{accessibleLabel:b,isSelected:"pan"===n,onToggle:()=>{x("pan"===n?void 0:"pan")},variant:"outlined",size:"sm",children:t.jsx(i.SvgMove,{})}),h&&t.jsx(d.IconToggleButton,{accessibleLabel:B,isSelected:"zoom"===n,onToggle:()=>{x("zoom"===n?void 0:"zoom")},variant:"outlined",size:"sm",children:t.jsx(u.SvgZoomAlt,{})}),f&&t.jsx(d.IconToggleButton,{accessibleLabel:j,isSelected:"select"===n,onToggle:()=>{x("select"===n?void 0:"select")},variant:"outlined",size:"sm",children:t.jsx(r.SvgButton,{})})]}):t.jsxs(c.ButtonSetSingle,{size:"sm",value:n,onCommit:({value:e})=>{x(e===n?void 0:e)},display:"icons",variant:"outlined",children:[g&&t.jsx(l.ButtonSetItem,{value:"pan",label:b,startIcon:t.jsx(i.SvgMove,{})}),h&&t.jsx(l.ButtonSetItem,{value:"zoom",label:B,startIcon:t.jsx(u.SvgZoomAlt,{})}),f&&t.jsx(l.ButtonSetItem,{value:"select",label:j,startIcon:t.jsx(r.SvgButton,{})})]})}):null}function g({x1:e,y1:o,width:n,height:r}){return t.jsxs(t.Fragment,{children:[t.jsx("rect",{x:e,y:o,width:n,height:r,class:s.styles.visMarquee}),t.jsx("rect",{x:e+1,y:o+1,width:Math.max(0,n-2),height:Math.max(0,r-2),class:s.styles.visMarqueeInnerArea})]})}e.useChartMarquee=function({plotAreaSpace:e,dragMode:r,chartWidth:i,isMultiSelection:s,onViewportChange:a,isZoomScroll:u,xAxisExtent:c,xScale:l,selectedIds:d,getDataById:f,onSelectionChange:v,viewportMax:m,viewportMin:M,isRtl:p}){const S=o.useRef(!1),y=o.useRef(0),B=o.useRef(),{dragButtonDivRef:b,toggleButtonContent:j,userDragMode:w}=function({chartWidth:e,plotAreaSpace:r,isRtl:i,isZoomScroll:s,isMultiSelection:a,dragMode:u}){const c=n.isMobile(),l=o.useRef(null),d=function(e,t,o){return!(!o||!e)&&"select"!==t&&"off"!==t}(s,u,c),x=function(e,t,o){return!(t||!e)&&"user"===o}(s,c,u),g=function(e,t,o,n){return!(!t||!e&&!o&&t||!e&&"user"!==n)}(c,a,s,u),[f,v]=o.useState(c&&s?"pan":void 0);return{dragButtonDivRef:l,toggleButtonContent:t.jsx(h,{position:{top:`${r.y}px`,right:i?void 0:e-r.x-r.width+"px",left:i?`${r.x}px`:void 0},divRef:l,showSelectButton:g,showZoomButton:x,showPanButton:d,dragMode:f,onDragModeChange:v}),userDragMode:f}}({chartWidth:i,plotAreaSpace:e,isRtl:p,isZoomScroll:u,isMultiSelection:s,dragMode:r}),[I,T]=o.useState(!1),[C,R]=o.useState(),z=o.useRef(new Set),P=n.isMobile(),q=function(e,t,o,n){return!t&&"select"===n||!e&&"zoom"===n||"off"===n?"off":"user"===n?o?e?"pan":t?"select":"off":!e&&t?o?"select":"off":e||t?"pan":"off":n}(u,s,P,r),A="user"===r&&w?w:q,D=function(e,t,o){if(t&&o){const n=Math.min(t.x,o.x),r=Math.max(t.x,o.x),i=Math.min(t.y,o.y),s=Math.max(t.y,o.y);return{x1:n,y1:i,width:Math.abs(r-n),height:Math.abs(s-i),x2:r,y2:s,delta:o.x-t.x,axisDelta:e.invert(o.x)-e.invert(t.x)}}}(l,B.current,C);let Z;const E="select"===A&&D?(e,t)=>{if(B.current?.isMeta&&d?.has(e))return!0;const{x1:o,x2:n,y1:r,y2:i}=D,{x:s,y:a}=t;return s<=n&&s>=o&&a<=i&&a>=r?(z.current?.add(e),!0):(z.current?.delete(e),!1)}:void 0;return!D||"zoom"!==A&&"select"!==A||(Z=t.jsx(g,{...D})),{cursor:x(A,I),marqueeContent:Z,toggleButtonContent:!I&&(!P&&S.current||P)&&j,isPointInsideMarquee:E,dragMode:A,marqueeProps:"off"!=r?{onPointerDown:t=>{if(b.current?.contains(t.target))return;const o=t.offsetX,n=t.offsetY;T(!0),o<e.x||o>e.x+e.width||n<e.y||n>e.y+e.height||(B.current={x:o,y:n})},onPointerMove:t=>{if(!I)return;t.metaKey&&B.current&&(B.current.isMeta=!0);const o=t.offsetX,n=t.offsetY;if(!(o<e.x||o>e.x+e.width||n<e.y||n>e.y+e.height)){if("pan"===A&&a&&(!P||P&&1===y.current)){const e=l.invert(o)-l.invert(C?.x||B.current?.x),t=m-M;let n=M-e,r=m-e;n<c.min&&(n=c.min,r=n+t),r>c.max&&(r=c.max,n=r-t),n!=M&&r!=m&&a({xMin:n,xMax:r})}R({x:o,y:n})}},onPointerUp:e=>{if(T(!1),R(void 0),B.current=void 0,b.current?.contains(e.target))return;if(!D)return;const{x1:t,x2:o}=D;if("zoom"===A){const e=Math.min(l.invert(t),l.invert(o)),n=Math.max(l.invert(t),l.invert(o));a?.({xMin:e,xMax:n})}if("select"===A){const t=[...new Set([...z.current,...e.metaKey&&d||new Set])],o=t.map((e=>f(e)));v?.({ids:t,data:o}),z.current=new Set}},onPointerLeave:e=>{S.current=!1,D&&P&&"off"!=A&&e.currentTarget.setPointerCapture(e.pointerId)},onPointerEnter:()=>{S.current=!0},onTouchEnd:e=>{T(!1),R(void 0),B.current=void 0,y.current=e.touches.length},onTouchStart:e=>{y.current=e.touches.length}}:{}}}}));
//# sourceMappingURL=useChartMarquee-62e7676c.js.map
