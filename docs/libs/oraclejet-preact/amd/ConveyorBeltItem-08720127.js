define(['exports', 'preact/jsx-runtime', 'preact/hooks', './BaseButton-19a622bc', './ButtonLabelLayout-2e0e8d09', './ChevronRight-fa7a624c', './ChevronUp-421d2392', './ChevronDown-64f938c5', './classNames-08d99695', './UNSAFE_ConveyorBelt/themes/ConveyorBeltStyles.css', './useUser-3ef25571', './clientHints-4f5a07b0', './ConveyorBeltContext-d8653090', './useTestId-b5cd4766', 'preact/compat', './useComponentTheme-5aa41a8f', './UNSAFE_ConveyorBelt/themes/redwood/ConveyorBeltTheme', './useConveyorBeltItem-ce9e4c40'], (function(e,t,r,o,n,s,i,l,c,u,f,h,a,d,m,v,g,b){"use strict";function C(){return"phone"===h.getClientHints().deviceType}function p(e){return"fixed"===getComputedStyle(e).position?null:e.offsetParent}function x(e,t){let r=p(e),o=e.offsetLeft;for(;r&&r!==t&&r!==document.body;)o+=r.offsetLeft,r=p(r);return o}function y(e,t){let r=p(e),o=e.offsetTop;for(;r!==t;)null!=r&&(o+=r.offsetTop,r=p(r));return o}const W=m.forwardRef((({children:e,scrollPosition:h,onScrollPositionChanged:b,arrowVisibility:p="auto",orientation:W="horizontal",testId:T},B=null)=>{const[H,R]=r.useState(!1),[I,j]=r.useState(!1),w=r.useRef(null),E=r.useRef(null),S=r.useRef(null),L=r.useRef(null),N=r.useRef(null),z=r.useRef(null),k=r.useRef(null),A=r.useRef(null),V=r.useRef(null),[U,$]=r.useState(C()&&"auto"===p||"hidden"===p),{direction:F}=f.useUser(),{itemElementsRef:P,addItem:D}=((e,t,o,n,s)=>{const i=r.useRef(),l=r.useRef([]),[c]=r.useState([]),u=r.useCallback((e=>{null!==l.current&&(l.current.push(e),c.push(e))}),[c]);r.useEffect((()=>{if(c&&c.length>0&&e){const r="horizontal"===t?"ltr"===s?`0px ${n?-n.offsetWidth:0}px 0px ${o?-o.offsetWidth:0}px`:`0px ${o?-o.offsetWidth:0}px 0px ${n?-n.offsetWidth:0}px`:`${n?-n.offsetHeight:0}px 0px ${o?-o.offsetHeight:0}px 0px`;i.current=new IntersectionObserver(f,{root:e,rootMargin:r,threshold:1});for(const e of c)null!=e&&i.current.observe(e.element)}return()=>{for(const e of c)i.current&&null!=e&&i.current.unobserve(e.element)}}),[c,c.length,e,n,o,s,t]);const f=e=>{const t=l.current.map(((t,r)=>{const o=e.find((e=>e.target===t.element));return o?{element:o.target,isVisible:o.isIntersecting,isCurrent:t.isCurrent,index:r}:t}));l.current=t};return r.useMemo((()=>({itemElementsRef:l,addItem:u})),[l,u])})(w.current,W,L.current,S.current,F);m.useImperativeHandle(B,(()=>({scrollElementIntoView:e=>{Y(e)},scrollPrevious:()=>{te()},scrollNext:()=>{re()}})));const q=d.useTestId(T),M="leftArrow"+T,O="rightArrow"+T,{variantClasses:_}=v.useComponentTheme(g.ConveyorBeltRedwoodTheme,{orientation:W}),{variantClasses:G}=v.useComponentTheme(g.ConveyorBeltRedwoodTheme,{content:W}),{variantClasses:J}=v.useComponentTheme(g.ConveyorBeltRedwoodTheme,{pagination:H&&I?"both":H?"next":I?"previous":"none",direction:F,orientation:W,overflow:W,arrowVisibility:!0===U?"hidden":"visible"}),{classes:K}=v.useComponentTheme(g.ConveyorBeltRedwoodTheme,{nextButton:W,direction:F}),{classes:Q}=v.useComponentTheme(g.ConveyorBeltRedwoodTheme,{previousButton:W,direction:F});r.useEffect((()=>{(()=>{const e=E.current?Array.from(E.current.querySelectorAll("[data-oj-conveyorbelt-item]")):[];if(e){let t=-1;for(const r of e){t++;const e=r;e&&null==P.current.find((t=>t.element===e))&&D({element:e,isVisible:!1,index:t,isCurrent:!1})}}})()}));const X=r.useCallback((()=>{b&&b(w.current?.scrollLeft)}),[b]);r.useEffect((()=>{$(C()&&"auto"===p||"hidden"===p)}),[p]),r.useEffect((()=>{w.current&&w.current.scrollTo({left:h})}),[h]),r.useEffect((()=>{const e=w.current,t=z.current,r=k.current;return e&&t&&r&&(U||(A.current=new IntersectionObserver((e=>{e.forEach((e=>{"left"===e.target.getAttribute("data-intersection-id")?j(!e.isIntersecting):R(!e.isIntersecting)}))}),{root:e}),A.current.observe(t),A.current.observe(r)),e.addEventListener("scrollend",X)),()=>{e&&(e.removeEventListener("scrollend",X),A.current?.unobserve(t),A.current?.unobserve(r))}}),[U,X]);const Y=r.useCallback((e=>{const t=((e,t,r)=>{if(!t||!r)return!1;let o,n,s,i;if(r===document.documentElement)o=0,n=document.documentElement.clientWidth,s=0,i=document.documentElement.clientHeight;else{const e=r.getBoundingClientRect();o=I?e.left+L.current?.offsetWidth:e.left,n=H?e.right-S.current?.offsetWidth:e.right,s=I?e.top+L.current?.offsetHeight:e.top,i=H?e.bottom-S.current?.offsetHeight:e.bottom}const l=t.getBoundingClientRect();return"horizontal"===e?l.left<=n&&l.right<=n&&l.left>=o&&l.right>=o:l.top<=i&&l.bottom<=i&&l.top>=s&&l.bottom>=s})(W,e,w.current);if(t)return;const r=((e,t,r)=>{if(!t||!r)return!1;const o=t.getBoundingClientRect(),n=r.getBoundingClientRect();let s=n.width,i=n.height;return"horizontal"===e?(s=I&&L.current?s-L.current.offsetWidth:s,s=H&&S.current?s-S.current.offsetWidth:s):(i=I&&L.current?i-L.current.offsetHeight:i,i=H&&S.current?i-S.current.offsetHeight:i),"horizontal"===e?o.width>s:o.height>i})(W,e,w.current);if(!w.current||!E.current)return;const o=((e,t,r,o)=>{if(!r||!o)return!1;let n,s,i;if(o===document.documentElement)s=0,n=document.documentElement.clientWidth,i=document.documentElement.clientHeight;else{const e=o.getBoundingClientRect();n=H?e.right-S.current?.offsetWidth:e.right,s=H?e.left-S.current?.offsetWidth:e.left,i=H?e.bottom-S.current?.offsetHeight:e.bottom}const l=r.getBoundingClientRect();return"horizontal"===t?e?l.right>n:l.left<s:l.bottom>i})("ltr"===F,W,e,w.current);"vertical"!==W?"ltr"===F?o&&!r?w.current.scrollTo({left:x(e,E.current)+e.offsetWidth-w.current.offsetWidth+(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):w.current.scrollTo({left:x(e,E.current)-(L.current?.offsetWidth?L.current?.offsetWidth+1:0),behavior:"smooth"}):o&&!r?w.current.scrollTo({left:x(e,E.current)-E.current.offsetWidth+w.current.offsetWidth-(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):w.current.scrollTo({left:x(e,E.current)+e.offsetWidth-E.current.offsetWidth+(L.current?.offsetWidth?L.current?.offsetWidth+1:0),behavior:"smooth"}):o&&!r?w.current.scrollTo({top:y(e,E.current)+e.offsetHeight-w.current.offsetHeight+(S.current?.offsetHeight?S.current?.offsetHeight+1:0),behavior:"smooth"}):w.current.scrollTo({top:y(e,E.current)-(L.current?.offsetHeight?L.current?.offsetHeight+1:0),behavior:"smooth"})}),[H,I,F,W]),Z=r.useCallback((()=>{const e=P.current.find((e=>0==e.isVisible&&e.index>=1&&1==P.current[e.index-1].isVisible));return e?.element}),[P]),ee=r.useCallback((()=>{const e=P.current.find((e=>0==e.isVisible&&e.index<P.current.length-1&&1==P.current[e.index+1].isVisible));return e?.element}),[P]),te=r.useCallback((()=>{const e=w.current,t="horizontal"===W?w.current?.clientWidth:w.current?.clientHeight;if(e&&t){const r=ee();if("vertical"===W)return void(r?e.scrollTo({top:y(r,E.current)+r.offsetHeight-e.offsetHeight+(L.current?.offsetHeight?L.current?.offsetHeight+1:0),behavior:"smooth"}):e.scrollTo({top:e.scrollTop-t,behavior:"smooth"}));"ltr"===F?r?e.scrollTo({left:x(r,E.current)+r.offsetWidth-e.offsetWidth+(L.current?.offsetWidth?L.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft-t,behavior:"smooth"}):r?e.scrollTo({left:x(r,E.current)-E.current?.offsetWidth+e.offsetWidth-(L.current?.offsetWidth?L.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft+t,behavior:"smooth"})}}),[F,W,ee]),re=r.useCallback((()=>{const e=w.current,t="horizontal"===W?w.current?.clientWidth:w.current?.clientHeight;if(e&&t){const r=Z();if("vertical"===W)return void(r?e.scrollTo({top:y(r,E.current)-(S.current?.offsetHeight?S.current?.offsetHeight+1:0),behavior:"smooth"}):e.scrollTo({top:e.scrollTop+t,behavior:"smooth"}));"ltr"===F?r?e.scrollTo({left:(x(r,E.current)??0)-(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft+t,behavior:"smooth"}):r?e.scrollTo({left:-(E.current?.offsetWidth-(x(r,E.current)??0))+(r?.offsetWidth??0)+(S.current?.offsetWidth?S.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft-t,behavior:"smooth"})}}),[F,W,Z]),oe=r.useCallback((e=>{if(V.current!==e){const t=P.current.find((t=>t.element===e)),r=P.current.find((e=>!0===e.isCurrent));if(t===r||!t)return;r&&(r.isCurrent=!1),t.isCurrent=!0,V.current=e,e&&Y(e)}}),[P,Y]),ne=r.useCallback((e=>{if(!N.current?.isEqualNode(e.target))if(P.current.length>0){const t=P.current.find((t=>t.element.contains(e.target)));t&&Y(t.element)}else Y(e.target)}),[Y,P]),se=c.classNames([u.styles.buttonContainer,Q]),ie=c.classNames([u.styles.buttonContainer,K]);return t.jsx(a.ConveyorBeltContext.Provider,{value:{setCurrentItem:oe},children:t.jsxs("div",{onFocus:ne,ref:N,className:c.classNames([u.styles.conveyorStyle,_]),...q,children:[I&&!U&&t.jsx("div",{ref:L,class:se,children:t.jsx(o.BaseButton,{elementDetails:{type:"span",isFocusable:!1},styling:["min"],size:"sm",variant:"ghost",onAction:()=>te(),"aria-hidden":!0,testId:M,children:t.jsx(n.ButtonLabelLayout,{size:"sm",display:"icons",startIcon:"horizontal"===W?"ltr"===F?t.jsx(s.SvgChevronLeft,{}):t.jsx(s.SvgChevronRight,{}):t.jsx(i.SvgChevronUp,{})})})}),t.jsx("div",{className:c.classNames([u.styles.overflowContainer,J]),ref:w,tabIndex:-1,children:t.jsxs("div",{className:c.classNames([u.styles.contentContainer,_,G]),ref:E,children:[t.jsx("div",{"data-intersection-id":"left",ref:z,style:{minWidth:1,minHeight:1}}),e,t.jsx("div",{"data-intersection-id":"right",ref:k,style:{minWidth:1,minHeight:1}})]})}),H&&!U&&t.jsx("div",{ref:S,class:ie,children:t.jsx(o.BaseButton,{elementDetails:{type:"span",isFocusable:!1},styling:["min"],size:"sm",variant:"ghost",onAction:()=>re(),"aria-hidden":!0,testId:O,children:t.jsx(n.ButtonLabelLayout,{size:"sm",display:"icons",startIcon:"horizontal"===W?"ltr"===F?t.jsx(s.SvgChevronRight,{}):t.jsx(s.SvgChevronLeft,{}):t.jsx(l.SvgChevronDown,{})})})})]})})}));e.ConveyorBelt=W,e.ConveyorBeltItem=({children:e,isCurrent:r})=>{const o=b.useConveyorBeltItem({isCurrent:r});return t.jsx("div",{className:c.classNames([u.styles.conveyorBeltItemStyle]),...o,children:e})}}));
//# sourceMappingURL=ConveyorBeltItem-08720127.js.map
