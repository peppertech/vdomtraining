define(['exports', 'preact/jsx-runtime', './TrackResizeContainer-74ef32df', './UNSAFE_Diagram/themes/DiagramStyles.css', './useResizeObserver-c63865cc', 'preact/hooks', './accUtils-1557920a', './classNames-08d99695', './useTranslationBundle-516b1b83', './useUser-85c781ea', './layoutUtils-3c2d340e', './useVisHover-28319fef', './mergeProps-bcfa6a92', './useDatatip-87792500', './util-5bb1f200', './useTextDimensions-b37344b4', './useSelection-396ce75f', './useVisTouchResponse-36416652', './stringUtils-0ae982c2'], (function(e,t,n,o,r,i,s,a,d,c,u,l,f,h,p,g,m,y,x){"use strict";const b=20;function w(e){const t=new Map,n=new Map,o=new Map;for(let r=0;r<e.length;r++)t.set(e[r].id,e[r]),n.set(e[r].id,r),o.set(r,e[r].id);return{itemIdToDataMap:t,itemIdToIndexMap:n,itemIndexToIdMap:o}}function I(e,t){const n=[];if(e)for(let t=0;t<e.length;t++)n.push(e[t]);if(t)for(let e=0;e<t.length;e++)n.push(t[e]);return n}function v(e,t,n){const o=N(t,e,n);if(e.rotationAngle){const n=e.rotationPoint?e.rotationPoint:{x:t.width/2,y:t.height/2},r=e.rotationAngle,i=P({x:0,y:0},n),s=P({x:t.width,y:0},n),a=P({x:0,y:t.height},n),d=P({x:t.width,y:t.height},n);return function(e){let t=e[0].x,n=e[0].y,o=e[0].x,r=e[0].y;for(let i=1;i<e.length;i++){const s=e[i];s.x<t?t=s.x:s.x>o&&(o=s.x),s.y<n?n=s.y:s.y>r&&(r=s.y)}return{x:t,y:n,w:o-t,h:r-n}}([M(i,r),M(a,r),M(s,r),M(d,r)].map((e=>({x:e.x+o.x+n.x,y:e.y+o.y+n.y}))))}return{x:o.x,y:o.y,w:t.width,h:t.height}}function P(e,t){return{x:e.x-t.x,y:e.y-t.y}}function M(e,t){return{x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}}function N(e,t,n){const o=t.position,r=t.hAlign?t.hAlign:n?"right":"left",i=t.vAlign;let s,a;return s="center"===r?o.x-e.width/2:"right"===r?o.x-e.width:o.x,a="middle"===i?o.y-e.height/2:"bottom"===i?o.y-e.height:"baseline"===i?o.y+e.y:o.y,{x:s,y:a}}function S(e,t,n,o,r){return{panX:o/2-e*n,panY:r/2-t*n}}function D(e,t){return e?.id===t?.id&&e?.isNode===t?.isNode}function R(e,t){let n,o=!1,r=e;for(;!n;)if(n=r.dataset.node,n?o=!0:n=r.dataset.link,!n){if(!r.parentElement||r.parentElement===t?.current)break;r=r.parentElement}return{id:n,isNode:o}}function k(e,t,n,o){return s.generateAriaLabel(e,o||"",{isSelected:t?n:void 0})}function z(e,t,n){const o=(e-2*b)/n.w,r=(t-2*b)/n.h;return Math.min(o,r)}function X(e,t,n){let o=Math.max(t,e);return o=Math.min(n,o),o}function Y(e){const t={};return e?(e.fontFamily&&(t.fontFamily=e.fontFamily),e.fontSize&&(t.fontSize=e.fontSize),e.fontStyle&&(t.fontStyle=e.fontStyle),e.fontWeight&&(t.fontWeight=e.fontWeight),t):t}function T(e,t,n,o,r,i,s){let a;if(e.isNode){a=n[o.get(e.id)]}else{const r=t.get(e.id),i=n[o.get(r.startNode)],s=n[o.get(r.endNode)],d=Math.min(i.x,s.x),c=Math.min(i.y,s.y);a={x:d,y:c,w:Math.max(i.x+i.w,s.x+i.w)-d,h:Math.max(i.y+i.h,s.y+s.h)-c}}return function(e,t,n,o){const r=(n-2*b)/e.w,i=(o-2*b)/e.h,s=Math.min(r,i,t),a=e.w/2+e.x,d=e.h/2+e.y;return{centerX:a,centerY:d,zoom:s}}(a,s,r,i)}const C=({id:e,state:n,previousState:s,position:c,activeId:u,nodeRenderer:l,onNodeSizeChanged:f,nodeIndex:h,data:p,accessibleLabel:g,isDimmed:m,supportsSelection:y})=>{const{nodeStyles:x,dimmedItemStyle:b}=o.itemStyles,w={state:n,previousState:s,data:p},I=d.useTranslationBundle("@oracle/oraclejet-preact"),v=i.useRef(null),P=i.useRef({box:"border-box"});return r.useResizeObserver(v,i.useCallback((e=>{const t=e.borderBoxSize,n=t[0].inlineSize,o=t[0].blockSize;f(n,o,h)}),[h,f]),P.current),t.jsx("div",{ref:v,class:a.classNames([x,m?b:void 0]),"data-node":e,role:"img","aria-label":k(I,y,n.selected,g),style:{top:c.y,left:c.x},id:n.focused||n.hovered?u:void 0,children:l(w)},e)};function L({nodes:e,states:n,previousStates:r,nodeRenderer:i,nodeBounds:s,onNodeSizeChanged:a,supportsSelection:d}){return t.jsx("div",{class:o.layerStyles,children:e.map(((e,o)=>{const c=s&&s[o]?{x:s[o].x,y:s[o].y}:{x:0,y:0},u={selected:n.selectedNodeIds.includes(e.id),focused:n.focusedId===e.id,hovered:n.hoveredId===e.id,zoom:n.zoom},l={selected:r.selectedNodeIds.includes(e.id),focused:r.focusedId===e.id,hovered:r.hoveredId===e.id,zoom:r.zoom};return t.jsx(C,{id:e.id,position:c,state:u,previousState:l,isDimmed:0!==n.highlightedIds.length&&!n.highlightedIds.includes(e.id),activeId:n.activeId,nodeRenderer:i,onNodeSizeChanged:a,nodeIndex:o,accessibleLabel:e.accessibleLabel,data:e,supportsSelection:d})}))})}const Z=({id:e,state:n,previousState:r,activeId:i,data:s,linkRenderer:c,accessibleLabel:u,isDimmed:l,supportsSelection:f,layoutOutput:h})=>{const p=d.useTranslationBundle("@oracle/oraclejet-preact"),{dimmedItemStyle:g,linkStyles:m}=o.itemStyles,y={state:n,previousState:r,data:s,layoutOutput:h};return t.jsx("g",{id:n.focused?i:void 0,"aria-label":k(p,f,n.selected,u),"data-link":e,role:"img",class:a.classNames([m,l&&g]),children:c(y)},e)};function O({links:e,states:n,previousStates:r,linkRenderer:i,width:s,height:a,supportsSelection:d,layoutOutput:c}){return t.jsx("svg",{class:o.layerStyles,width:s,height:a,children:e.map((e=>{const o={selected:n.selectedLinkIds.includes(e.id),focused:n.focusedId===e.id,hovered:n.hoveredId===e.id,zoom:n.zoom},s={selected:r.selectedLinkIds.includes(e.id),focused:r.focusedId===e.id,hovered:r.hoveredId===e.id,zoom:r.zoom};return t.jsx(Z,{id:e.id,label:e.label,state:o,previousState:s,isDimmed:0!==n.highlightedIds.length&&!n.highlightedIds.includes(e.id),activeId:n.activeId,accessibleLabel:e.accessibleLabel,data:e,linkRenderer:i,supportsSelection:d,layoutOutput:c})}))})}const A=({text:e,position:n,styles:r,dimensions:i,isRTL:s})=>{const{labelStyle:d,labelBorderStyle:c}=o.labelStyles,u=N(i,n,s),l=function(e){const t=e.rotationAngle,n=e.rotationPoint,o={};t&&(o.transform=`rotate(${t}deg)`);n&&(o["transform-origin"]=`${n.x}px ${n.y}px`);return o}(n);return t.jsx("div",{class:a.classNames([d,r&&r.borderColor&&c]),style:{top:u.y,left:u.x,...r,...l},children:e})};function V({labelPosition:e,itemProps:n,labelDimensions:r}){const{direction:i}=c.useUser();return t.jsx("div",{class:o.layerStyles,children:n.map(((n,o)=>{if(n.label&&e[o])return t.jsx(A,{styles:n.labelStyle,text:n.label,position:e[o],dimensions:r.get(n.id),isRTL:"rtl"===i})}))})}function E({nodes:e,links:n,nodeRenderer:o,linkRenderer:r,states:i,previousStates:s,nodeBounds:a,onNodeSizeChanged:d,width:c,height:u,nodeLabelPositions:l,linkLabelPositions:f,labelDimensions:h,supportsSelection:p,layoutOutput:g}){return t.jsxs(t.Fragment,{children:[n.length>0&&g&&r&&c!==1/0&&t.jsx(O,{links:n,states:i,previousStates:s,linkRenderer:r,width:c,height:u,supportsSelection:p,layoutOutput:g}),t.jsx(L,{nodes:e,nodeBounds:a,states:i,previousStates:s,nodeRenderer:o,onNodeSizeChanged:d,supportsSelection:p}),h?t.jsxs("div",{children:[l?t.jsx(V,{labelPosition:l,itemProps:e,labelDimensions:h}):void 0,n&&f?t.jsx(V,{labelPosition:f,itemProps:n,labelDimensions:h}):void 0]}):void 0]})}function j({centerX:e,centerY:n,children:r,zoom:i,width:s,height:a}){const d=S(e,n,i,s,a);return t.jsx("div",{class:o.panZoomStyles,style:{translate:`${d.panX}px ${d.panY}px`,transform:`scale(${i})`},children:r})}function B(e,t){let n;for(let o=0;o<t.length;o++)if(n=t[o],e.id===n.id)return n}function F(e,t){const n=[];return t.forEach((t=>{const o=t.startNode,r=t.endNode;o!=e&&r!=e||n.push(t)})),n}function U(e,t,n,o){let r,i=n[0],s=n[0];for(let e=0;e<n.length;e++)r=n[e],r.id===t.startNode?i=r:r.id===t.endNode&&(s=r);const a=e.id==i.id?s:i,d=_(e,o),c=_(a,o);let u=Math.atan2(c.y-d.y,c.x-d.x);return u=u<0?u+2*Math.PI:u,u}function K(e,t,n){let o,r=t[0],i=t[0];for(let n=0;n<t.length;n++)o=t[n],o.id===e.startNode?r=o:o.id===e.endNode&&(i=o);const s=_(r,n),a=_(i,n);return Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))}function G(e,t){return t.endNode===e.id?1:0}function _(e,t){const n=t.get(e.id);return{x:n.x+n.w/2,y:n.y+n.h/2}}function $(e,t,n){const o=15/180*Math.PI,r=40/180*Math.PI,i=e.x+e.w/2,s=e.y+e.h/2,a=t.x+t.w/2,d=t.y+t.h/2,c=Math.abs(i-a),u=Math.abs(s-d),l=Math.atan2(u,c);let f=Math.sqrt(c*c+u*u);return(l>o&&("right"==n||"left"==n)||l<Math.PI/2-o&&("up"==n||"down"==n))&&(l>r&&("right"==n||"left"==n)||l<Math.PI/2-r&&("up"==n||"down"==n)?f*=6:f*=2),f}function W(e,t,n,o){if(o){const o=e.x+.5*e.w,r=t.x+.5*t.w,i=e.y+.5*e.h,s=t.y+.5*t.h;switch(n){case"up":return i<s;case"down":return e.y>s;case"right":return o>r;case"left":return o<r}return!0}switch(n){case"up":return e.y<t.y||Q(e.y,t.y);case"down":return e.y>t.y||Q(e.y,t.y);case"right":return e.x>t.x||Q(e.x,t.x);case"left":return e.x<t.x||Q(e.x,t.x)}return!0}function q(e,t,n){switch(n){case"up":return H(e,t)&&(t.y<=e.y+e.h||Q(t.y,e.y+e.h));case"down":return H(e,t)&&(e.y<=t.y+t.h||Q(e.y,t.y+t.h));case"right":return J(e,t)&&(e.x<=t.x+t.w||Q(e.x,t.x+t.w));case"left":return J(e,t)&&(t.x<=e.x+e.w||Q(t.x,e.x+e.w))}return!1}function H(e,t){return e.x>=t.x&&e.x<=t.x+t.w||t.x>=e.x&&t.x<=e.x+e.w}function J(e,t){return e.y>=t.y&&e.y<=t.y+t.h||t.y>=e.y&&t.y<=e.y+e.h}function Q(e,t){return Math.abs(e-t)<=1e-7}function ee(e,t){let n=Math.abs(e-t)<=1e-7;return n||(n=Math.abs(2*Math.PI+Math.min(e,t)-Math.max(e,t))<=1e-7),n}function te(e,t,n,o){const r=i.useRef(),s=function(e,t){const n=new Map;for(let o=0;o<e.length;o++)n.set(e[o].id,t[o]);return n}(e,n);return{isNode:n=>{let o,r;for(let i=0;i<e.length;i++){if(o=e[i],r=t[i],n.id===o.id)return!0;if(n.id===r.id)return!0}return!1},getNextNavigableNode:function(e,t,n,o){if(!o)return n;if(!n)return o[0];const r=s.get(n.id);if(!r)return o[0];let i,a,d,c=n,u=Number.MAX_VALUE,l=!1,f=!1;for(let h=0;h<o.length;h++){if(i=o[h],i===n){f=!0;continue}const p=s.get(i.id);if(!p)continue;const g={x:p.x,y:p.y,w:p.w,h:p.h},m={x:r.x,y:r.y,w:r.w,h:r.h};W(g,m,e,t)&&(a=q(g,m,e),l&&!a||(d=$(g,m,e),(0!=d||f)&&(!l&&a||d<u&&(l&&a||!l))&&(u=d,c=i,l=a)))}return c},getNextNavigableLink:function(e,t,n,o){if(!o)return n;if(!n)return o[0];const i=r.current,a=B({id:i||n.startNode,isNode:!0},t);if(!a)return n;const d=function(e,t,n,o){let r,i,s;const a=[];for(let d=0;d<t.length;d++){const c=t[d];r=U(e,c,n,o),i=K(c,n,o),s=G(e,c),a.push({id:c.id,angle:r,distance:i,direction:s})}return a}(a,o=F(a.id,o),t,s);d.sort(((e,t)=>{const{angle:n,distance:o,direction:r}=e,{angle:i,distance:s,direction:a}=t;let d=-1;return!ee(n,i)&&n>i?d=1:ee(n,i)&&(o>s||s==o&&r>a?d=1:s==o&&r==a&&(d=0)),d}));const c="down"==e;let u=0;for(let e=0;e<d.length;e++){if(d[e].id===n.id){u=c?e==d.length-1?0:e+1:0==e?d.length-1:e-1;break}}return d[u]},navigateFromNodeToLink:function(e,t,n){if(!n)return;const o=F(n.id,e);if(o.length<1)return;let i=o[0];const a=s.get(n.id);let d,c,u,l;const f=a.x+a.w/2;r.current=n.id;for(let e=0;e<o.length;e++)if(d=o[e],c=d.startNode===n.id?d.endNode:d.startNode,u=s.get(c),l=u.x+u.w/2,t.altKey&&"Comma"===t.code&&l<=f||t.altKey&&"Period"===t.code&&l>=f){i=d;break}return{id:i.id,isNode:!1}},navigateFromLinkToNode:function(e,t){const n=t.key,r=o.get(e),i=s.get(r.startNode),a=s.get(r.endNode);if(!i||!a)return;const d=i.x+i.w/2,c=a.x+a.w/2;return{id:c>d&&"ArrowRight"===n||c<d&&"ArrowLeft"===n?r.endNode:r.startNode,isNode:!0}}}}const ne=15,oe=.15;function re(e,t,n,o,r,s,a,d,c,h,p,g,m,y,x){const{getNextNavigableNode:b,getNextNavigableLink:w,navigateFromNodeToLink:I,navigateFromLinkToNode:v}=te(n,o,r,s),[P,M]=i.useState({id:t.id,isNode:!0}),[N,S]=i.useState(),k=i.useRef(),z=l.useVisHover((e=>{const t=R(e.target);t&&!D(t,N)&&(S({...t,isCurrent:!0}),k.current=u.getRandomId(),M({...P,isCurrent:!1}),t.isNode?g?.({id:t.id,type:"node",data:a.get(t.id)}):g?.({id:t.id,type:"link",data:s.get(t.id)}))}),void 0,(()=>{S(void 0),k.current=void 0,g?.({id:void 0,data:void 0})}),e);function X(e){e.isNode?m?.({id:e.id,type:"node",data:a.get(e.id)}):m?.({id:e.id,type:"link",data:s.get(e.id)}),k.current=u.getRandomId(),M(e)}function Y(e){e&&(D(e,P)||(e.isCurrent=!0,e.isFocusVisible=!0,N&&S({...N,isCurrent:!1}),X(e)))}return{focusedItemInfo:P,hoveredItemInfo:N,activeId:k.current,eventsProps:f.mergeProps(z,{onKeyUp:e=>{if("Tab"===e.code)X({...P,isCurrent:!0,isFocusVisible:!0})},onKeyDown:e=>{const t=e.key;let i=!1;if("TAB"!==t){if(function(e){const t=e.code;if(P.isNode&&e.altKey&&("Period"===t||"Comma"===t))return!0;if(!P.isNode&&("ArrowLeft"===t||"ArrowRight"===t))return!0;return!1}(e)){Y(P.isNode?I(o,e,B(P,n)):v(P.id,e)),i=!0}else if(function(e){switch(e){case"ArrowDown":case"ArrowUp":case"ArrowRight":case"ArrowLeft":return!0}return!1}(t)){const e=function(e){let t="down";switch(e){case"ArrowDown":t="down";break;case"ArrowUp":t="up";break;case"ArrowRight":t="right";break;case"ArrowLeft":t="left"}if(P.isNode){const e=b(t,!0,B(P,n),n);return e?{id:e.id,isNode:!0}:P}{const e=function(e,t){let n;for(let o=0;o<t.length;o++)if(n=t[o],e.id===n.id)return n}(P,o),r=w(t,n,e,o);return r?{id:r.id}:{id:P.id}}}(t);Y(e),i=!0}else switch(t){case"PageUp":y&&y({dPan:{dx:e.shiftKey?-ne:0,dy:e.shiftKey?0:-ne}}),i=!0;break;case"PageDown":y&&y({dPan:{dx:e.shiftKey?ne:0,dy:e.shiftKey?0:ne}}),i=!0,i=!0;break;case"+":case"=":x&&x({dZoom:oe}),i=!0;break;case"-":case"_":x&&x({dZoom:-oe}),i=!0;break;case"0":if(e.ctrlKey&&e.altKey){const{centerX:e,centerY:t,zoom:n}=T(P,s,r,d,c,h,p);x&&x({nZoom:n}),y&&y({nPan:{cx:e,cy:t}})}else x&&x({}),y&&y({center:!0});i=!0}i&&(e=>{e.preventDefault(),e.stopPropagation()})(e)}},onBlur:()=>{(null!=N||P.isCurrent)&&m?.({id:void 0,data:void 0});const e={...P,isCurrent:!1,isFocusVisible:!1};M(e)},onPointerUp:e=>{const t=R(e.target);null!=t.id&&(M(t),k.current=u.getRandomId())}})}}const ie=({touchResponse:e,datatip:t,focusedItemBoundsRef:n,focusedItemInfo:o,panState:r,zoom:i,width:s,nodesMap:a,linksMap:d,hoveredItem:u})=>{const{direction:l}=c.useUser(),f="rtl"===l,g=function(e,t,n,o,r){let i;const s=o?.isCurrent;if(s&&null!=o.id&&(i=o),n&&n.isCurrent&&(i=n),i&&r)return r(i.isNode?{data:e.get(i.id),type:"node"}:{data:t.get(i.id),type:"link"});if(i){const n=(i.isNode?e.get(i.id):t.get(i.id))?.accessibleLabel;return{content:n}}}(a,d,o,u,t),m=o?.isCurrent?{x:n.current.x*i+r.panX,y:n.current.y*i+r.panY,width:n.current.w*i,height:n.current.h*i}:void 0,{datatipContent:y,datatipProps:x}=h.useDatatip({content:g?.content,borderColor:g?.borderColor,placement:"top-start",offset:p.calculateOffset(f,s,m),anchor:o?.isCurrent?"element":"pointer",touchResponse:e});return{datatipContent:y,datatipProps:x}},se=({captureTargetRef:e,numPointers:t=1,onPointerGestureDown:n,onPointerGestureMove:o,onPointerGestureEnd:r,onExtraneousPointerDown:s,isDisabled:a=!1})=>{const d=i.useRef([]);a&&(d.current=[]);const c=e=>{const n=d.current.findIndex((t=>t.pointerId===e.pointerId));-1!==n&&(d.current[n]=e,d.current.length===t&&r&&r({pointers:d.current}),d.current.splice(n,1))};return a?{}:{onPointerDown:e=>{d.current.push(e),d.current.length===t?n&&n({pointers:d.current}):d.current.length>t&&s&&s({pointers:d.current})},onPointerMove:n=>{if(0===d.current.length)return;const r=d.current.findIndex((e=>e.pointerId===n.pointerId));-1!==r&&(d.current[r]=n,d.current.length===t&&(d.current.forEach((t=>e.current.setPointerCapture(t.pointerId))),o&&o({pointers:d.current})))},onPointerUp:c,onPointerCancel:c,onPointerLeave:c}},ae=(e,t,n,o,r,i,s,a)=>{if(!s)return{newPan:{panX:0,panY:0}};const d=((e,t,n,o)=>{const r="y"!==o?t.panX:e.panX,i="x"!==o?t.panY:e.panY;return{panX:r>n.maxX||r<n.minX?e.panX:r,panY:i>n.maxY||i<n.minY?e.panY:i}})(e,t,s,n),c=d.panX!==e.panX||d.panY!==e.panY,u=function(e,t,n,o,r){return{centerX:(o/2-e)/n,centerY:(r/2-t)/n}}(d.panX,d.panY,o,r,i);return c&&a&&a({centerX:u.centerX,centerY:u.centerY}),{newPan:d}},de=({panProps:e,captureTargetRef:t,panBounds:n,width:o,height:r,zoom:s,onDragPanStart:a,onDragPanEnd:d})=>{const c=i.useRef({panX:0,panY:0}),u=i.useRef({panX:0,panY:0}),l=(({captureTargetRef:e,draggableRegion:t,onDragStart:n,onDragMove:o,onDragEnd:r,isDisabled:s=!1})=>{const a={isDragging:!1,x0:-1,y0:-1,regionOffsetX:-1,regionOffsetY:-1},d=i.useRef(a),c=(e,t)=>{const{isDragging:n,x0:o,y0:r,regionOffsetX:i,regionOffsetY:s}=d.current;if(!n)return;const a=e.pageX,c=e.pageY;t&&t({x:a,y:c,dx:a-o,dy:c-r,regionOffsetX:i,regionOffsetY:s,originalEvent:e})},u=se({captureTargetRef:e,numPointers:1,onExtraneousPointerDown:()=>{d.current=a},onPointerGestureDown:({pointers:[e]})=>{const o=e.pageX,r=e.pageY;if(0!==e.button||!((e,t,n)=>{if(!n)return!0;const{xMin:o,xMax:r,yMin:i,yMax:s}=n;return e>=o&&e<=r&&t>=i&&t<=s})(o,r,t))return;const{regionOffsetX:i,regionOffsetY:s}=((e,t,n)=>n?{regionOffsetX:e-n.xMin,regionOffsetY:t-n.yMin}:{regionOffsetX:e,regionOffsetY:t})(o,r,t);d.current={isDragging:!0,x0:o,y0:r,regionOffsetX:i,regionOffsetY:s},n&&n({x:o,y:r,regionOffsetX:i,regionOffsetY:s,originalEvent:e})},onPointerGestureMove:({pointers:[e]})=>{c(e,o)},onPointerGestureEnd:({pointers:[e]})=>{c(e,r),d.current=a}});return s?{}:u})({captureTargetRef:t,onDragStart:()=>{const t=S(e.centerX,e.centerY,s,o,r);u.current={panX:t.panX,panY:t.panY},a&&a()},onDragMove:({dx:t,dy:i})=>{const a={panX:u.current.panX+t,panY:u.current.panY+i},{newPan:d}=ae(c.current,a,e.panDirection,s,o,r,n,e.onPan);c.current=d},onDragEnd:({originalEvent:e})=>{u.current.panX===c.current.panX&&u.current.panY===c.current.panY||e.preventDefault(),d&&d()},isDisabled:"off"===e.panning});return l},ce=(e,t,n,o,r)=>{const i=e>o||e<n?t:e;i!==t&&r&&r({zoomValue:i})},ue=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-t.y)**2),le=({captureTargetRef:e,zooming:t,minZoom:n,maxZoom:o,zoomValue:r,onZoom:s})=>{const a=(({captureTargetRef:e,onPinchZoomStart:t,onPinchZoomChange:n,onPinchZoomEnd:o,isDisabled:r=!1})=>{const s=i.useRef({x:-1,y:-1}),a=i.useRef(-1),d=()=>{s.current={x:-1,y:-1},a.current=-1};r&&d();const c=se({captureTargetRef:e,numPointers:2,onPointerGestureDown:({pointers:[e,n]})=>{const o={x:e.offsetX,y:e.offsetY},r={x:n.offsetX,y:n.offsetY};s.current=((e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}))(o,r),a.current=ue(o,r),t&&t({origin:s.current,delta:0})},onPointerGestureMove:({pointers:[e,t]})=>{const o={x:e.offsetX,y:e.offsetY},r={x:t.offsetX,y:t.offsetY},i=ue(o,r),d=i-a.current;a.current=i,n&&n({origin:s.current,delta:d})},onPointerGestureEnd:()=>{d(),o&&o()}});return r?{}:c})({captureTargetRef:e,onPinchZoomChange:({delta:e})=>{ce(r*(1+.05*e),r,n,o,s)},isDisabled:"off"===t});return a},fe=({props:e,captureTargetRef:t,width:n,height:o,contentBounds:r})=>{const[s,a]=i.useState(),d=function(e,t,n,o){const r=e.minZoom?e.minZoom:z(t,n,o),i=void 0!==e.maxZoom?e.maxZoom:1,s=e.zoomValue?e.zoomValue:z(t,n,o);return{zooming:e.zooming?e.zooming:"off",minZoom:r,maxZoom:i,zoomValue:X(s,r,i),onZoom:e.onZoom}}(e,n,o,r),c=function(e,t){return{panning:e.panning?e.panning:"off",panDirection:e.panDirection?e.panDirection:"any",centerX:void 0!==e.centerX?e.centerX:t.w/2+t.x,centerY:void 0!==e.centerY?e.centerY:t.h/2+t.y,onPan:e.onPan}}(e,r),u=i.useRef(),l=i.useRef(),h=i.useRef(),p=i.useRef({zoom:e.zoomValue||0,centerX:e.centerX,centerY:e.centerY});r.w===1/0||d.zoomValue===l.current&&c.panning===h.current||(u.current=((e,t,n,o,r,i,s)=>{const{x:a,y:d,w:c,h:u}=n;let l,f,h,p;if("centerContent"===o)l=e/2-(c+a)*r,h=t/2-(u+d)*r,f=e/2-a*r,p=t/2-d*r;else{const n=r/i,o=(e-c*i)/2-a*i,s=(t-u*i)/2-d*i;l=e-e*n+o*n,h=t-t*n+s*n,f=o*n,p=s*n}const g=s.zoom,m=s.centerX,y=s.centerY;let x,b;if(m){const t=m*g-e/2;-t*g<l?(x=l-t*g,l-=x,f+=x):-t*g>f&&(x=-t*g-f,l-=x,f+=x)}if(y){const e=y*g-t/2;-e*g<h?(b=h-e*g,h-=b,p+=b):-e*g>p&&(b=-e*g-p,h-=b,p+=b)}return{minX:l,maxX:f,minY:h,maxY:p}})(n,o,r,c.panning,d.zoomValue,d.minZoom,p.current),l.current=d.zoomValue,h.current=c.panning);const g=de({panProps:c,captureTargetRef:t,panBounds:u.current,zoom:d.zoomValue,width:n,height:o,onDragPanStart:()=>a("grabbing"),onDragPanEnd:()=>a("auto")}),m=i.useRef({panX:0,panY:0}),y=(({zooming:e,minZoom:t,maxZoom:n,zoomValue:o,onZoom:r})=>(({onWheel:e,preventDefault:t=!0,isDisabled:n=!1})=>n?{}:{onWheel:n=>{const{deltaX:o,deltaY:r}=(e=>{const{deltaX:t,deltaY:n,deltaMode:o}=e;switch(o){case e.DOM_DELTA_PIXEL:return{deltaX:-t,deltaY:-n};case e.DOM_DELTA_LINE:return{deltaX:15*-t,deltaY:15*-n};case e.DOM_DELTA_PAGE:return{deltaX:40*-t,deltaY:40*-n};default:return{deltaX:-t,deltaY:-n}}})(n);t&&n.preventDefault(),e({x:n.offsetX,y:n.offsetY,deltaX:o,deltaY:r,ctrlKey:n.ctrlKey||n.metaKey})}})({onWheel:({deltaY:e})=>{ce(o*(1+.05*e),o,t,n,r)},isDisabled:"off"===e}))(d),x=le({captureTargetRef:t,zooming:d.zooming,minZoom:d.minZoom,maxZoom:d.maxZoom,zoomValue:d.zoomValue,onZoom:d.onZoom});return{panZoomProps:f.mergeProps(g,y,x),cursor:s,centerX:c.centerX,centerY:c.centerY,zoomValue:d.zoomValue,kbPanCallback:"off"!==c.panning?e=>{let t,i;e.center?(t=r.x+r.w/2,i=r.y+r.h/2):e.dPan?(t=c.centerX+e.dPan.dx,i=c.centerY+e.dPan.dy):(t=e.nPan.cx,i=e.nPan.cy);const s=S(t,i,d.zoomValue,n,o),{newPan:a}=ae(m.current,s,c.panDirection,d.zoomValue,n,o,u.current,c.onPan);m.current=a}:void 0,kbZoomCallback:"off"!==d.zooming?e=>{const t=e.dZoom?d.zoomValue+e.dZoom:z(n,o,r);ce(e.nZoom?e.nZoom:t,d.zoomValue,d.minZoom,d.maxZoom,d.onZoom)}:void 0}};function he({nodes:e=[],links:n=[],width:r,height:s,selectedIds:a={},selectionMode:d="none",layout:u,nodeRenderer:l,linkRenderer:h,onSelectionChange:p,onItemHover:b,onItemFocus:P,highlightedIds:M={},datatip:N,...D}){const k=i.useRef(null),z=i.useRef(null),[X,T]=i.useState([]),[C,L]=i.useState(),{direction:Z}=c.useUser(),O=e,A=w(O),V=A.itemIdToDataMap,B=function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=e[o];t.get(r.startNode)&&t.get(r.endNode)&&n.push(r)}return n}(n,V),F=w(B),U=F.itemIdToDataMap,K=i.useRef(!1),G=function(e){const t=[];for(let n=0;n<e.length;n++)t.push({w:e[n].w,h:e[n].h});return t}(X),{textMeasureContent:_,getTextDimensions:$}=g.useTextDimensions(),W=i.useRef(new Map),q=i.useRef([]),H=i.useRef([]),J=i.useRef(),Q=function(e,t){if(0===e.length)return{x:0,w:1/0,y:0,h:1/0};let n,o=1/0,r=1/0,i=-1/0,s=-1/0;for(let t=0;t<e.length;t++)n=e[t],o=n.x<o?n.x:o,r=n.y<r?n.y:r,i=n.x+n.w>i?n.x+n.w:i,s=n.y+n.h>s?n.y+n.h:s;return t&&(o=t.x<o?t.x:o,r=t.y<r?t.y:r,i=t.x+t.w>i?t.x+t.w:i,s=t.y+t.h>s?t.y+t.h:s),{x:o,w:i-o,y:r,h:s-r}}(X,C),{panZoomProps:ee,cursor:te,centerX:ne,centerY:oe,zoomValue:se,kbPanCallback:ae,kbZoomCallback:de}=fe({props:D,captureTargetRef:z,width:r,height:s,contentBounds:Q}),{touchResponse:ce,touchResponseStyle:ue}=y.useVisTouchResponse({type:"auto",supportsTouchDragGestures:"on"===D.zooming||!!D.panning&&"off"!==D.panning,rootRef:z}),{focusedItemInfo:le,hoveredItemInfo:he,activeId:pe,eventsProps:ge}=re(ce,O[0],O,B,X,U,V,A.itemIdToIndexMap,r,s,D.maxZoom||1,b,P,ae,de),{selectionProps:me,selectionContent:ye}=function({selectedIds:e,selectionMode:t,nodeMap:n,linkMap:o,focusedItemInfo:r,onSelectionChange:i,rootRef:s}){const a=n.itemIdToIndexMap,d=n.itemIndexToIdMap,c=o.itemIdToIndexMap,u=o.itemIndexToIdMap,l=e=>`N_${a.get(e)}`,f=e=>d.get(Number(e.slice(2))),h=e=>`L_${c.get(e)}`,p=e=>u.get(Number(e.slice(2))),g=[...e.nodes?e.nodes.map(l):[],...e.links?e.links.map(h):[]],{selectionContent:y,selectionProps:x}=m.useSelection({selection:g,idExtracter:e=>{const t="keyup"===e.type?r:R(e.target,s);return void 0!==t.id?t.isNode?l(t.id):h(t.id):void 0},selectionMode:t,getDataById:e=>{let t;if("N"===e[0]){const o=f(e);t=n.itemIdToDataMap.get(o)}else if("L"===e[0]){const n=p(e);t=o.itemIdToDataMap.get(n)}return t},onChange:e=>{const t=e.ids.filter((e=>"N"===e[0])).map((e=>f(e))),r=e.ids.filter((e=>"L"===e[0])).map((e=>p(e))),s=t.map((e=>n.itemIdToDataMap.get(e))),a=r.map((e=>o.itemIdToDataMap.get(e)));return i&&i({nodes:t,links:r,nodeData:s,linkData:a})}});return{selectionContent:y,selectionProps:x}}({selectedIds:a,selectionMode:d,nodeMap:A,linkMap:F,focusedItemInfo:le,onSelectionChange:p,rootRef:z});le&&X.length>0&&(k.current=function(e,t,n,o,r){if(e.isNode)return t[o.get(e.id)||0];{const i=n[r.get(e.id)||0],s=t[o.get(i.startNode)||0],a=t[o.get(i.endNode)||0],d={x:s.x+s.w/2,y:s.y+s.h/2},c={x:a.x+a.w/2,y:a.y+a.h/2};return{x:Math.min(d.x,c.x),y:Math.min(d.y,c.y),w:Math.abs(d.x-c.x),h:Math.abs(d.y-c.y)}}}(le,X,B,A.itemIdToIndexMap,F.itemIdToIndexMap));const{datatipContent:xe,datatipProps:{"aria-describedby":be,...we}}=ie({touchResponse:ce,datatip:N,focusedItemInfo:le,focusedItemBoundsRef:k,panState:S(ne,oe,se,r,s),zoom:se,width:r,nodesMap:V,linksMap:U,hoveredItem:he}),Ie={width:r,height:s,cursor:te,...ue},ve=i.useRef(),Pe=ve.current?ve.current:{selectedNodeIds:[],selectedLinkIds:[],focusedId:void 0,hoveredId:void 0,activeId:void 0,highlightedIds:[],zoom:0};ve.current={selectedNodeIds:a.nodes??[],selectedLinkIds:a.links??[],focusedId:le.isCurrent&&le.isFocusVisible?le.id:void 0,hoveredId:he?.isCurrent?he.id:void 0,activeId:pe,highlightedIds:I(M.nodes,M.links),zoom:se};const Me=f.mergeProps(ee,ge,me,we);return t.jsxs("div",{ref:z,class:o.outerStyles,...Me,style:Ie,tabIndex:0,role:"application","aria-label":D["aria-label"],"aria-labelledby":D["aria-labelledby"],"aria-describedby":x.merge([D["aria-describedby"],be]),"aria-activedescendant":pe,children:[$?t.jsx(j,{centerX:ne,centerY:oe,zoom:se,width:r,height:s,children:t.jsx(E,{nodes:O,links:B,nodeRenderer:l,linkRenderer:h,width:r,height:s,nodeBounds:X,states:ve.current,previousStates:Pe,onNodeSizeChanged:(e,t,n)=>{G[n]={w:e,h:t},K.current||(K.current=!0,window.requestAnimationFrame((()=>{const{labelDims:e,layoutJSON:t}=function(e,t,n,o,r,i,s){const a=new Map,d=Array.from(t.keys());for(const e of d){const n=t.get(e);if(n&&s&&n.label){const t=n.label,o=Y(n.labelStyle);a.set(e,s(t,o))}}const c=Array.from(n.keys());for(const e of c){const t=n.get(e);if(t&&s&&t.label){const n=t.label,o=Y(t.labelStyle);a.set(e,s(n,o))}}return{layoutJSON:{getNodeDimensions:function(t){for(let n=0;n<e.length;n++)if(t.id===e[n].id)return o[n];return o[0]},getLabelDimensions:function(e){return a.get(e.id)},componentSize:{width:r,height:i}},labelDims:a}}(O,V,U,G,r,s,$);W.current=e;const n=u(t),{nodePoints:o,nodeLabelPos:i,linkLabelPos:a}=function(e,t,n){const o=e.nodes,r=e.links,i=[],s=[],a=[];let d,c,u=!1,l=!1;for(let e=0;e<t.length;e++)d=o[t[e].id],i.push(d.position),d.label&&(u=!0),s.push(d.label);if(r)for(let e=0;e<n.length;e++)c=r[n[e].id],c.label&&(l=!0),a.push(c.label);return{nodePoints:i,nodeLabelPos:u?s:void 0,linkLabelPos:l?a:void 0}}(n,O,B);q.current=i,H.current=a,J.current=n;const d=function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=t[o],i=e[o];n.push({x:r.x,y:r.y,w:i.w,h:i.h})}return n}(G,o);T(d);const c=function(e,t,n,o=[],r=[],i){if(0===o.length&&0===r.length)return;let s,a,d=1/0,c=1/0,u=-1/0,l=-1/0;for(let n=0;n<o.length;n++)a=o[n],a&&(s=v(a,e.get(t[n].id),i),d=s.x<d?s.x:d,c=s.y<c?s.y:c,u=s.x+s.w>u?s.x+s.w:u,l=s.y+s.h>l?s.y+s.h:l);for(let t=0;t<r.length;t++)a=r[t],a&&(s=v(a,e.get(n[t].id),i),d=s.x<d?s.x:d,c=s.y<c?s.y:c,u=s.x+s.w>u?s.x+s.w:u,l=s.y+s.h>l?s.y+s.h:l);return{x:d,w:u-d,y:c,h:l-c}}(e,O,B,i,a,"rtl"===Z);L(c),K.current=!1})))},nodeLabelPositions:q.current,linkLabelPositions:H.current,labelDimensions:W.current,supportsSelection:"none"!==d||!!(a?.nodes&&a.nodes.length>0)||!!(a?.links&&a.links.length>0),layoutOutput:J.current})}):void 0,_,xe,ye]})}e.Diagram=function({width:e,height:r,...i}){return i.nodes&&i.nodes.length>0?t.jsx(n.TrackResizeContainer,{width:e,height:r,class:o.dimensionStyle,children:(e,n)=>t.jsx(he,{width:e,height:n,...i})}):null}}));
//# sourceMappingURL=Diagram-14fd94c3.js.map
