define(['exports', 'preact/jsx-runtime', 'preact/hooks', 'preact/compat', './refUtils-d354a169', './Layer-6f29b67f', './LayerHost-639b3284', './Modal-7bece8d5', './FocusTrap-60520575', './tabbableUtils-85aa6918', './positionUtils-6e4daa31', './clientHints-4f5a07b0', './useOutsideClick-76c1ff6e', './useAnimation-5a74955f', './useUser-3ef25571', './useTestId-b5cd4766', './useSwipe-d22a98f1', './useComponentTheme-5aa41a8f', './colors-5f64f302', './mergeInterpolations-9ede4cf7', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupTheme', './classNames-08d99695', './UNSAFE_Layer/themes/LayerStyles.css', 'css!./LayerStyles.styles.css', './useThemeInterpolations-ab618dee', './useColorScheme-443e7cc7', './useScale-e311d35f', './theme-a8f3d819', './Theme-d945adae', './useDensity-f0f7ae9a', 'preact', './Common/themes/redwood/theme', './Common/themes/themeContract.css', './useModal-536cb7ff', './UNSAFE_Modal/themes/ModalStyles.css', 'css!./ModalStyles.styles.css', './vanilla-extract-recipes-createRuntimeFn.esm-d881c69a', './FocusTracker-2ac5bbfe', './PRIVATE_FocusTracker/themes/FocusTrackerStyles.css', 'css!./FocusTrackerStyles.styles.css', './head-9cb1a3da', './_arity-5a5f5f71', './_curry3-83878f86', './_curry1-df649359', './_curry2-86c52b86', './_isArray-32602db6', './_isString-d0ada3cb', './arrayUtils-6ee96a35', './logger-0f873e29', './mergeDeepWithKey-aaab9019', './_isObject-42bafc94', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupBaseTheme.css', 'module', './UNSAFE_DrawerPopup/themes/DrawerPopupStyles.css', 'css!./DrawerPopupStyles.styles.css', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupVariants.css', 'css!./DrawerPopupVariants.styles.css'], (function(e,t,s,r,a,o,n,i,l,c,u,d,m,p,f,b,h,y,w,g,v,S,E,P,D,k,C,F,T,A,_,O,x,R,U,M,N,I,j,L,H,W,X,Y,z,B,K,V,$,q,G,J,Q,Z,ee,te,se){"use strict";const re="0px",ae=250,oe=r.forwardRef((({children:e,isOpen:r=!1,autoFocusRef:n,placement:S="start",modality:E="modal",onClose:P,onTransitionEnd:D,"aria-label":k,"aria-labelledby":C,"aria-describedby":F,testId:T,...A},_)=>{const[O,x]=s.useState(r?"initial":"unmounted"),[R,U]=s.useState("hidden"),[M,N]=s.useState(!r),[I,j]=s.useState("overlay"),L=s.useRef(null),H=s.useRef(null),W=s.useRef(null),X=s.useMemo((()=>a.mergeRefs(L,_)),[L,_]),Y="bottom"===S,z={opening:()=>Y?{from:{translateY:$()},to:{translateY:re},options:{duration:ae}}:{from:{translateX:V()},to:{translateX:re},options:{duration:ae}},closing:()=>Y?{from:{translateY:re},to:{translateY:$()},options:{duration:ae}}:{from:{translateX:re},to:{translateX:V()},options:{duration:ae}}},B=b.useTestId(T),{direction:K}=f.useUser(),V=()=>{return`${"right"===u.normalizePosition(S,K)?"":"-"}${e=L.current,Math.round(e.getBoundingClientRect().width)}px`;var e},$=()=>{return`${e=L.current,Math.round(e.offsetHeight)}px`;var e},q=s.useCallback((()=>{L.current?.style?.removeProperty("transform")}),[]),{nodeRef:G}=p.useAnimation(O,{animationStates:z,isAnimatedOnMount:!0,onAnimationEnd:()=>{"opening"===O?(q(),(()=>{const e=c.getAutofocusFocusables(L.current);e.length>0?c.focusOn(e[0]):c.focusWithin(L.current)})(),D?.(!0)):r||(L.current?.contains(W.current)&&c.focusOnElementOrNearestAncestor(H.current),G(null),U("hidden"),x("unmounted"),D?.(!1))}});s.useEffect((()=>{if("unmounted"!==O||r){if("unmounted"!==O||!r)return"initial"===O&&r?(G(L.current),N(!1),void x("opening")):void("opening"===O&&r?U("visible"):r||(W.current=c.getActiveElement(),N(!0),x("closing")));x("initial")}}),[r,O,G]),s.useEffect((()=>{if("opening"===O&&(H.current=c.getActiveElement(),"modeless"===E&&H.current?.addEventListener("keydown",J)),"closing"===O&&"modeless"===E)return()=>{H.current?.removeEventListener("keydown",J)}}),[E,O]);const J=e=>{H.current===c.getActiveElement()&&"F6"===e.code&&(e.preventDefault(),e.stopPropagation(),c.focusWithin(L.current))},Q=s.useCallback((e=>{const t=H.current;switch(e.code){case"Escape":P?.({reason:"escapeKey"});break;case"F6":if("modeless"===E){e.preventDefault(),e.stopPropagation(),t&&c.focusOn(t);break}}}),[P,E]),Z=s.useCallback((()=>{P?.({reason:"outsideClick"})}),[P]);m.useOutsideClick({isDisabled:M,ref:L,handler:Z});const ee=d.getClientHints(),te=s.useCallback((()=>"ios"===ee.platform?document.documentElement.clientWidth:window.innerWidth),[ee.platform]),se=s.useCallback((()=>{const e=te();"overlay"===I&&e<600&&j("fullOverlay"),"fullOverlay"===I&&e>600&&j("overlay")}),[te,I]);s.useEffect((()=>{if(L.current&&"opening"===O){const e=new ResizeObserver((()=>{se()}));return e.observe(document.body),()=>{e.unobserve(document.body)}}}),[O,se]);const oe=s.useCallback((()=>{P?.({reason:"swipe"})}),[P]),ne=s.useCallback((e=>{const t=e.direction;"ltr"===K&&("start"===S&&"left"===t||"end"===S&&"right"===t)&&oe(),"rtl"===K&&("start"===S&&"right"===t||"end"===S&&"left"===t)&&oe(),"bottom"===S&&"down"===t&&oe()}),[K,S,oe]),{swipeProps:ie}=h.useSwipe(ne,{threshold:50,maximumTime:750,tolerance:40}),{classes:le}=y.useComponentTheme(v.DrawerPopupRedwoodTheme,{placement:Y?S:"rtl"===K?"start"===S?"right":"left":"start"===S?"left":"right",visibility:R,displayModeHorizontal:["start","end"].indexOf(S)>-1?I:void 0}),ce=[...Object.values(w.colorInterpolations)],ue=g.mergeInterpolations(ce),{...de}=ue(A),me=()=>t.jsx("div",{ref:X,className:le,style:de,tabIndex:-1,role:"dialog",onKeyDown:Q,"aria-label":k,"aria-labelledby":C,"aria-describedby":F,...ie,...B,children:t.jsx(l.FocusTrap,{autoFocusRef:n,children:e})}),pe="unmounted"!==O;return pe?"modal"===E?t.jsx(i.Modal,{isOpen:pe,children:me()}):t.jsx(o.Layer,{children:me()}):null}));e.DrawerPopup=oe,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=UNSAFE_DrawerPopup.js.map
