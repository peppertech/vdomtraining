define(['exports', 'preact/jsx-runtime', 'preact/compat', 'preact/hooks', './Calendar-8e1177b8', './InputDateMask-6d54c3e6', './HiddenAccessible-037ef42d', './IconButton-ae9a01ce', './clientHints-4f5a07b0', './FormFieldContext-3c44aaaa', './logger-0f873e29', './TabbableModeContext-a9c97640', './useTranslationBundle-d07d4b20', 'css!./UserAssistanceStyles.styles.css', 'module', './UNSAFE_UserAssistance/themes/redwood/UserAssistanceVariants.css', './InlineUserAssistance-4656c2a6', './Flex-3421f0df', 'css!./MessageBannerStyles.styles.css', 'module', './UNSAFE_MessageBanner/themes/redwood/MessageBannerVariants.css', 'preact', './LayerHost-639b3284', 'css!./TooltipContentStyles.styles.css', 'module', './hooks/UNSAFE_useTooltip/themes/redwood/TooltipContentVariants.css', './tooltipUtils-e5bdb734', 'css!./IconStyle.styles.css', 'css!./MessageStyles.styles.css', './MessageFormattingUtils-2e19d8de', './TransitionGroup-3b9d81b6', './MessagesContext-602a69a2', 'css!./HiddenAccessibleStyles.styles.css', 'css!./ComponentMessageStyles.styles.css', 'module', './UNSAFE_ComponentMessage/themes/redwood/ComponentMessageVariants.css', './Popup-66e79afa', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./LabelStyles.styles.css', 'module', './UNSAFE_Label/themes/redwood/LabelVariants.css', './InputGroupContext-372087af', 'module', './UNSAFE_Popup/themes/redwood/PopupVariants.css', './UNSAFE_InputDatePicker/themes/InputDatePickerDropdownStyles.css', './Sheet-0b58b0a5', './DatePicker-bf0e0c69', './SectionedContent-19bef3cc', './stringUtils-0ae982c2', './FormContext-5130e198', './useFormContext-30acdd33', './useId-c9578d26', './getFormatParse-c1655d39', './maskUtils-33317129', './calendarDateUtils-1783eb17'], (function(e,s,t,a,n,o,r,i,l,d,c,u,m,p,h,y,f,b,C,D,S,k,x,A,v,g,F,T,V,I,w,P,U,M,R,j,_,B,H,E,N,L,O,Y,Z,W,z,G,q,J,K,Q,X,$,ee){"use strict";const se=({anchorRef:e,assistiveText:t,dayFormatter:n,daysOutsideMonth:o,helpSourceLink:r,helpSourceText:i,isDisabled:l,isOpen:c,isReadonly:u,label:p,onClose:h,onCommit:y,max:b,messages:C,min:D,monthAndYearPicker:S,testId:k,todayButton:x,todayTimeZone:A,userAssistanceDensity:v,value:g,weekDisplay:F})=>{const[T,V]=a.useState(!1),[I,w]=a.useState(c),P=a.useCallback((e=>{V(e.placement.startsWith("top"))}),[]);I!==c&&(w(c),c||V(!1));const U=te(),{datePicker_label:M}=m.useTranslationBundle("@oracle/oraclejet-preact"),R=M(),j=s.jsx(z.DatePicker,{dayFormatter:n,daysOutsideMonth:o,height:U?void 0:"auto",onCommit:y,max:b,min:D,maxWidth:U?"100%":void 0,width:"100%",monthAndYearPicker:S,testId:k,todayTimeZone:A,todayButton:x,value:g,weekDisplay:F}),_=!c||T&&!U||l||u||!(t||r||C&&C.length>0)||"efficient"!==v&&"reflow"!==v?void 0:s.jsx(d.FormFieldContext.Provider,{value:{isFocused:!0},children:s.jsx("div",{class:Z.userAssistanceStyles,children:s.jsx(f.InlineUserAssistance,{assistiveText:t,fieldLabel:p,helpSourceLink:r,helpSourceText:i,messages:C,userAssistanceDensity:v})})}),B=k?k+(U?"_sheet":"_dropdown"):void 0,H=s.jsx("div",{class:Z.dropdownStyles,children:s.jsx(G.SectionedContent,{"aria-label":R,footer:_,hasFocusTrap:!0,main:j,role:"dialog",testId:B})});return U?s.jsx(W.Sheet,{initialFocus:"firstFocusable",isOpen:c,onClose:h,children:s.jsx(G.SectionedContent,{"aria-label":R,footer:_,hasFocusTrap:!0,main:j,role:"dialog",testId:B})}):s.jsx(G.StickyPositioningDropdown,{anchorRef:e,initialFocus:"firstFocusable",isOpen:c,onClose:h,onPosition:P,sizeOptions:{isMaxWidthAdjusted:!1,isMaxHeightAdjusted:!0},children:H})},te=()=>"phone"===l.getClientHints().deviceType,ae=e=>e&&ee.isCompleteCalendarDate(e)?e:void 0,ne=(e,s)=>{switch(s.type){case"dateChanged":return{...e,dateValue:s.data,completeDateValue:ae(s.data)};case"dateSelected":return{...e,dateValue:s.data,completeDateValue:s.data};case"reset":return{completeDateValue:ae(s.data),dateValue:s.data};default:return e}},oe=({onCommit:e,onInput:s,value:t})=>{const[n,o]=a.useState(!1),r=a.useRef(null),i=a.useRef(null),l=a.useRef(!1),d=a.useRef(),c=a.useRef(t),u=a.useRef(t),m=a.useRef(t),p=a.useRef(!1),{state:h,dispatch:y}=(({value:e})=>{const[s,t]=a.useReducer(ne,{completeDateValue:ae(e),dateValue:e});return{state:s,dispatch:t}})({value:t});$.calendarDatesAreDifferent(m.current,t)&&(m.current=t,$.calendarDatesAreDifferent(t,h.dateValue)&&(y({type:"reset",data:t}),u.current=t,c.current=t)),a.useEffect((()=>{$.calendarDatesAreDifferent(h.dateValue,u.current)&&(s({previousValue:u.current,value:h.dateValue}),u.current=h.dateValue),p.current&&$.calendarDatesAreDifferent(h.dateValue,c.current)&&(e?.({previousValue:c.current,value:h.dateValue}),c.current=h.dateValue,p.current=!1)}),[e,s,h.dateValue]);const f=a.useCallback((e=>{y({type:"dateChanged",data:e.value})}),[y]),b=a.useCallback((()=>{$.calendarDatesAreDifferent(c.current,h.dateValue)&&(e?.({value:h.dateValue,previousValue:c.current}),c.current=h.dateValue)}),[e,h.dateValue]),C=a.useCallback((()=>{l.current||o((e=>!e)),l.current=!1}),[]),D=a.useCallback((e=>{"outsideMousedown"===e.reason?(l.current=!0,clearTimeout(d.current),d.current=setTimeout((()=>{l.current=!1}),200)):"dismissed"!==e.reason&&"keyboardDismissed"!==e.reason||r.current?.focus(),o(!1)}),[]);return{calendarIconActionHandler:C,datePickerCommitHandler:a.useCallback((e=>{r.current?.focus(),p.current=!0,y({type:"dateSelected",data:e.value}),o(!1)}),[y]),dropdownCloseHandler:D,completeDateValue:h.completeDateValue,dateValue:h.dateValue,iconRef:r,isOpen:n,maskCommitHandler:b,maskInputHandler:f,maskRef:i}},re=t.forwardRef((({"aria-describedby":e,assistiveText:t,dayFormatter:l,daysOutsideMonth:d,helpSourceLink:c,helpSourceText:u,isDisabled:p,isReadonly:h,label:y,max:f,messages:b,min:C,monthAndYearPicker:D,todayTimeZone:S,todayButton:k,value:x,onCommit:A,onInput:v,testId:g,userAssistanceDensity:F,weekDisplay:T,...V},I)=>{const{calendarIconActionHandler:w,datePickerCommitHandler:P,completeDateValue:U,dateValue:M,dropdownCloseHandler:R,iconRef:j,isOpen:_,maskCommitHandler:B,maskInputHandler:H,maskRef:E}=oe({onCommit:A,onInput:v,value:x}),N=a.useRef(null),{inputDatePicker_selectDate:L,inputDatePicker_instruction:O}=m.useTranslationBundle("@oracle/oraclejet-preact"),Y=L(),{userAssistanceDensity:Z}=K.useFormContext(),W=F??Z;a.useImperativeHandle(I,(()=>({focus:()=>{E.current?.focus()},blur:()=>{E.current?.blur()}})));const z=Q.useId(),G=O(),J=p||h?void 0:s.jsx(r.HiddenAccessible,{id:z,isHidden:!0,children:G}),X=p||h?e:q.merge([e,z]),$=s.jsx(i.IconButton,{"aria-haspopup":"dialog","aria-label":Y,isDisabled:p,ref:j,size:"sm",testId:g?g+"_calendarIcon":void 0,variant:"ghost",onAction:w,children:s.jsx(n.SvgCalendar,{})}),ee=_;return s.jsxs(s.Fragment,{children:[s.jsx(o.InputDateMaskContext.Provider,{value:{isDropdownOpen:_,isInputDatePickerParent:!0},children:s.jsx(o.InputDateMask,{"aria-describedby":X,assistiveText:t,endContent:$,helpSourceLink:c,helpSourceText:u,isDisabled:p,isReadonly:h,label:y,onCommit:B,onInput:H,mainFieldRef:N,messages:b,testId:g,ref:E,userAssistanceDensity:F,value:M,...V})}),J,ee&&s.jsx(se,{anchorRef:N,assistiveText:t,dayFormatter:l,daysOutsideMonth:d,helpSourceLink:c,helpSourceText:u,isDisabled:p,isReadonly:h,isOpen:_,label:y,onClose:R,onCommit:P,max:f,messages:b,min:C,monthAndYearPicker:D,testId:g?g+"_datePicker":void 0,todayTimeZone:S,todayButton:k,userAssistanceDensity:W,value:U,weekDisplay:T})]})}));e.InputDatePicker=re}));
//# sourceMappingURL=InputDatePicker-18e2546b.js.map
