define(['exports', 'preact/jsx-runtime', './TrackResizeContainer-2b033ae7', './UNSAFE_Diagram/themes/DiagramStyles.css', './useResizeObserver-275c3e83', 'preact/hooks', './accUtils-530bdb90', './classNames-08d99695', './useTranslationBundle-d07d4b20', './useUser-3ef25571', './layoutUtils-8805fc5b', './useVisHover-28319fef', './mergeProps-bcfa6a92', './useDatatip-9942601b', './useTextDimensions-83dd9415', './clientUtils-009e930e', './useVisDragModeControls-a5685835', './useSelection-01203394', './useVisTouchResponse-88a7bb09', './stringUtils-0ae982c2'], (function(e,t,n,o,r,i,s,a,d,c,u,l,f,h,g,p,m,y,x,b){"use strict";const w=20;function I(e){const t=new Map,n=new Map,o=new Map;for(let r=0;r<e.length;r++)t.set(e[r].id,e[r]),n.set(e[r].id,r),o.set(r,e[r].id);return{itemIdToDataMap:t,itemIdToIndexMap:n,itemIndexToIdMap:o}}function v(e,t){const n=[];if(e)for(let t=0;t<e.length;t++)n.push(e[t]);if(t)for(let e=0;e<t.length;e++)n.push(t[e]);return n}function P(e,t,n){const o=D(t,e,n);if(e.rotationAngle){const n=e.rotationPoint?e.rotationPoint:{x:t.width/2,y:t.height/2},r=e.rotationAngle,i=M({x:0,y:0},n),s=M({x:t.width,y:0},n),a=M({x:0,y:t.height},n),d=M({x:t.width,y:t.height},n);return function(e){let t=e[0].x,n=e[0].y,o=e[0].x,r=e[0].y;for(let i=1;i<e.length;i++){const s=e[i];s.x<t?t=s.x:s.x>o&&(o=s.x),s.y<n?n=s.y:s.y>r&&(r=s.y)}return{x:t,y:n,w:o-t,h:r-n}}([S(i,r),S(a,r),S(s,r),S(d,r)].map((e=>({x:e.x+o.x+n.x,y:e.y+o.y+n.y}))))}return{x:o.x,y:o.y,w:t.width,h:t.height}}function M(e,t){return{x:e.x-t.x,y:e.y-t.y}}function S(e,t){return{x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}}function D(e,t,n){const o=t.position,r=t.hAlign?t.hAlign:n?"right":"left",i=t.vAlign;let s,a;return s="center"===r?o.x-e.width/2:"right"===r?o.x-e.width:o.x,a="middle"===i?o.y-e.height/2:"bottom"===i?o.y-e.height:"baseline"===i?o.y+e.y:o.y,{x:s,y:a}}function N(e,t,n,o,r){return{panX:o/2-e*n,panY:r/2-t*n}}function R(e,t){return e?.id===t?.id&&e?.isNode===t?.isNode}function k(e,t){let n,o=!1,r=e;for(;!n;)if(n=r.dataset.node,n?o=!0:n=r.dataset.link,!n){if(!r.parentElement||r.parentElement===t?.current)break;r=r.parentElement}return{id:n,isNode:o}}function z(e,t,n,o){return s.generateAriaLabel(e,o||"",{isSelected:t?n:void 0})}function X(e,t,n){const o=(e-2*w)/n.w,r=(t-2*w)/n.h;return Math.min(o,r)}function Y(e,t,n){let o=Math.max(t,e);return o=Math.min(n,o),o}function T(e){const t={};return e?(e.fontFamily&&(t.fontFamily=e.fontFamily),e.fontSize&&(t.fontSize=e.fontSize),e.fontStyle&&(t.fontStyle=e.fontStyle),e.fontWeight&&(t.fontWeight=e.fontWeight),t):t}function C(e,t,n,o,r,i,s){let a;if(e.isNode){a=n[o.get(e.id)]}else{const r=t.get(e.id),i=n[o.get(r.startNode)],s=n[o.get(r.endNode)],d=Math.min(i.x,s.x),c=Math.min(i.y,s.y);a={x:d,y:c,w:Math.max(i.x+i.w,s.x+i.w)-d,h:Math.max(i.y+i.h,s.y+s.h)-c}}return function(e,t,n,o){const r=(n-2*w)/e.w,i=(o-2*w)/e.h,s=Math.min(r,i,t),a=e.w/2+e.x,d=e.h/2+e.y;return{centerX:a,centerY:d,zoom:s}}(a,s,r,i)}const L=({id:e,state:n,previousState:s,position:c,activeId:u,nodeRenderer:l,onNodeSizeChanged:f,nodeIndex:h,data:g,accessibleLabel:p,isDimmed:m,supportsSelection:y})=>{const{nodeStyles:x,dimmedItemStyle:b}=o.itemStyles,w={state:n,previousState:s,data:g},I=d.useTranslationBundle("@oracle/oraclejet-preact"),v=i.useRef(null),P=i.useRef({box:"border-box"});return r.useResizeObserver(v,i.useCallback((e=>{const t=e.borderBoxSize,n=t[0].inlineSize,o=t[0].blockSize;f(n,o,h)}),[h,f]),P.current),t.jsx("div",{ref:v,class:a.classNames([x,m?b:void 0]),"data-node":e,role:"img","aria-label":z(I,y,n.selected,p),style:{top:c.y,left:c.x},id:n.focused||n.hovered?u:void 0,children:l(w)},e)};function Z({nodes:e,states:n,previousStates:r,nodeRenderer:i,nodeBounds:s,onNodeSizeChanged:a,supportsSelection:d}){return t.jsx("div",{class:o.layerStyles,children:e.map(((e,o)=>{const c=s&&s[o]?{x:s[o].x,y:s[o].y}:{x:0,y:0},u={selected:n.selectedNodeIds.includes(e.id),focused:n.focusedId===e.id,hovered:n.hoveredId===e.id,zoom:n.zoom},l={selected:r.selectedNodeIds.includes(e.id),focused:r.focusedId===e.id,hovered:r.hoveredId===e.id,zoom:r.zoom};return t.jsx(L,{id:e.id,position:c,state:u,previousState:l,isDimmed:0!==n.highlightedIds.length&&!n.highlightedIds.includes(e.id),activeId:n.activeId,nodeRenderer:i,onNodeSizeChanged:a,nodeIndex:o,accessibleLabel:e.accessibleLabel,data:e,supportsSelection:d})}))})}const A=({id:e,state:n,previousState:r,activeId:i,data:s,linkRenderer:c,accessibleLabel:u,isDimmed:l,supportsSelection:f,layoutOutput:h})=>{const g=d.useTranslationBundle("@oracle/oraclejet-preact"),{dimmedItemStyle:p,linkStyles:m}=o.itemStyles,y={state:n,previousState:r,data:s,layoutOutput:h};return t.jsx("g",{id:n.focused?i:void 0,"aria-label":z(g,f,n.selected,u),"data-link":e,role:"img",class:a.classNames([m,l&&p]),children:c(y)},e)};function O({links:e,states:n,previousStates:r,linkRenderer:i,width:s,height:a,supportsSelection:d,layoutOutput:c}){return t.jsx("svg",{class:o.layerStyles,width:s,height:a,children:e.map((e=>{const o={selected:n.selectedLinkIds.includes(e.id),focused:n.focusedId===e.id,hovered:n.hoveredId===e.id,zoom:n.zoom},s={selected:r.selectedLinkIds.includes(e.id),focused:r.focusedId===e.id,hovered:r.hoveredId===e.id,zoom:r.zoom};return t.jsx(A,{id:e.id,label:e.label,state:o,previousState:s,isDimmed:0!==n.highlightedIds.length&&!n.highlightedIds.includes(e.id),activeId:n.activeId,accessibleLabel:e.accessibleLabel,data:e,linkRenderer:i,supportsSelection:d,layoutOutput:c})}))})}const V=({text:e,position:n,styles:r,dimensions:i,isRTL:s})=>{const{labelStyle:d,labelBorderStyle:c}=o.labelStyles,u=D(i,n,s),l=function(e){const t=e.rotationAngle,n=e.rotationPoint,o={};t&&(o.transform=`rotate(${t}deg)`);n&&(o["transform-origin"]=`${n.x}px ${n.y}px`);return o}(n);return t.jsx("div",{class:a.classNames([d,r&&r.borderColor&&c]),style:{top:u.y,left:u.x,...r,...l},children:e})};function E({labelPosition:e,itemProps:n,labelDimensions:r}){const{direction:i}=c.useUser();return t.jsx("div",{class:o.layerStyles,children:n.map(((n,o)=>{if(n.label&&e[o])return t.jsx(V,{styles:n.labelStyle,text:n.label,position:e[o],dimensions:r.get(n.id),isRTL:"rtl"===i})}))})}function j({nodes:e,links:n,nodeRenderer:o,linkRenderer:r,states:i,previousStates:s,nodeBounds:a,onNodeSizeChanged:d,width:c,height:u,nodeLabelPositions:l,linkLabelPositions:f,labelDimensions:h,supportsSelection:g,layoutOutput:p}){return t.jsxs(t.Fragment,{children:[n.length>0&&p&&r&&c!==1/0&&t.jsx(O,{links:n,states:i,previousStates:s,linkRenderer:r,width:c,height:u,supportsSelection:g,layoutOutput:p}),t.jsx(Z,{nodes:e,nodeBounds:a,states:i,previousStates:s,nodeRenderer:o,onNodeSizeChanged:d,supportsSelection:g}),h?t.jsxs("div",{children:[l?t.jsx(E,{labelPosition:l,itemProps:e,labelDimensions:h}):void 0,n&&f?t.jsx(E,{labelPosition:f,itemProps:n,labelDimensions:h}):void 0]}):void 0]})}function B({centerX:e,centerY:n,children:r,zoom:i,width:s,height:a}){const d=N(e,n,i,s,a);return t.jsx("div",{class:o.panZoomStyles,style:{translate:`${d.panX}px ${d.panY}px`,transform:`scale(${i})`},children:r})}function U(e,t){let n;for(let o=0;o<t.length;o++)if(n=t[o],e.id===n.id)return n}function F(e,t){const n=[];return t.forEach((t=>{const o=t.startNode,r=t.endNode;o!=e&&r!=e||n.push(t)})),n}function K(e,t,n,o){let r,i=n[0],s=n[0];for(let e=0;e<n.length;e++)r=n[e],r.id===t.startNode?i=r:r.id===t.endNode&&(s=r);const a=e.id==i.id?s:i,d=$(e,o),c=$(a,o);let u=Math.atan2(c.y-d.y,c.x-d.x);return u=u<0?u+2*Math.PI:u,u}function G(e,t,n){let o,r=t[0],i=t[0];for(let n=0;n<t.length;n++)o=t[n],o.id===e.startNode?r=o:o.id===e.endNode&&(i=o);const s=$(r,n),a=$(i,n);return Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))}function _(e,t){return t.endNode===e.id?1:0}function $(e,t){const n=t.get(e.id);return{x:n.x+n.w/2,y:n.y+n.h/2}}function W(e,t,n){const o=15/180*Math.PI,r=40/180*Math.PI,i=e.x+e.w/2,s=e.y+e.h/2,a=t.x+t.w/2,d=t.y+t.h/2,c=Math.abs(i-a),u=Math.abs(s-d),l=Math.atan2(u,c);let f=Math.sqrt(c*c+u*u);return(l>o&&("right"==n||"left"==n)||l<Math.PI/2-o&&("up"==n||"down"==n))&&(l>r&&("right"==n||"left"==n)||l<Math.PI/2-r&&("up"==n||"down"==n)?f*=6:f*=2),f}function q(e,t,n,o){if(o){const o=e.x+.5*e.w,r=t.x+.5*t.w,i=e.y+.5*e.h,s=t.y+.5*t.h;switch(n){case"up":return i<s;case"down":return e.y>s;case"right":return o>r;case"left":return o<r}return!0}switch(n){case"up":return e.y<t.y||ee(e.y,t.y);case"down":return e.y>t.y||ee(e.y,t.y);case"right":return e.x>t.x||ee(e.x,t.x);case"left":return e.x<t.x||ee(e.x,t.x)}return!0}function H(e,t,n){switch(n){case"up":return J(e,t)&&(t.y<=e.y+e.h||ee(t.y,e.y+e.h));case"down":return J(e,t)&&(e.y<=t.y+t.h||ee(e.y,t.y+t.h));case"right":return Q(e,t)&&(e.x<=t.x+t.w||ee(e.x,t.x+t.w));case"left":return Q(e,t)&&(t.x<=e.x+e.w||ee(t.x,e.x+e.w))}return!1}function J(e,t){return e.x>=t.x&&e.x<=t.x+t.w||t.x>=e.x&&t.x<=e.x+e.w}function Q(e,t){return e.y>=t.y&&e.y<=t.y+t.h||t.y>=e.y&&t.y<=e.y+e.h}function ee(e,t){return Math.abs(e-t)<=1e-7}function te(e,t){let n=Math.abs(e-t)<=1e-7;return n||(n=Math.abs(2*Math.PI+Math.min(e,t)-Math.max(e,t))<=1e-7),n}function ne(e,t,n,o){const r=i.useRef(),s=function(e,t){const n=new Map;for(let o=0;o<e.length;o++)n.set(e[o].id,t[o]);return n}(e,n);return{isNode:n=>{let o,r;for(let i=0;i<e.length;i++){if(o=e[i],r=t[i],n.id===o.id)return!0;if(n.id===r.id)return!0}return!1},getNextNavigableNode:function(e,t,n,o){if(!o)return n;if(!n)return o[0];const r=s.get(n.id);if(!r)return o[0];let i,a,d,c=n,u=Number.MAX_VALUE,l=!1,f=!1;for(let h=0;h<o.length;h++){if(i=o[h],i===n){f=!0;continue}const g=s.get(i.id);if(!g)continue;const p={x:g.x,y:g.y,w:g.w,h:g.h},m={x:r.x,y:r.y,w:r.w,h:r.h};q(p,m,e,t)&&(a=H(p,m,e),l&&!a||(d=W(p,m,e),(0!=d||f)&&(!l&&a||d<u&&(l&&a||!l))&&(u=d,c=i,l=a)))}return c},getNextNavigableLink:function(e,t,n,o){if(!o)return n;if(!n)return o[0];const i=r.current,a=U({id:i||n.startNode,isNode:!0},t);if(!a)return n;const d=function(e,t,n,o){let r,i,s;const a=[];for(let d=0;d<t.length;d++){const c=t[d];r=K(e,c,n,o),i=G(c,n,o),s=_(e,c),a.push({id:c.id,angle:r,distance:i,direction:s})}return a}(a,o=F(a.id,o),t,s);d.sort(((e,t)=>{const{angle:n,distance:o,direction:r}=e,{angle:i,distance:s,direction:a}=t;let d=-1;return!te(n,i)&&n>i?d=1:te(n,i)&&(o>s||s==o&&r>a?d=1:s==o&&r==a&&(d=0)),d}));const c="down"==e;let u=0;for(let e=0;e<d.length;e++){if(d[e].id===n.id){u=c?e==d.length-1?0:e+1:0==e?d.length-1:e-1;break}}return d[u]},navigateFromNodeToLink:function(e,t,n){if(!n)return;const o=F(n.id,e);if(o.length<1)return;let i=o[0];const a=s.get(n.id);let d,c,u,l;const f=a.x+a.w/2;r.current=n.id;for(let e=0;e<o.length;e++)if(d=o[e],c=d.startNode===n.id?d.endNode:d.startNode,u=s.get(c),l=u.x+u.w/2,t.altKey&&"Comma"===t.code&&l<=f||t.altKey&&"Period"===t.code&&l>=f){i=d;break}return{id:i.id,isNode:!1}},navigateFromLinkToNode:function(e,t){const n=t.key,r=o.get(e),i=s.get(r.startNode),a=s.get(r.endNode);if(!i||!a)return;const d=i.x+i.w/2,c=a.x+a.w/2;return{id:c>d&&"ArrowRight"===n||c<d&&"ArrowLeft"===n?r.endNode:r.startNode,isNode:!0}}}}const oe=15,re=.15;function ie(e,t,n,o,r,s,a,d,c,h,g,p,m,y,x){const{getNextNavigableNode:b,getNextNavigableLink:w,navigateFromNodeToLink:I,navigateFromLinkToNode:v}=ne(n,o,r,s),[P,M]=i.useState({id:t.id,isNode:!0}),[S,D]=i.useState(),N=i.useRef(),z=l.useVisHover((e=>{const t=k(e.target);t&&!R(t,S)&&(D({...t,isCurrent:!0}),N.current=u.getRandomId(),M({...P,isCurrent:!1}),t.isNode?p?.({id:t.id,type:"node",data:a.get(t.id)}):p?.({id:t.id,type:"link",data:s.get(t.id)}))}),void 0,(()=>{D(void 0),N.current=void 0,p?.({id:void 0,data:void 0})}),e);function X(e){e.isNode?m?.({id:e.id,type:"node",data:a.get(e.id)}):m?.({id:e.id,type:"link",data:s.get(e.id)}),N.current=u.getRandomId(),M(e)}function Y(e){e&&(R(e,P)||(e.isCurrent=!0,e.isFocusVisible=!0,S&&D({...S,isCurrent:!1}),X(e)))}return{focusedItemInfo:P,hoveredItemInfo:S,activeId:N.current,eventsProps:f.mergeProps(z,{onKeyUp:e=>{if("Tab"===e.code)X({...P,isCurrent:!0,isFocusVisible:!0})},onKeyDown:e=>{const t=e.key;let i=!1;if("TAB"!==t){if(function(e){const t=e.code;if(P.isNode&&e.altKey&&("Period"===t||"Comma"===t))return!0;if(!P.isNode&&("ArrowLeft"===t||"ArrowRight"===t))return!0;return!1}(e)){Y(P.isNode?I(o,e,U(P,n)):v(P.id,e)),i=!0}else if(function(e){switch(e){case"ArrowDown":case"ArrowUp":case"ArrowRight":case"ArrowLeft":return!0}return!1}(t)){const e=function(e){let t="down";switch(e){case"ArrowDown":t="down";break;case"ArrowUp":t="up";break;case"ArrowRight":t="right";break;case"ArrowLeft":t="left"}if(P.isNode){const e=b(t,!0,U(P,n),n);return e?{id:e.id,isNode:!0}:P}{const e=function(e,t){let n;for(let o=0;o<t.length;o++)if(n=t[o],e.id===n.id)return n}(P,o),r=w(t,n,e,o);return r?{id:r.id}:{id:P.id}}}(t);Y(e),i=!0}else switch(t){case"PageUp":y&&y({dPan:{dx:e.shiftKey?-oe:0,dy:e.shiftKey?0:-oe}}),i=!0;break;case"PageDown":y&&y({dPan:{dx:e.shiftKey?oe:0,dy:e.shiftKey?0:oe}}),i=!0,i=!0;break;case"+":case"=":x&&x({dZoom:re}),i=!0;break;case"-":case"_":x&&x({dZoom:-re}),i=!0;break;case"0":if(e.ctrlKey&&e.altKey){const{centerX:e,centerY:t,zoom:n}=C(P,s,r,d,c,h,g);x&&x({nZoom:n}),y&&y({nPan:{cx:e,cy:t}})}else x&&x({}),y&&y({center:!0});i=!0}i&&(e=>{e.preventDefault(),e.stopPropagation()})(e)}},onBlur:()=>{(null!=S||P.isCurrent)&&m?.({id:void 0,data:void 0});const e={...P,isCurrent:!1,isFocusVisible:!1};M(e)},onPointerUp:e=>{const t=k(e.target);null!=t.id&&(M(t),N.current=u.getRandomId())}})}}const se=({touchResponse:e,datatip:t,focusedItemBoundsRef:n,focusedItemInfo:o,panState:r,zoom:i,width:s,nodesMap:a,linksMap:d,hoveredItem:l})=>{const{direction:f}=c.useUser(),g="rtl"===f,p=function(e,t,n,o,r){let i;const s=o?.isCurrent;if(s&&null!=o.id&&(i=o),n&&n.isCurrent&&(i=n),i&&r)return r(i.isNode?{data:e.get(i.id),type:"node"}:{data:t.get(i.id),type:"link"});if(i){const n=(i.isNode?e.get(i.id):t.get(i.id))?.accessibleLabel;return{content:n}}}(a,d,o,l,t),m=n.current?{x:n.current.x*i+r.panX,y:n.current.y*i+r.panY,width:n.current.w*i,height:n.current.h*i}:void 0,{datatipContent:y,datatipProps:x}=h.useDatatip({content:p?.content,borderColor:p?.borderColor,placement:"top-start",offset:u.calculateOffset(g,s,m),anchor:o?.isCurrent?"element":"pointer",touchResponse:e});return{datatipContent:y,datatipProps:x}},ae=({captureTargetRef:e,numPointers:t=1,onPointerGestureDown:n,onPointerGestureMove:o,onPointerGestureEnd:r,onExtraneousPointerDown:s,isDisabled:a=!1})=>{const d=i.useRef([]);a&&(d.current=[]);const c=e=>{const n=d.current.findIndex((t=>t.pointerId===e.pointerId));-1!==n&&(d.current[n]=e,d.current.length===t&&r&&r({pointers:d.current}),d.current.splice(n,1))};return a?{}:{onPointerDown:e=>{d.current.push(e),d.current.length===t?n&&n({pointers:d.current}):d.current.length>t&&s&&s({pointers:d.current})},onPointerMove:n=>{if(0===d.current.length)return;const r=d.current.findIndex((e=>e.pointerId===n.pointerId));-1!==r&&(d.current[r]=n,d.current.length===t&&(d.current.forEach((t=>e.current.setPointerCapture(t.pointerId))),o&&o({pointers:d.current})))},onPointerUp:c,onPointerCancel:c,onPointerLeave:c}},de=(e,t,n,o,r,i,s,a)=>{if(!s)return{newPan:{panX:0,panY:0}};const d=((e,t,n,o)=>{const r="y"!==o?t.panX:e.panX,i="x"!==o?t.panY:e.panY;return{panX:r>n.maxX?n.maxX:r<n.minX?n.minX:r,panY:i>n.maxY?n.maxY:i<n.minY?n.minY:i}})(e,t,s,n),c=d.panX!==e.panX||d.panY!==e.panY,u=function(e,t,n,o,r){return{centerX:(o/2-e)/n,centerY:(r/2-t)/n}}(d.panX,d.panY,o,r,i);return c&&a&&a({centerX:u.centerX,centerY:u.centerY}),{newPan:d}},ce=({panProps:e,captureTargetRef:t,panBounds:n,width:o,height:r,zoom:s,onDragPanStart:a,onDragPanEnd:d})=>{const c=i.useRef({panX:0,panY:0}),u=i.useRef({panX:0,panY:0}),l=(({captureTargetRef:e,draggableRegion:t,onDragStart:n,onDragMove:o,onDragEnd:r,isDisabled:s=!1})=>{const a={isDragging:!1,x0:-1,y0:-1,regionOffsetX:-1,regionOffsetY:-1},d=i.useRef(a),c=(e,t)=>{const{isDragging:n,x0:o,y0:r,regionOffsetX:i,regionOffsetY:s}=d.current;if(!n)return;const a=e.pageX,c=e.pageY;t&&t({x:a,y:c,dx:a-o,dy:c-r,regionOffsetX:i,regionOffsetY:s,originalEvent:e})},u=ae({captureTargetRef:e,numPointers:1,onExtraneousPointerDown:()=>{d.current=a},onPointerGestureDown:({pointers:[e]})=>{const o=e.pageX,r=e.pageY;if(0!==e.button||!((e,t,n)=>{if(!n)return!0;const{xMin:o,xMax:r,yMin:i,yMax:s}=n;return e>=o&&e<=r&&t>=i&&t<=s})(o,r,t))return;const{regionOffsetX:i,regionOffsetY:s}=((e,t,n)=>n?{regionOffsetX:e-n.xMin,regionOffsetY:t-n.yMin}:{regionOffsetX:e,regionOffsetY:t})(o,r,t);d.current={isDragging:!0,x0:o,y0:r,regionOffsetX:i,regionOffsetY:s},n&&n({x:o,y:r,regionOffsetX:i,regionOffsetY:s,originalEvent:e})},onPointerGestureMove:({pointers:[e]})=>{c(e,o)},onPointerGestureEnd:({pointers:[e]})=>{c(e,r),d.current=a}});return s?{}:u})({captureTargetRef:t,onDragStart:()=>{const t=N(e.centerX,e.centerY,s,o,r);u.current={panX:t.panX,panY:t.panY},a&&a()},onDragMove:({dx:t,dy:i})=>{const a={panX:u.current.panX+t,panY:u.current.panY+i},{newPan:d}=de(c.current,a,e.panDirection,s,o,r,n,e.onPan);c.current=d},onDragEnd:({originalEvent:e})=>{u.current.panX===c.current.panX&&u.current.panY===c.current.panY||e.preventDefault(),d&&d()},isDisabled:"off"===e.panning});return l},ue=(e,t,n,o,r)=>{const i=e>o||e<n?t:e;i!==t&&r&&r({zoomValue:i})},le=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-t.y)**2),fe=({captureTargetRef:e,zooming:t,minZoom:n,maxZoom:o,zoomValue:r,onZoom:s})=>{const a=(({captureTargetRef:e,onPinchZoomStart:t,onPinchZoomChange:n,onPinchZoomEnd:o,isDisabled:r=!1})=>{const s=i.useRef({x:-1,y:-1}),a=i.useRef(-1),d=()=>{s.current={x:-1,y:-1},a.current=-1};r&&d();const c=ae({captureTargetRef:e,numPointers:2,onPointerGestureDown:({pointers:[e,n]})=>{const o={x:e.offsetX,y:e.offsetY},r={x:n.offsetX,y:n.offsetY};s.current=((e,t)=>({x:(e.x+t.x)/2,y:(e.y+t.y)/2}))(o,r),a.current=le(o,r),t&&t({origin:s.current,delta:0})},onPointerGestureMove:({pointers:[e,t]})=>{const o={x:e.offsetX,y:e.offsetY},r={x:t.offsetX,y:t.offsetY},i=le(o,r),d=i-a.current;a.current=i,n&&n({origin:s.current,delta:d})},onPointerGestureEnd:()=>{d(),o&&o()}});return r?{}:c})({captureTargetRef:e,onPinchZoomChange:({delta:e})=>{ue(r*(1+.05*e),r,n,o,s)},isDisabled:"off"===t});return a},he=({props:e,captureTargetRef:t,width:n,height:o,contentBounds:r,isRtl:s})=>{const[a,d]=i.useState(),c=function(e,t,n,o){const r=e.minZoom?e.minZoom:X(t,n,o),i=void 0!==e.maxZoom?e.maxZoom:1,s=e.zoomValue?e.zoomValue:X(t,n,o);return{zooming:e.zooming?e.zooming:"off",minZoom:r,maxZoom:i,zoomValue:Y(s,r,i),onZoom:e.onZoom}}(e,n,o,r),u=i.useRef(),l=i.useRef(),h=i.useRef(),g=i.useRef({zoom:e.zoomValue||0,centerX:e.centerX,centerY:e.centerY}),y=p.isTouch(),x={width:n,height:o,x:0,y:0},b=y?e.panning&&"off"!==e.panning:void 0,w={isZoomScroll:!0,plotAreaSpace:x,componentWidth:n,isRtl:s,showPanButton:b??!1,showZoomButton:!1,showSelectButton:!1,isDisabled:!y},{toggleButtonContent:I,userDragMode:v}=m.useVisDragModeControls(w),P=function(e,t,n,o){return{panning:o?"pan"===n&&e.panning?e.panning:"off":e.panning?e.panning:"off",panDirection:e.panDirection?e.panDirection:"any",centerX:void 0!==e.centerX?e.centerX:t.w/2+t.x,centerY:void 0!==e.centerY?e.centerY:t.h/2+t.y,onPan:e.onPan}}(e,r,v,y);r.w===1/0||c.zoomValue===l.current&&P.panning===h.current||(u.current=((e,t,n,o,r,i,s)=>{const{x:a,y:d,w:c,h:u}=n;let l,f,h,g;if("centerContent"===s)l=e/2-(c+a)*o,h=t/2-(u+d)*o,f=e/2-a*o,g=t/2-d*o;else{const n=o/r,i=(e-c*r)/2-a*r,s=(t-u*r)/2-d*r;l=e-e*n+i*n,h=t-t*n+s*n,f=i*n,g=s*n}const p=i.zoom,m=i.centerX,y=i.centerY;let x,b;if(m){const t=m*p-e/2;-t*p<l?(x=l-t*p,l-=x,f+=x):-t*p>f&&(x=-t*p-f,l-=x,f+=x)}if(y){const e=y*p-t/2;-e*p<h?(b=h-e*p,h-=b,g+=b):-e*p>g&&(b=-e*p-g,h-=b,g+=b)}return{minX:l,maxX:f,minY:h,maxY:g}})(n,o,r,c.zoomValue,c.minZoom,g.current,P.panning),l.current=c.zoomValue,h.current=P.panning);const M=ce({panProps:P,captureTargetRef:t,panBounds:u.current,zoom:c.zoomValue,width:n,height:o,onDragPanStart:()=>d("grabbing"),onDragPanEnd:()=>d("auto")}),S=i.useRef({panX:0,panY:0}),D=(({zooming:e,minZoom:t,maxZoom:n,zoomValue:o,onZoom:r})=>(({onWheel:e,preventDefault:t=!0,isDisabled:n=!1})=>n?{}:{onWheel:n=>{const{deltaX:o,deltaY:r}=(e=>{const{deltaX:t,deltaY:n,deltaMode:o}=e;switch(o){case e.DOM_DELTA_PIXEL:return{deltaX:-t,deltaY:-n};case e.DOM_DELTA_LINE:return{deltaX:15*-t,deltaY:15*-n};case e.DOM_DELTA_PAGE:return{deltaX:40*-t,deltaY:40*-n};default:return{deltaX:-t,deltaY:-n}}})(n);t&&n.preventDefault(),e({x:n.offsetX,y:n.offsetY,deltaX:o,deltaY:r,ctrlKey:n.ctrlKey||n.metaKey})}})({onWheel:({deltaY:e})=>{ue(o*(1+.05*e),o,t,n,r)},isDisabled:"off"===e}))(c),R=fe({captureTargetRef:t,zooming:c.zooming,minZoom:c.minZoom,maxZoom:c.maxZoom,zoomValue:c.zoomValue,onZoom:c.onZoom});return{panZoomProps:f.mergeProps(M,D,R),panProps:P,zoomProps:c,toggleButtonContent:I,cursor:a,centerX:P.centerX,centerY:P.centerY,zoomValue:c.zoomValue,kbPanCallback:"off"!==P.panning?e=>{let t,i;e.center?(t=r.x+r.w/2,i=r.y+r.h/2):e.dPan?(t=P.centerX+e.dPan.dx,i=P.centerY+e.dPan.dy):(t=e.nPan.cx,i=e.nPan.cy);const s=N(t,i,c.zoomValue,n,o),{newPan:a}=de(S.current,s,P.panDirection,c.zoomValue,n,o,u.current,P.onPan);S.current=a}:void 0,kbZoomCallback:"off"!==c.zooming?e=>{const t=e.dZoom?c.zoomValue+e.dZoom:X(n,o,r);ue(e.nZoom?e.nZoom:t,c.zoomValue,c.minZoom,c.maxZoom,c.onZoom)}:void 0}};function ge({nodes:e=[],links:n=[],width:r,height:s,selectedIds:a={},selectionMode:d="none",layout:u,nodeRenderer:l,linkRenderer:h,onSelectionChange:p,onItemHover:m,onItemFocus:w,highlightedIds:M={},datatip:S,...D}){const R=i.useRef(null),z=i.useRef(null),[X,Y]=i.useState([]),[C,L]=i.useState(),{direction:Z}=c.useUser(),A="rtl"===Z,O=e,V=I(O),E=V.itemIdToDataMap,U=function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=e[o];t.get(r.startNode)&&t.get(r.endNode)&&n.push(r)}return n}(n,E),F=I(U),K=F.itemIdToDataMap,G=i.useRef(!1),_=function(e){const t=[];for(let n=0;n<e.length;n++)t.push({w:e[n].w,h:e[n].h});return t}(X),{textMeasureContent:$,getTextDimensions:W}=g.useTextDimensions(),q=i.useRef(new Map),H=i.useRef([]),J=i.useRef([]),Q=i.useRef(),ee=function(e,t){if(0===e.length)return{x:0,w:1/0,y:0,h:1/0};let n,o=1/0,r=1/0,i=-1/0,s=-1/0;for(let t=0;t<e.length;t++)n=e[t],o=n.x<o?n.x:o,r=n.y<r?n.y:r,i=n.x+n.w>i?n.x+n.w:i,s=n.y+n.h>s?n.y+n.h:s;return t&&(o=t.x<o?t.x:o,r=t.y<r?t.y:r,i=t.x+t.w>i?t.x+t.w:i,s=t.y+t.h>s?t.y+t.h:s),{x:o,w:i-o,y:r,h:s-r}}(X,C),{panZoomProps:te,panProps:ne,zoomProps:oe,toggleButtonContent:re,cursor:ae,centerX:de,centerY:ce,zoomValue:ue,kbPanCallback:le,kbZoomCallback:fe}=he({props:D,captureTargetRef:z,width:r,height:s,contentBounds:ee,isRtl:A}),{touchResponse:ge,touchResponseStyle:pe}=x.useVisTouchResponse({type:"auto",supportsTouchDragGestures:"on"===oe.zooming||"off"!==ne.panning,rootRef:z}),{focusedItemInfo:me,hoveredItemInfo:ye,activeId:xe,eventsProps:be}=ie(ge,O[0],O,U,X,K,E,V.itemIdToIndexMap,r,s,D.maxZoom||1,m,w,le,fe),{selectionProps:we,selectionContent:Ie}=function({selectedIds:e,selectionMode:t,nodeMap:n,linkMap:o,focusedItemInfo:r,onSelectionChange:i,rootRef:s}){const a=n.itemIdToIndexMap,d=n.itemIndexToIdMap,c=n.itemIdToDataMap,u=o.itemIdToIndexMap,l=o.itemIndexToIdMap,f=o.itemIdToDataMap,h=e=>`N_${a.get(e)}`,g=e=>d.get(Number(e.slice(2))),p=e=>`L_${u.get(e)}`,m=e=>l.get(Number(e.slice(2))),x=[...e.nodes?e.nodes.map(h):[],...e.links?e.links.map(p):[]],{selectionContent:b,selectionProps:w}=y.useSelection({selection:x,idExtracter:e=>{const t="keyup"===e.type?r:k(e.target,s);return void 0!==t.id?t.isNode?h(t.id):p(t.id):void 0},selectionMode:t,getDataById:e=>{let t;if("N"===e[0]){const o=g(e);t=n.itemIdToDataMap.get(o)}else if("L"===e[0]){const n=m(e);t=o.itemIdToDataMap.get(n)}return t},onChange:e=>{const t=e.ids.filter((e=>"N"===e[0])).map((e=>g(e))),n=e.ids.filter((e=>"L"===e[0])).map((e=>m(e))),o=t.filter((e=>"off"!==c.get(e)?.selectable)),r=n.filter((e=>"off"!==f.get(e)?.selectable)),s=o.map((e=>c.get(e))),a=r.map((e=>f.get(e)));return i&&i({nodes:o,links:r,nodeData:s,linkData:a})}});return{selectionContent:b,selectionProps:w}}({selectedIds:a,selectionMode:d,nodeMap:V,linkMap:F,focusedItemInfo:me,onSelectionChange:p,rootRef:z});me&&X.length>0&&(R.current=function(e,t,n,o,r){if(e.isNode)return t[o.get(e.id)||0];{const i=n[r.get(e.id)||0],s=t[o.get(i.startNode)||0],a=t[o.get(i.endNode)||0],d={x:s.x+s.w/2,y:s.y+s.h/2},c={x:a.x+a.w/2,y:a.y+a.h/2};return{x:Math.min(d.x,c.x),y:Math.min(d.y,c.y),w:Math.abs(d.x-c.x),h:Math.abs(d.y-c.y)}}}(me,X,U,V.itemIdToIndexMap,F.itemIdToIndexMap));const{datatipContent:ve,datatipProps:{"aria-describedby":Pe,...Me}}=se({touchResponse:ge,datatip:S,focusedItemInfo:me,focusedItemBoundsRef:R,panState:N(de,ce,ue,r,s),zoom:ue,width:r,nodesMap:E,linksMap:K,hoveredItem:ye}),Se={width:r,height:s,cursor:ae,...pe},De=i.useRef(),Ne=De.current?De.current:{selectedNodeIds:[],selectedLinkIds:[],focusedId:void 0,hoveredId:void 0,activeId:void 0,highlightedIds:[],zoom:0};De.current={selectedNodeIds:a.nodes??[],selectedLinkIds:a.links??[],focusedId:me.isCurrent&&me.isFocusVisible?me.id:void 0,hoveredId:ye?.isCurrent?ye.id:void 0,activeId:xe,highlightedIds:v(M.nodes,M.links),zoom:ue};const Re=f.mergeProps(te,be,we,Me);return t.jsxs("div",{ref:z,class:o.outerStyles,...Re,style:Se,tabIndex:0,role:"application","aria-label":D["aria-label"],"aria-labelledby":D["aria-labelledby"],"aria-describedby":b.merge([D["aria-describedby"],Pe]),"aria-activedescendant":xe,children:[W?t.jsx(B,{centerX:de,centerY:ce,zoom:ue,width:r,height:s,children:t.jsx(j,{nodes:O,links:U,nodeRenderer:l,linkRenderer:h,width:r,height:s,nodeBounds:X,states:De.current,previousStates:Ne,onNodeSizeChanged:(e,t,n)=>{_[n]={w:e,h:t},G.current||(G.current=!0,window.requestAnimationFrame((()=>{const{labelDims:e,layoutJSON:t}=function(e,t,n,o,r,i,s){const a=new Map,d=Array.from(t.keys());for(const e of d){const n=t.get(e);if(n&&s&&n.label){const t=n.label,o=T(n.labelStyle);a.set(e,s(t,o))}}const c=Array.from(n.keys());for(const e of c){const t=n.get(e);if(t&&s&&t.label){const n=t.label,o=T(t.labelStyle);a.set(e,s(n,o))}}return{layoutJSON:{getNodeDimensions:function(t){for(let n=0;n<e.length;n++)if(t.id===e[n].id)return o[n];return o[0]},getLabelDimensions:function(e){return a.get(e.id)},componentSize:{width:r,height:i}},labelDims:a}}(O,E,K,_,r,s,W);q.current=e;const n=u(t),{nodePoints:o,nodeLabelPos:i,linkLabelPos:a}=function(e,t,n){const o=e.nodes,r=e.links,i=[],s=[],a=[];let d,c,u=!1,l=!1;for(let e=0;e<t.length;e++)d=o[t[e].id],i.push(d.position),d.label&&(u=!0),s.push(d.label);if(r)for(let e=0;e<n.length;e++)c=r[n[e].id],c.label&&(l=!0),a.push(c.label);return{nodePoints:i,nodeLabelPos:u?s:void 0,linkLabelPos:l?a:void 0}}(n,O,U);H.current=i,J.current=a,Q.current=n;const d=function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=t[o],i=e[o];n.push({x:r.x,y:r.y,w:i.w,h:i.h})}return n}(_,o);var c,l;l=X,(c=d).length===l.length&&c.every((({x:e,y:t,w:n,h:o},r)=>l[r].x===e&&l[r].y===t&&l[r].w===n&&l[r].h===o))||Y(d);const f=function(e,t,n,o=[],r=[],i){if(0===o.length&&0===r.length)return;let s,a,d=1/0,c=1/0,u=-1/0,l=-1/0;for(let n=0;n<o.length;n++)a=o[n],a&&(s=P(a,e.get(t[n].id),i),d=s.x<d?s.x:d,c=s.y<c?s.y:c,u=s.x+s.w>u?s.x+s.w:u,l=s.y+s.h>l?s.y+s.h:l);for(let t=0;t<r.length;t++)a=r[t],a&&(s=P(a,e.get(n[t].id),i),d=s.x<d?s.x:d,c=s.y<c?s.y:c,u=s.x+s.w>u?s.x+s.w:u,l=s.y+s.h>l?s.y+s.h:l);return{x:d,w:u-d,y:c,h:l-c}}(e,O,U,i,a,"rtl"===Z);L(f),G.current=!1})))},nodeLabelPositions:H.current,linkLabelPositions:J.current,labelDimensions:q.current,supportsSelection:"none"!==d||!!(a?.nodes&&a.nodes.length>0)||!!(a?.links&&a.links.length>0),layoutOutput:Q.current})}):void 0,$,ve,Ie,re]})}e.Diagram=function({width:e,height:r,...i}){return i.nodes&&i.nodes.length>0?t.jsx(n.TrackResizeContainer,{width:e,height:r,class:o.dimensionStyle,children:(e,n)=>t.jsx(ge,{width:e,height:n,...i})}):null}}));
//# sourceMappingURL=Diagram-04db0931.js.map
