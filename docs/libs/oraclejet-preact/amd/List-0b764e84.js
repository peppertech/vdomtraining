define(['exports', 'preact/jsx-runtime', 'preact/hooks', './classNames-08d99695', './mergeProps-bcfa6a92', './keys-4755c121', './LoadMoreCollection-83413a59', './VirtualizedCollection-897516a5', 'preact/compat', './TabbableModeContext-a9c97640', './useId-c9578d26', './FocusTrap-60520575', './useInteractionStyle-76a64325', './mergeInterpolations-9ede4cf7', './flexitem-5db48325', './PRIVATE_List/themes/ListStyles.css', './collectionUtils-17f5cc64', './Skeleton-5839404b', './Flex-3421f0df', './Selector-2b0c34a7', './ImageVars.css-17386400', './useTheme-a8334e06', './useTestId-b5cd4766', './CollectionInteractionContext-0b4ed98b', './useCollectionInteractionContext-f345e8f7', 'preact', './useSelection-4249360e', './useDropDownSelection-c946783d', './useCurrentKey-a993db56', './useCollectionFocusRing-66a6fc12', './useItemAction-821d1b6e', './useTabbableModeSet-dc176f1d', './useReorderableContext-a5453bd7', './Inset-a34e9c57', 'module'], (function(e,t,n,i,s,r,o,l,a,c,d,u,g,f,m,b,y,p,v,h,x,S,k,C,I,w,K,P,T,R,V,j,A,E,F){"use strict";const M=e=>{switch(e){case"listbox":return{list:"listbox",item:"presentation",cell:"option"};case"treegrid":return{list:"treegrid",item:"row",cell:"gridcell"};default:return{list:"grid",item:"row",cell:"gridcell"}}},L="[data-oj-key]";function D({children:e,context:s,itemDepth:r,isFocused:o,isFocusRingVisible:l,isActive:a,isGridlineVisible:y,isSelected:p,isTopGridlineVisible:v=!1,isTabbable:h=!1,role:x,selectionMode:S,suggestion:k,currentItemVariant:C,padding:I}){const w=n.useRef(null),K=n.useMemo((()=>M(x)),[x]),P=s.metadata.key,T=s.index,R="option"===K.cell?{role:K.cell,"aria-posinset":T+1,"aria-setsize":-1}:{role:K.cell},{interactionProps:V,applyActiveStyle:j,applyHoverStyle:A,applyPseudoHoverStyle:E}=g.useInteractionStyle(),F=b.listItemMultiVariantStyles({selectable:H(S,p)?"isSelectable":"notSelectable",selected:p?"isSelected":"notSelected",selectedSingle:p&&"single"===S?"isSelectedSingle":"notSelectedSingle",needsEventsHover:A?"isNeedsEventsHover":"notNeedsEventsHover",pseudoHover:E?"isPseudoHover":"notPseudoHover",active:j||a?"isActive":"notActive",focusHighlight:"highlight"===C&&o?"isFocusHighlight":"notFocusHighlight",focusRingVisible:l&&o?"isFocusRingVisible":"notFocusRingVisible",gridlineTop:v?"visible":"hidden",gridlineBottom:!y&&("end"!==k||y||p&&"single"===S)?"hidden":"visible"}),L=[];I&&("enabled"===I?L.push(b.paddingStyles.allPadding):"disabled"!==I&&("enabled"===I.top&&L.push(b.paddingStyles.topItemPadding),"enabled"===I.bottom&&L.push(b.paddingStyles.bottomItemPadding),"enabled"===I.start&&L.push(b.paddingStyles.startItemPadding),"enabled"===I.end&&L.push(b.paddingStyles.endItemPadding)));const D=i.classNames([F,...L]),z=f.mergeInterpolations([...Object.values(m.flexitemInterpolations)]),{class:N,...O}=z({flex:"1 1 auto",alignSelf:"center"}),G=i.classNames([N,"multiple"===S&&b.listItemStyles.checkboxContainer]);return t.jsx("div",{"aria-rowindex":"grid"===x?T+1:void 0,"aria-level":r,"data-oj-key":P,class:D,ref:w,role:K.item,...k&&{"data-oj-suggestion":!0},..."number"==typeof P&&{"data-oj-key-type":"number"},...V,children:t.jsx("div",{id:d.useId(),style:O,class:G,"aria-posinset":"grid"===x?void 0:T+1,"aria-setsize":"grid"===x?void 0:-1,onKeyDown:e=>{!h||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()},"aria-colindex":"grid"===x?1:void 0,"aria-selected":"none"!==S?p:void 0,...R,children:t.jsx(c.TabbableModeContext.Provider,{value:{isTabbable:h},children:t.jsx(u.FocusTrap,{isDisabled:!h,restoreFocusRef:!1,children:e(s)})})})})}const H=(e,t)=>"none"!==e&&("multiple"===e||!t),z=a.memo(D,((e,t)=>!(!e||!t)&&(e.children===t.children&&e.isFocused===t.isFocused&&e.isFocusRingVisible===t.isFocusRingVisible&&e.isSelected===t.isSelected&&e.isTabbable===t.isTabbable&&e.isActive===t.isActive&&e.suggestion===t.suggestion&&e.isGridlineVisible===t.isGridlineVisible&&e.isTopGridlineVisible===t.isTopGridlineVisible&&e.padding===t.padding&&y.compareListItemContext(e.context,t.context))));function N({children:e,minimumCount:s=1}){const[r,o]=n.useState(!1);n.useEffect((()=>{setTimeout((()=>{o(!0)}),50)}),[]);const l=i.classNames([b.skeletonStyles.container]);return r&&e?t.jsx("div",{class:l,role:"presentation",children:[...Array(s)].map(((t,n)=>e(n)))}):null}const O="oj-collection-sparkle";function G({sparkleHeight:e}){const{name:n}=S.useTheme();if(e<=0)return null;const s=e+"px",r=i.classNames([b.sparkleStyles.base]),o=i.classNames([b.sparkleStyles.container,O,"redwood"===n&&x.globalImages]);return t.jsx("div",{class:o,children:t.jsx("div",{class:r,style:{height:s}})},"sparkle")}const B=(e,t)=>{if(0===t)return null;return e.slice(0,t).reduce(((e,n,i)=>{const s=n.metadata.key;return i===t-1?e.set(s,"end"):e.set(s,!0),e}),new Map)},_=(e,t,n)=>{if(e&&t&&(e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView({block:"nearest"}),n>0)){const i=t.getBoundingClientRect(),s=e.getBoundingClientRect(),r=i.top+n-s.top;r>0&&(t.scrollTop=t.scrollTop-r)}},U=(e,t)=>{const n=t.data.map((e=>e.metadata.key)),i=n.indexOf(e.value.start),s=n.indexOf(e.value.end),r=Math.min(i,s),o=Math.max(i,s);return-1===r?{offset:0,count:t.totalSize}:n.slice(r,o+1)},q=e=>!(!e.parentElement||!e.parentElement.classList.contains("oj-listview-expander"));const Y=(e,t)=>t??{scroller:()=>e.current},$={all:!1,keys:new Set},J=t.jsx(N,{minimumCount:25,children:()=>t.jsx(E.Inset,{variant:"listview",children:t.jsx(v.Flex,{height:"6x",align:"center",children:t.jsx(p.Skeleton,{height:"4x"})})})}),Q=t.jsx("div",{class:o.LOADMORE_STYLE_CLASS,children:t.jsx(N,{minimumCount:3,children:()=>t.jsx(E.Inset,{variant:"listview",children:t.jsx(v.Flex,{height:"6x",align:"center",children:t.jsx(p.Skeleton,{height:"4x"})})})})}),W=(e,t)=>{if(t){const n=Math.min(t.offset,e.offset+e.totalSize),i=n-e.offset;i>0&&(e={offset:n,data:e.data.slice(i,i+t.count),totalSize:e.totalSize,sizePrecision:e.sizePrecision})}return e};e.List=function({"aria-label":e,"aria-labelledby":a,allowTabbableMode:c=!0,children:d,data:u,gridlines:g,loadingIndicator:f=J,currentItemOverride:m,onPersistCurrentItem:p,onLoadRange:v,onSelectionChange:x,onItemAction:S,rangeExtractor:C,role:w="grid",selectedKeys:E=$,selectionMode:F="none",viewportConfig:H,currentItemVariant:N,promotedSection:O,isVirtualized:X=!1,customItemRenderer:Z,scrollToVisibleOffset:ee,testId:te,scrollerRef:ne,reorderProps:ie,contextMenuTriggerProps:se,itemPadding:re,...oe}){const le=n.useRef(null),ae=n.useRef(!1),ce=n.useRef(),[de,ue]=n.useState(!1),ge="none"===F?void 0:"multiple"===F,fe=null===u?void 0:"exact"===u.sizePrecision?u.totalSize:-1,me=i.classNames([b.listStyles.base]),be="embedded"===I.useCollectionInteractionContext(),ye=void 0!==N?N:be?"highlight":"none",pe=n.useCallback(((e,t)=>{u&&(ce.current={detail:e,range:{offset:u.offset,count:u.data.length}},v(t))}),[u,v]),ve=n.useRef({offset:0,count:0}),he=n.useCallback((e=>{ae.current&&ve.current.offset===e.offset&&ve.current.count===e.count||(ae.current=!0,ve.current=e,v(e))}),[ae,v]);n.useEffect((()=>{ae.current=!1}),[u]);const{currentKey:xe,onCurrentKeyChange:Se,isCurrentItemOverridden:ke}=((e,t)=>{const[i,s]=n.useState(),r=n.useRef(),o=n.useRef(!1),l=A.useReorderableContext(),a=n.useMemo((()=>e=>{const n=e.value;s({rowKey:n}),t?.(e),null!=l?.currentItemKey&&(l.currentItemKey.current=n)}),[t,l?.currentItemKey]);return r.current!==e&&(r.current=e,i?.rowKey!==e?.rowKey&&(o.current=!0,a({value:e?.rowKey}))),n.useEffect((()=>{o.current=!1})),{currentKey:i?.rowKey,onCurrentKeyChange:a,isCurrentItemOverridden:o.current}})(m,p),{eventProps:Ce,showFocusRing:Ie,handleSelectionChange:we}=((e,t,i="none",o,l,a,c,d,u="grid",g,f,m,b,p)=>{const v=n.useMemo((()=>M(u)),[u]),h=n.useRef(),{currentKeyProps:x}=T.useCurrentKey((e=>y.keyExtractor(e,L)),"multiple"!==i||p,y.getPrevNextKey(f.current,e,!0,L),y.getPrevNextKey(f.current,e,!1,L),void 0,void 0,e,o),[S,k]=R.useCollectionFocusRing(f,["ArrowUp","ArrowDown"]);n.useEffect((()=>{if(null!=e&&f.current){const t=y.findElementByKey(f.current,e,L);if(t){const e=f.current.getAttribute("aria-activedescendant"),n=t.querySelector(`[role=${v.cell}]`);if(n&&e!==n.id){f.current.setAttribute("aria-activedescendant",n.id);const e=f.current?.contains(document.activeElement);if(!b&&e||p){const e=d?.scroller(),n=g?g(f.current):0;_(t,null!=e?e:f.current,n)}}}}}),[e,c,v.cell,d,g,f,b,p]);const C=n.useCallback((e=>{l&&(!1===e.value.all&&e.value.keys.size>0&&(h.current=Array.from(e.value.keys.values()).pop()),l(e))}),[h,l]),I=n.useCallback((e=>{if(c&&l){const n=U(e,c);if(Array.isArray(n))if("shiftSpace"===e.eventType?h.current=e.value.start:h.current=e.value.end,p){const e=r.addKeys(t,n);l({value:e,target:null})}else l({value:{all:!1,keys:new Set(n)},target:null});else m(e,n)}}),[c,p,t,l,m]),{selectionProps:w}=K.useSelection((t=>t===f.current?void 0===e?null:e:y.keyExtractor(t,L)),t,p?"none":i,!1,"replace",C,h.current,e,((e,t)=>y.getPrevNextKey(f.current,e,t,L)),void 0,(e=>{if(f.current){const t=y.findElementByKey(f.current,e,L);if(t){const e=d?.scroller(),n=g?g(f.current):0;_(t,null!=e?e:f.current,n)}}}),I),{dropDownSelectionProps:j}=P.useDropDownSelection((t=>t===f.current?void 0===e?null:e:y.keyExtractor(t,L)),t,p?i:"none",!1,(e=>c?c.data.findIndex((t=>t.metadata.key===e)):-1),((e,t)=>c?c.data.map((e=>e.metadata.key)).slice(e,t):[]),((e,t)=>y.getPrevNextKey(f.current,e,t,L)),e,C,I),A=V.useItemAction(e,c,a,L,p);return{eventProps:s.mergeProps(x,k,w,A,j),showFocusRing:S,handleSelectionChange:C}})(xe,E,F,Se,x,S,u,H,w,ee,le,pe,ke,be),{eventProps:Ke,isCurrentTabbableKey:Pe}=((e,t,i,o,l,a)=>{const c=n.useRef(),d=n.useRef(!0),[u,g]=j.useTabbableModeSet(o,(e=>q(e)?null:y.keyExtractor(e,L)),e,t),f=n.useCallback((()=>{if(o.current&&t&&(!i||u(void 0))){const e=c.current||y.getFirstVisibleKey(o.current,L);r.isKeyDefined(e)&&t({value:e})}}),[o,t,i,u]),m=n.useCallback((n=>{if(q(n.target)){o.current?.focus();const e=y.keyExtractor(n.target,L);t&&r.isKeyDefined(e)&&t({value:e})}else if(r.isKeyDefined(e)){if(o.current){const n=y.findElementByKey(o.current,e,L);if(n){if(d.current){const e=l?.scroller(),t=a?a(o.current):0;_(n,null!=e?e:o.current,t)}d.current=!0}else t&&f()}}else t&&f()}),[e,f,t,a,l,o]),b=n.useCallback((t=>{const n=y.keyExtractor(t.target,L);r.isKeyDefined(n)&&(c.current=n,n!==e&&(d.current=!1))}),[e]);return{eventProps:s.mergeProps(i?g:{},{onFocus:m,onPointerDown:b}),isCurrentTabbableKey:u}})(xe,Se,c,le,H,ee);if(u&&void 0!==ce.current&&x){const e=U(ce.current.detail,u);if(Array.isArray(e))if(be){x({value:r.addKeys(E,e),target:null})}else x({value:{all:!1,keys:new Set(e)},target:null});const t=ce.current?ce.current.range:{offset:u.offset,count:u.data.length};u=W(u,t),ce.current=void 0,v(t)}const{sparkleHeight:Te,suggestions:Re}=((e,t,i)=>{const[s,r]=n.useState(0),o=n.useMemo((()=>e&&t&&B(e.data,t.count)),[e,t]);return n.useEffect((()=>{if(o){const e=i.current?.querySelector("."+l.PLACEHOLDER_STYLE_CLASS);let t=e?.offsetHeight||0;const n=i.current?.querySelectorAll("[data-oj-suggestion]");n?.forEach((e=>t+=e.offsetHeight)),r(t)}}),[i,o]),{sparkleHeight:s,suggestions:o}})(u,O,le),Ve=t.jsx(G,{sparkleHeight:Te}),je=n.useCallback((e=>{const n=e.data,i="multiple"===F?()=>t.jsx(h.Selector,{onChange:we,rowKey:n.metadata.key,selectedKeys:E}):void 0;return{index:e.index,data:n.data,metadata:n.metadata,selector:i}}),[F,E,we]),Ae=X?D:z,Ee=e=>{const n=je(e),i=Re?.get(n.metadata.key),s=c&&Pe(n.metadata.key),o=xe===n.metadata.key&&!s,l=o&&de,a=r.containsKey(E,n.metadata.key),f=o&&Ie,m=(e,s)=>{return t.jsx(Ae,{context:e,isFocused:o,isFocusRingVisible:f,isActive:l,isGridlineVisible:(r=n.index,"visible"===g?.item&&(r+1!==u?.totalSize||"visible"===g?.bottom)),isSelected:a,isTabbable:c&&Pe(n.metadata.key),role:w,selectionMode:F,currentItemVariant:ye,padding:re,...i&&{suggestion:i},...0===n.index&&{isTopGridlineVisible:"visible"===g?.item&&"visible"===g?.top},...s,children:d},n.metadata.key);var r};if(Z){return Z({listItemContext:n,isFocused:o,isFocusRingVisible:f,isSelected:a,isTabbable:s,isActive:l,defaultListItem:m})}return m(n)};H=Y(le,H);const Fe=n.useCallback((e=>{" "===e.key&&r.isKeyDefined(xe)&&"none"!==F&&ue(!0)}),[xe,F,ue]),Me=n.useCallback((()=>{ue(!1)}),[ue]);n.useImperativeHandle(ne,(()=>le.current));const Le=k.useTestId(te);return t.jsx("div",{...s.mergeProps(Ce,Ke,se||{},ie||{},{onKeyDown:Fe,onKeyUp:Me},oe),...Le,role:w,"aria-rowcount":"grid"===w?fe:void 0,"aria-colcount":"grid"===w?1:void 0,ref:le,class:me,tabIndex:0,"aria-label":e,"aria-labelledby":a,"aria-multiselectable":ge,children:null==u?f:X?t.jsx(l.VirtualizedCollection,{data:u,itemSelector:L,loadMoreIndicator:Q,onLoadRange:v,rangeExtractor:C,suggestions:Ve,viewportConfig:H,children:Ee}):t.jsx(o.LoadMoreCollection,{data:u.data,loadMoreIndicator:Q,hasMore:"atLeast"===u.sizePrecision&&u.data.length<=u.totalSize,onLoadMore:()=>{u&&he({offset:0,count:u.data.length+25})},suggestions:Ve,viewportConfig:H,children:Ee})})},e.SkeletonContainer=N,e.excludeGroup=(e,t)=>{if(!t.all){const n=e.data.filter((e=>!e.metadata.isLeaf)).map((e=>e.metadata.key)),i=Array.from(t.keys.values()).filter((e=>!n.includes(e)));return{...t,keys:new Set(i)}}return t},e.scrollToVisible=_}));
//# sourceMappingURL=List-0b764e84.js.map
