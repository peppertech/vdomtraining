{"version":3,"file":"useChartContextMenu-673e3de0.js","sources":["../../src/hooks/PRIVATE_useChartContextMenu/useChartContextMenu.ts","../../src/hooks/PRIVATE_useChartContextMenu/contextMenuUtils.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport type { BarSeriesData } from '../../UNSAFE_BarChart/barChart.types';\nimport type { LineAreaSeriesData } from '../../UNSAFE_LineAreaChart/lineAreaChart.types';\nimport type { Ref } from 'preact/hooks';\nimport type {\n  ChartContextMenuContext,\n  ChartContextMenuConfig,\n  Group,\n  Info\n} from '../../utils/UNSAFE_visTypes/chart';\nimport { type gestureTypes, useContextMenu } from '../PRIVATE_useVisContextMenu';\nimport { getChartContextMenuContext } from './contextMenuUtils';\n\ntype Props<K, D> = {\n  series: (BarSeriesData<K, D> | LineAreaSeriesData<K, D>)[];\n  groups: Group[];\n  getDataItem: (seriesIndex: number, groupIndex: number) => D | undefined;\n  focusedItemInfo: Info;\n  rootRef: Ref<HTMLDivElement>;\n  xAxisTitle?: string;\n  yAxisTitle?: string;\n  contextMenuConfig?: ChartContextMenuConfig<K, D>;\n  onContextMenuDismissed?: (gesture: gestureTypes) => void;\n};\n\nexport const useChartContextMenu = <K extends string | number, D>({\n  getDataItem,\n  focusedItemInfo,\n  series,\n  groups,\n  rootRef,\n  xAxisTitle,\n  yAxisTitle,\n  contextMenuConfig,\n  onContextMenuDismissed\n}: Props<K, D>) => {\n  const { contextMenuProps, contextMenuContent } = useContextMenu<ChartContextMenuContext<K, D>>({\n    onContextMenuHandler: ({ gesture, target }) => {\n      let elem;\n      const { context } = getChartContextMenuContext<K, D>(\n        focusedItemInfo,\n        gesture,\n        target as HTMLElement,\n        series,\n        groups,\n        rootRef,\n        xAxisTitle,\n        yAxisTitle,\n        getDataItem\n      );\n      if (gesture === 'keyboard' && context.type === 'item') {\n        elem = rootRef.current?.querySelector(\n          `[data-oj-series-index=\"${context?.seriesIndex}\"][data-oj-group-index=\"${context?.groupIndex}\"]`\n        );\n      }\n      return {\n        context,\n        elem\n      };\n    },\n    contextMenuOptions: {\n      isDisabled: !contextMenuConfig //If there is not a context menu renderer we disable the hook\n    },\n    rootRef,\n    contextMenuConfig,\n    onContextMenuDismissed\n  });\n\n  return { contextMenuContent, contextMenuProps };\n};\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport type {\n  ChartSeriesData,\n  Info,\n  ChartContextMenuContext,\n  Group\n} from '../../utils/UNSAFE_visTypes/chart';\nimport { getInfo } from '../../utils/UNSAFE_visUtils';\nimport type { Ref } from 'preact/hooks';\n\nexport function getChartContextMenuContext<K, D>(\n  focusedItemInfo: Info,\n  gesture: 'mouse' | 'touch' | 'keyboard',\n  target: HTMLElement,\n  series: ChartSeriesData<K, D>[],\n  groups: Group[],\n  rootRef: Ref<HTMLElement>,\n  xAxisTitle?: string,\n  yAxisTitle?: string,\n  getDataItem?: (seriesIndex: number, groupIndex: number) => D | undefined\n) {\n  let seriesIndex;\n  let groupIndex;\n  if (gesture === 'keyboard') {\n    //We find the element where the position of the menu is going to be based of\n    groupIndex = focusedItemInfo.groupIndex;\n    seriesIndex = focusedItemInfo.seriesIndex;\n  } else {\n    //We search for the key using the target of the event\n    const info = getInfo(rootRef, target);\n    seriesIndex = info ? info.seriesIndex : undefined;\n    groupIndex = info ? info.groupIndex : undefined;\n  }\n  let context;\n  if (\n    seriesIndex !== undefined &&\n    groupIndex !== undefined &&\n    getDataItem?.(seriesIndex, groupIndex)\n  ) {\n    context = {\n      data: getDataItem(seriesIndex, groupIndex),\n      groupIndex,\n      seriesIndex,\n      type: 'item'\n    };\n  } else if (seriesIndex !== undefined) {\n    context = {\n      data: series[seriesIndex],\n      type: 'series'\n    };\n  } else if (groupIndex !== undefined) {\n    context = {\n      data: groups[groupIndex],\n      type: 'xAxisTickLabel'\n    };\n  } else {\n    const target = event?.target as HTMLElement;\n    const text = target?.textContent;\n    if ((text && gesture !== 'keyboard' && text === xAxisTitle) || text === yAxisTitle) {\n      context = {\n        type: 'axisTitle',\n        axis: text === xAxisTitle ? 'x' : 'y'\n      };\n    } else {\n      context = {\n        type: 'background'\n      };\n    }\n  }\n  return {\n    context: context as ChartContextMenuContext<K, D>\n  };\n}\n"],"names":["getDataItem","focusedItemInfo","series","groups","rootRef","xAxisTitle","yAxisTitle","contextMenuConfig","onContextMenuDismissed","contextMenuProps","contextMenuContent","useContextMenu","onContextMenuHandler","gesture","target","elem","context","seriesIndex","groupIndex","info","getInfo","undefined","data","type","event","text","textContent","axis","getChartContextMenuContext","current","querySelector","contextMenuOptions","isDisabled"],"mappings":"oyBA+BmC,EACjCA,cACAC,kBACAC,SACAC,SACAC,UACAC,aACAC,aACAC,oBACAC,6BAEA,MAAMC,iBAAEA,EAAgBC,mBAAEA,GAAuBC,iBAA8C,CAC7FC,qBAAsB,EAAGC,UAASC,aAChC,IAAIC,EACJ,MAAMC,QAAEA,YC3BZf,EACAY,EACAC,EACAZ,EACAC,EACAC,EACAC,EACAC,EACAN,GAEA,IAAIiB,EACAC,EAWAF,EAVJ,GAAgB,aAAZH,EAEFK,EAAajB,EAAgBiB,WAC7BD,EAAchB,EAAgBgB,gBACzB,CAEL,MAAME,EAAOC,EAAAA,QAAQhB,EAASU,GAC9BG,EAAcE,EAAOA,EAAKF,iBAAcI,EACxCH,EAAaC,EAAOA,EAAKD,gBAAaG,CACvC,CAED,QACkBA,IAAhBJ,QACeI,IAAfH,GACAlB,IAAciB,EAAaC,GAE3BF,EAAU,CACRM,KAAMtB,EAAYiB,EAAaC,GAC/BA,aACAD,cACAM,KAAM,aAEH,QAAoBF,IAAhBJ,EACTD,EAAU,CACRM,KAAMpB,EAAOe,GACbM,KAAM,eAEH,QAAmBF,IAAfH,EACTF,EAAU,CACRM,KAAMnB,EAAOe,GACbK,KAAM,sBAEH,CACL,MAAMT,EAASU,OAAOV,OAChBW,EAAOX,GAAQY,YAEnBV,EADGS,GAAoB,aAAZZ,GAA0BY,IAASpB,GAAeoB,IAASnB,EAC5D,CACRiB,KAAM,YACNI,KAAMF,IAASpB,EAAa,IAAM,KAG1B,CACRkB,KAAM,aAGX,CACD,MAAO,CACLP,QAASA,EAEb,CDlC0BY,CAClB3B,EACAY,EACAC,EACAZ,EACAC,EACAC,EACAC,EACAC,EACAN,GAOF,MALgB,aAAZa,GAA2C,SAAjBG,EAAQO,OACpCR,EAAOX,EAAQyB,SAASC,cACtB,0BAA0Bd,GAASC,sCAAsCD,GAASE,iBAG/E,CACLF,UACAD,OACD,EAEHgB,mBAAoB,CAClBC,YAAazB,GAEfH,UACAG,oBACAC,2BAGF,MAAO,CAAEE,qBAAoBD,mBAAkB"}