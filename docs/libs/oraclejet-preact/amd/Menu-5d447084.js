define(['exports', 'preact/jsx-runtime', 'preact/compat', './Dropdown-abcacf49', 'preact/hooks', './mergeProps-bcfa6a92', './classNames-08d99695', './useUser-3ef25571', './MenuItem-87cd59b8', './UNSAFE_Menu/themes/MenuStyles.css', './useTestId-b5cd4766', './UNSAFE_Menu/themes/DropdownMenuStyles.css', './Sheet-0b58b0a5', './useModal-536cb7ff', './Layer-6f29b67f', './LayerHost-639b3284', './UNSAFE_Menu/themes/SheetMenuStyles.css'], (function(e,n,s,t,o,r,a,u,l,c,i,d,m,f,b,p,h){"use strict";const y=({children:e,"aria-label":s,currentFocus:t="menu",display:d,closeSubmenu:m,menuId:f,menuLevel:b,anchorRef:p})=>{const{onClose:h,testId:y}=l.useMenuContext(),{direction:v}=u.useUser(),x=o.useRef(null),k=o.useRef({wasMouseMoved:!1,lastMouseLeaveMenuItemdRelatedTarget:null}),[C,S]=o.useState(),[g,w]=o.useState(!1),[j,E]=o.useState(!1),F=o.useCallback((e=>{S(e.key),"keyboard"===e.reason?w(!0):w(!1)}),[]),I=o.useCallback((()=>{const e=n=>{const s=l.keyElemExtractor(n.target),t=s?.key,o=s?.elem;if(t&&o){k.current.wasMouseMoved=!0;const n=new MouseEvent("mouseenter");o.dispatchEvent(n),x.current?.removeEventListener("mousemove",e)}};x.current?.addEventListener("mousemove",e)}),[]),{currentKeyProps:L}=function(e,n,s,t,r){const a=o.useMemo((()=>({ArrowDown:n,ArrowUp:e,Home:s,End:t})),[n,e,s,t]),u=o.useCallback((e=>{if(r){const n=a[e.key];if(n&&!e.shiftKey){const s=n();s&&r({key:s,reason:"keyboard"}),e.preventDefault()}}}),[r,a]);return{currentKeyProps:null==r?{}:{onKeyDown:u}}}(l.getPrevNext(x.current,!0,C),l.getPrevNext(x.current,!1,C),(()=>l.getNVisible(x.current,0)),(()=>l.getLastVisible(x.current)),F);o.useEffect((()=>{const e=x.current;let n;if("none"!==t&&e)if("menu"===t){F({key:void 0,reason:"click"});const s=()=>{e.focus()};"sheet"===d?s():n=setTimeout((()=>{s()}),M)}else if("firstItem"===t){const e=l.getNVisible(x.current,0);e&&F({key:e,reason:"keyboard"})}else if("secondItem"===t){const e=l.getNVisible(x.current,1);e&&F({key:e,reason:"keyboard"})}return()=>{clearTimeout(n)}}),[F,t,b,d,p]),o.useEffect((()=>{I()}),[I]);const P=i.useTestId(y);return n.jsx("div",{...f&&{id:f},ref:x,tabIndex:C||"main"!==b&&"sheet"!==d?-1:0,role:"menu","aria-label":s,class:a.classNames([c.menuStyles.menuContainerStyle,c.menuStyles[`${d}MenuContainerStyle`]]),...r.mergeProps(L,l.getKeyboardCloseProps(h,b),l.getCloseSubmenuEvent(v,m),l.getMenuContainerFocusMethods((()=>{x.current?.contains(document.activeElement)||(w(!1),E(!1))}),(()=>{E(!0)})),l.getMenuContainerMouseLeave((e=>{e.relatedTarget&&e.relatedTarget.isEqualNode(k.current.lastMouseLeaveMenuItemdRelatedTarget)||(F({key:void 0,reason:"mouseEnter"}),x.current?.focus())})),l.getMenuPointerDown()),...P,children:n.jsx(l.MenuContainerContext.Provider,{value:{menuContainerRef:x,currentKey:C,showFocusRing:g,changeKey:F,menuContainerGeneralInformation:k,isContainerFocused:j},children:e})})},M=0,v=s.forwardRef((({anchorRef:e,defaultPlacement:o,offsetValue:r,closeSubmenu:a,children:u,"aria-label":c,currentFocus:i,menuId:m,menuLevel:f,flipOptions:b,isOpen:p},h)=>{const{onClose:M}=l.useMenuContext(),v=s.useCallback((e=>{if("sub"!==f&&"outsideMousedown"===e.reason){const n=l.keyElemExtractor(e.target)?.key;n||M?.({reason:"outsideClick",target:e.target})}}),[M,f]);return n.jsx(t.Dropdown,{onClose:v,isOpen:p,placement:o,anchorRef:e,flipOptions:b,offset:r,shiftOptions:{mainAxis:!1,crossAxis:!1},children:n.jsx("div",{class:d.dropdownMenuStyles.base,style:{minWidth:x},ref:h,children:n.jsx(y,{menuLevel:f,closeSubmenu:a,"aria-label":c,currentFocus:i,menuId:m,display:"dropdown",anchorRef:e,children:u})})})})),x=200,k=({children:e})=>n.jsx("div",{class:h.sheetMenuStyles.modalWrapper,children:e}),C=s.forwardRef((({children:e},s)=>n.jsx("div",{class:h.sheetMenuStyles.modalContainer,ref:s,children:e}))),S=({backdropVisible:e=!1})=>n.jsx("div",{class:a.classNames([h.sheetMenuStyles.modalBackdrop,e&&h.sheetMenuStyles.modalBackdropVisible])}),g=({children:e,"aria-label":s,currentFocus:t,anchorRef:r,closeSubmenu:a,menuLevel:u})=>{const{onClose:c}=l.useMenuContext();o.useEffect((()=>{const e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}}),[]);const i=o.useCallback((()=>{c?.({reason:"dismissed"})}),[c]),{backdropRef:d}=f.useModal({isOpen:!0,onBackdropClick:i}),{swipeProps:p}=m.useSheetSwipe(i);return n.jsx(b.Layer,{logicalParentRef:r,children:n.jsxs(k,{children:[n.jsx(S,{backdropVisible:"main"===u}),n.jsx(C,{ref:d,children:n.jsx("div",{class:h.sheetMenuStyles.sheetMenuContainerWrapper,...p,children:n.jsx(y,{"aria-label":s,currentFocus:t,display:"sheet",closeSubmenu:a,menuLevel:u,children:e})})})]})})},w=l.getIsMobile();e.DropdownMenu=v,e.Menu=({onClose:e,isOpen:s,testId:t,initialFocus:o="menu",placement:r,offsetValue:a,...u})=>n.jsx(l.MenuContext.Provider,{value:{onClose:e,isMobile:w,testId:t},children:n.jsx(n.Fragment,{children:w?n.jsx(n.Fragment,{children:s?n.jsx(g,{...u,currentFocus:o,menuLevel:"main"}):null}):n.jsx(v,{...u,isOpen:s,currentFocus:o,menuLevel:"main",defaultPlacement:r,offsetValue:a,flipOptions:{crossAxis:!0,mainAxis:!0,fallbackPlacements:["bottom-start","bottom-end","top-start","top-end","end-top","start-top","end-bottom","start-bottom"]}})})}),e.SheetMenu=g}));
//# sourceMappingURL=Menu-5d447084.js.map
