define(['exports', 'preact/jsx-runtime', 'preact/hooks', './Floating-5d98c1ca', './tabbableUtils-85aa6918', './refUtils-d354a169', './FocusTrap-60520575', './Layer-6f29b67f', 'preact/compat', './LayerHost-639b3284', './Modal-7bece8d5', './WindowOverlay-43c10424', './usePopupAnimation-6e53a0fe', './useTestId-b5cd4766', './useOutsideClick-76c1ff6e', './useComponentTheme-5aa41a8f', './UNSAFE_Popup/themes/PopupContract.css', './stringUtils-0ae982c2', './classNames-08d99695', './UNSAFE_Popup/themes/redwood/PopupTheme', './dimensions-60420dbb', './mergeInterpolations-9ede4cf7'], (function(e,n,t,s,o,r,a,i,c,l,u,d,p,m,f,b,h,y,A,g,x,E){"use strict";const O=c.forwardRef((({anchorRef:e,launcherRef:c,children:l,isOpen:O=!1,modality:v="modeless",offset:F={mainAxis:0,crossAxis:0},flipOptions:P={mainAxis:!0,crossAxis:!0},shiftOptions:C={mainAxis:!1,crossAxis:!1},onClickOutside:T,onClose:k,initialFocus:R="auto",placement:j=(e?"top":"center"),tail:w="none",onTransitionEnd:I,onFocusSet:L,role:N=("modeless"===v?"tooltip":"dialog"),"aria-label":S,"aria-labelledby":U,"aria-describedby":D,testId:M,...V},W)=>{const K=t.useRef(null),[_,H]=t.useState(),q=t.useRef(null),z=m.useTestId(M);f.useOutsideClick({isDisabled:!(O&&q.current),ref:q,handler:e=>{T?.(e)}});const B=t.useCallback((e=>{K.current===o.getActiveElement()&&"F6"===e.code&&"modeless"===v&&(e.preventDefault(),e.stopPropagation(),o.focusWithin(q.current),L?.())}),[v]),{setAnimationElementRef:G,status:J,onPosition:Q}=p.usePopupAnimation({isOpen:O,isAnimatedOnMount:!0,onTransitionEnd:e=>{e?(Z(),I?.(!0)):("modal"===v&&setTimeout((()=>Y()),0),I?.(!1))},placement:j}),X=t.useMemo((()=>r.mergeRefs(q,W)),[q,W]),Y=t.useCallback((()=>{const n=K.current,t=e?.current;n?o.focusOn(n):t&&t instanceof Element&&o.focusOn(t)}),[K,e]);t.useEffect((()=>{O||"opening"!==J||"modal"===v||q.current?.contains(o.getActiveElement())&&Y()}),[O,J,Y,v]),t.useEffect((()=>(O&&(c?.current&&c.current instanceof Element?K.current=document.body.contains(c.current)?c.current:o.getActiveElement():K.current=o.getActiveElement(),K.current?.addEventListener("keydown",B)),()=>{K.current?.removeEventListener("keydown",B)})),[O,c,B]);const Z=()=>{let e=R;"auto"===R&&(e="modal"===v?"firstFocusable":"none"),"popup"===e&&(o.focusOn(q.current),L?.(),I?.(!1)),"firstFocusable"===e&&(o.focusWithin(q.current),L?.())},$={mainAxis:(e=>{let n=0;return e&&(n="number"==typeof e?e:e.mainAxis||0,"simple"===w&&(n+=5)),n})(F),crossAxis:(e=>e?"number"==typeof e?0:e.crossAxis||0:0)(F)},ee=e=>{const n=o.getActiveElement(),t=q.current,s=K.current;if(t===n||t?.contains(n))switch(e.code){case"Escape":k?.({reason:"escapeKey"});break;case"F6":e.preventDefault(),e.stopPropagation(),s&&"modeless"===v&&o.focusOn(s)}};t.useLayoutEffect((()=>{if("unmounted"===J||null==q.current||null!=_||"none"===w)return;const e=y.getVarName(h.popupVars.backgroundColor),n=getComputedStyle(q.current);H(n.getPropertyValue(e))}),[J,q,_,w]);const{baseTheme:ne,classes:te}=b.useComponentTheme(g.PopupRedwoodTheme),se="unmounted"!==J,oe=[...Object.values(x.dimensionInterpolations)],re=E.mergeInterpolations(oe),{...ae}=re(V),ie=()=>n.jsx("div",{ref:X,tabIndex:-1,role:N,className:A.classNames([ne,te]),style:ae,onKeyDown:ee,"aria-label":S,"aria-labelledby":U,"aria-describedby":D,...z,children:n.jsx(a.FocusTrap,{restoreFocusRef:!1,children:l})}),ce=()=>e&&e.current?n.jsx(s.Floating,{ref:G,backgroundColor:_,anchorRef:e,placement:j,offsetValue:$,flipOptions:P,shiftOptions:C,tail:w,onPosition:Q,children:ie()}):n.jsx(d.WindowOverlay,{placement:j,offset:$,children:n.jsx("div",{ref:G,children:ie()})});return se?"modal"===v?n.jsx(u.Modal,{isOpen:se,children:ce()}):n.jsx(i.Layer,{children:ce()}):null}));e.Popup=O}));
//# sourceMappingURL=Popup-66e79afa.js.map
